<!DOCTYPE html>
<html lang="en">

<!-- Head tag (contains Google-Analytics、Baidu-Tongji)-->
<head>
  <!-- Google Analytics -->
  
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-xxxxxx-xx"></script>
    <script type="text/javascript">
      window.dataLayer = window.dataLayer || [];

      function gtag() {
        dataLayer.push(arguments);
      }
      gtag('js', new Date());

      gtag('config', 'UA-xxxxxx-xx');
    </script>
  

  <!-- Baidu Tongji -->
  
    <script type="text/javascript">
      // Originial
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  

  <!-- Baidu Push -->
  
    <script>
      (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
      })();
    </script>
  

  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>

  <meta name="google-site-verification" content="lxDfCplOZbIzjhG34NuQBgu2gdyRlAtMB4utP5AgEBc"/>
  <meta name="baidu-site-verification" content="PpzM9WxOJU"/>

  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="description" content="Morouu的大狗窝 ●&#39;◡&#39;●"/>
  <meta name="keyword" content="Morouu,morouu"/>
  <link rel="shortcut icon" href="/img/avatar/mdx.png"/>

  <!-- Place this tag in your head or just before your close body tag. -->
  <script async="async" defer="defer" src="https://buttons.github.io/buttons.js"></script>

  
    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css"/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/beantech.min.css"/>

    <!-- Pygments Highlight CSS -->
    <link rel="stylesheet" href="/css/highlight.css"/>
    <link rel="stylesheet" href="/css/widget.css"/>
    <link rel="stylesheet" href="/css/rocket.css"/>
    <link rel="stylesheet" href="/css/signature.css"/>
    <link rel="stylesheet" href="/css/catalog.css"/>
    <link rel="stylesheet" href="/css/livemylife.css"/>

    
      <!-- wave start -->
      <link rel="stylesheet" href="/css/wave.css"/>
      <!-- wave end -->
    

    
      <!-- top start (article top hot config) -->
      <link rel="stylesheet" href="/css/top.css"/>
      <!-- top end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/scroll.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- viewer start (Picture preview) -->
      <link rel="stylesheet" href="/css/viewer.min.css"/>
      <!-- viewer end -->
    

    
      <!-- Search start -->
      <link rel="stylesheet" href="/css/search.css"/>
      <!-- Search end -->
    

    
      <!-- ThemeColor start -->
      <link rel="stylesheet" href="/css/themecolor.css"/>
      <!-- ThemeColor end -->
    

    
      <!-- gitment start -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/default.css"/>
      <!-- gitment end -->
    

    
  

  <!-- Custom Fonts -->
  <!-- <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
  <!-- Hux change font-awesome CDN to qiniu -->
  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.5.0/css/font-awesome.min.css" type="text/css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

  <!-- Hux Delete, sad but pending in China <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'> <link
  href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/ css'> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]> <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script> <![endif]-->

  <!-- ga & ba script hoook -->
  <link rel="canonical" href="https://morblog.cc/2345857970/">
  <title>
    
      小工具 - 简单的随机数生成工具 - Morouu的大狗窝 ●&#39;◡&#39;●
    
  </title>
<meta name="generator" content="Hexo 5.4.0"></head>


<!-- hack iOS CSS :active style -->

	<body ontouchstart="" class="body--light body--light">


		<!-- ThemeColor -->
		
		<!-- ThemeColor -->
<style type="text/css">
  .body--light {
    --light-mode: none;
    --dark-mode: block;
  }
  .body--dark {
    --light-mode: block;
    --dark-mode: none;
  }
  i.mdui-icon.material-icons.light-mode {
    display: var(--light-mode);
  }
  i.mdui-icon.material-icons.dark-mode {
    display: var(--dark-mode);
  }
</style>
<div class="toggle" onclick="document.body.classList.toggle('body--dark')">
  <i class="mdui-icon material-icons light-mode"></i>
  <i class="mdui-icon material-icons dark-mode"></i>
</div>
<script>
  //getCookieValue
  function getCookieValue(a) {
    var b = document.cookie.match('(^|[^;]+)\\s*' + a + '\\s*=\\s*([^;]+)');
    return b
      ? b.pop()
      : '';
  }
  let themeMode = 'light';
  if (getCookieValue('sb-color-mode') && (getCookieValue('sb-color-mode') !== themeMode)) {
    let dbody = document.body.classList;
    themeMode === 'dark' ? dbody.remove('body--dark') : dbody.add('body--dark');
  }

  //setCookieValue
  var toggleBtn = document.querySelector(".toggle");
  toggleBtn.addEventListener("click", function () {
    var e = document.body.classList.contains("body--dark");
    var cookieString = e
      ? "dark"
      : "light";
    var exp = new Date();
    exp.setTime(exp.getTime() + 3 * 24 * 60 * 60 * 1000); //3天过期
    document.cookie = "sb-color-mode=" + cookieString + ";expires=" + exp.toGMTString() + ";path=/";
  });
</script>

		

		<!-- Gitter -->
		
		<!-- Gitter -->
<!-- Docs:https://gitter.im/?utm_source=left-menu-logo -->
<script>
  ((window.gitter = {}).chat = {}).options = {
    room: 'dmantick/morcruiser'
  };
</script>
<script src="https://sidecar.gitter.im/dist/sidecar.v1.js" async defer></script>

		

		<!-- Navigation (contains search)-->
		<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Morouu的大狗窝 ●&#39;◡&#39;●</a>
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <!-- Known Issue, found by Hux: <nav>'s height woule be hold on by its content. so, when navbar scale out, the <nav> will cover tags. also mask any touch event of tags, unfortunately. -->
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          <li>
            <a href="/">首页</a>
          </li>

          
          
          <li>
            <a href="/archive/">
              
              归档
              
              
            </a>
          </li>
          
          
          
          
          
          <li>
            <a href="/about/">
              
              关于
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/categories/">
              
              分类
              
              
            </a>
          </li>
          
          
          
          <li>
            <a href="/tags/">
              
              标签
              
              
            </a>
          </li>
          
          

          
          <li>
            <a class="popup-trigger">
              <span class="search-icon"></span>搜索</a>
          </li>
          

          <!-- LangSelect -->
          
          
          
          
          
        </ul>
      </div>
    </div>
    <!-- /.navbar-collapse -->
  </div>
  <!-- /.container -->
</nav>
<!-- progress -->
<div id="progress">
  <div class="line" style="width: 0%;"></div>
</div>

<script>
  // Drop Bootstarp low-performance Navbar Use customize navbar with high-quality material design animation in high-perf jank-free CSS3 implementation
  var $body = document.body;
  var $toggle = document.querySelector('.navbar-toggle');
  var $navbar = document.querySelector('#huxblog_navbar');
  var $collapse = document.querySelector('.navbar-collapse');

  $toggle.addEventListener('click', handleMagic)

  function handleMagic(e) {
    if ($navbar.className.indexOf('in') > 0) {
      // CLOSE
      $navbar.className = " ";
      // wait until animation end.
      setTimeout(function() {
        // prevent frequently toggle
        if ($navbar.className.indexOf('in') < 0) {
          $collapse.style.height = "0px"
        }
      }, 400)
    } else {
      // OPEN
      $collapse.style.height = "auto"
      $navbar.className += " in";
    }
  }
</script>


		<!-- Post Header (contains intro-header、signature、wordcount、busuanzi、waveoverlay) -->
		<!-- Modified by Yu-Hsuan Yen -->
<!-- Post Header -->

  <style type="text/css">
    .body--light {
      /* intro-header */
      --intro-header-background-image-url-home: url('/img/header_img/bgtop.jpg');
      --intro-header-background-image-url-post: url('https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/20210321213642.png?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
      --intro-header-background-image-url-page: url('/https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/20210321213642.png?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
    }
    .body--dark {
      --intro-header-background-image-url-home: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/img/header_img/bgtop.jpg');
      --intro-header-background-image-url-post: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/20210321213642.png?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
      --intro-header-background-image-url-page: linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)), url('/https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/20210321213642.png?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080');
    }

    header.intro-header {
       /*post*/
        background-image: var(--intro-header-background-image-url-post);
        /* background-image: url('https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/20210321213642.png?x-oss-process=image/auto-orient,1/interlace,1/resize,m_fixed,w_1920,h_1080'); */
      
    }

    
      #signature {/*signature*/
        background-image: url('/img/signature/morouu2.png');
      }
    
  </style>





<header class="intro-header">
  <!-- Signature -->
  <div id="signature">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
          
          <div class="post-heading">
            <div class="tags">
              
              <a class="tag" href="/tags/#安全" title="安全">安全</a>
              
              <a class="tag" href="/tags/#CRYPTO" title="CRYPTO">CRYPTO</a>
              
              <a class="tag" href="/tags/#PHP" title="PHP">PHP</a>
              
              <a class="tag" href="/tags/#Python" title="Python">Python</a>
              
            </div>
            <h1>小工具 - 简单的随机数生成工具</h1>
            <h2 class="subheading"></h2>
            <span class="meta">
              Posted by morouu on
              2021-12-27
            </span>


            
            <!-- WordCount start -->
            <div class="blank_box"></div>
            <span class="meta">
              Estimated Reading Time <span class="post-count" >52</span> Minutes
            </span>
            <div class="blank_box"></div>
            <span class="meta">
              Words <span class="post-count">9.6k</span> In Total
            </span>
            <div class="blank_box"></div>
            <!-- WordCount end -->
            
            
            <!-- 不蒜子统计 start -->
            <span class="meta" id="busuanzi_container_page_pv">
              Viewed <span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span> Times
            </span>
            <!-- 不蒜子统计 end -->
            


          </div>
          
        </div>
      </div>
    </div>
  </div>

  
  <!-- waveoverlay start -->
  <div class="preview-overlay">
    <svg class="preview-waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
      <defs>
        <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"></path>
      </defs>
      <g class="preview-parallax">
        <use xlink:href="#gentle-wave" x="48" y="0" fill=var(--gentle-wave1)></use>
        <use xlink:href="#gentle-wave" x="48" y="3" fill=var(--gentle-wave2)></use>
        <use xlink:href="#gentle-wave" x="48" y="5" fill=var(--gentle-wave3)></use>
        <use xlink:href="#gentle-wave" x="48" y="7" fill=var(--gentle-wave)></use>
      </g>
    </svg>
  </div>
  <!-- waveoverlay end -->
  

</header>



		<!-- Main Content (Post contains
	Pager、
	tip、
	socialshare、
	gitalk、gitment、disqus-comment、
	Catalog、
	Sidebar、
	Featured-Tags、
	Friends Blog、
	anchorjs、
	) -->
		<!-- Modify by Yu-Hsuan Yen -->
<!-- Post Content -->
<article>
  <div class="container" style="margin-left: 10%;">
    <div class="row">
      <!-- Post Container -->
      <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 post-container">

        <h1 id="开发-简单的随机数生成工具"><a href="#开发-简单的随机数生成工具" class="headerlink" title="开发 - 简单的随机数生成工具"></a>开发 - 简单的随机数生成工具</h1><hr>
<h2 id="结构"><a href="#结构" class="headerlink" title="- 结构 -"></a>- 结构 -</h2><ul>
<li><p>前端界面：MDUI + jQuery</p>
</li>
<li><p>后端处理：Apache + PHP</p>
</li>
<li>随机生成：Python 3.6</li>
</ul>
<p>网址：<a target="_blank" rel="noopener" href="https://www.dmantick.tk/tools/">https://www.dmantick.tk/tools/</a></p>
<h2 id="原理流程"><a href="#原理流程" class="headerlink" title="- 原理流程 -"></a>- 原理流程 -</h2><h3 id="密钥初始化"><a href="#密钥初始化" class="headerlink" title="- 密钥初始化 -"></a>- 密钥初始化 -</h3><ul>
<li>密钥KEY1]：根据服务器当前内存使用率（精确至48位小数）、CPU数据的C64编码值的生成sha256值（结果取128bit）；</li>
<li>[密钥KEY2]：获取当前时间戳与[密钥KEY1]的C64编码值的生成的sha256值（结果取128bit）；</li>
<li>[不变密钥KEY]：16384位RSA中P和Q乘积生成的sha256值（结果取128bit）；</li>
</ul>
<p>使用者可以随时通过向服务器发送请求，来实时生成[密钥KEY1]以及[密钥KEY2]的值，不变密钥则由服务器秘密保存。</p>
<p><strong>注：本文所有提到的C64并非CRC-64算法。</strong></p>
<hr>
<h3 id="随机字节流生产操作"><a href="#随机字节流生产操作" class="headerlink" title="- 随机字节流生产操作 -"></a>- 随机字节流生产操作 -</h3><ul>
<li>[第一步]：先生成2048位的RSA，取其两个质数 P 和 Q，以及乘积 N 值；</li>
<li>[第二步]：使用[密钥KEY2]作为AES128密钥，输入值为 P 的sha256值的base64编码，之后取AES128加密结果的128bit（奇数次加密取前128bit，偶数次加密为后128bit）与前 1 次加密时使用的密钥异或的结果作为当前加密密钥，加密所得的结果的sha256值的base64编码作为当前需要加密的值，一共轮代 5 次；</li>
<li>[第三步]：获取使用者发送请求的时间戳以及当前加密时的时间戳的base64编码，以[不变密钥KEY]进行AES128加密，之后取 Q 和 前 1 次加密使用的密钥异或的结果作为当前加密密钥，加密所得的结果的sha256值的base64编码作为当前需要加密的值，一共轮代 5 次；</li>
<li>[第四步]：将[第二步]和[第三步]所得的结果异或，然后将异或所得的结果的base64编码以 P 和 Q，进行RSA2048的加密；</li>
<li>[第五步]：将[第四步]所得的结果分别取前一半和后一半的sha256值，以及所得结果和 N 的或的sha256值，以[前一半的sha256值] + [所得结果和 N 的或的sha256值] + [后一半的sha256值] 组成结果作为随机字节流；</li>
</ul>
<p>由于sha256所得的hash值有浮动，所得随机字节流结果于 95 ~ 96字节之间，也就是一次最多能生成 90+ 的任意随机字符。</p>
<hr>
<h3 id="原理图示"><a href="#原理图示" class="headerlink" title="- 原理图示 -"></a>- 原理图示 -</h3><p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112271514052.png" alt="image-20200520154230399.png"></p>
<hr>
<h2 id="生成随机字节流的各个算法代码实现"><a href="#生成随机字节流的各个算法代码实现" class="headerlink" title="- 生成随机字节流的各个算法代码实现 -"></a>- 生成随机字节流的各个算法代码实现 -</h2><p>主要用到算法：<strong>C64|BASE64|AES128|RSA|SHA256</strong> 。</p>
<h3 id="C64"><a href="#C64" class="headerlink" title="- C64 -"></a><strong>- C64 -</strong></h3><p>（这个是我基于BASE64编码算法简单写的一个转码算法= =，本初是为了隐藏WEB的反弹shell弹回来的IP和端口）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@Description: C64</span></span><br><span class="line"><span class="string">@Author: DQ</span></span><br><span class="line"><span class="string">@LastEditors  : DQ</span></span><br><span class="line"><span class="string">@Date: 2020-05-03 13:09:11</span></span><br><span class="line"><span class="string">@LastEditTime : 2020-05-18 10:33:59</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 简单的变种base64算法</span></span><br><span class="line"><span class="comment"># 若需转码数据字节的2进制流为6的倍数，则比base64多长1位；其余情况，均比base64少1位</span></span><br><span class="line"><span class="comment"># 局限是转码最小单位为字节，小于1个字节的数据流得补0</span></span><br><span class="line"><span class="comment"># 简单的替换表，可以随意改变，其实也可以当成一个简单的密钥</span></span><br><span class="line">C64_TABLE = [</span><br><span class="line">    <span class="string">&#x27;\x00&#x27;</span>, <span class="string">&#x27;\x01&#x27;</span>, <span class="string">&#x27;\x02&#x27;</span>, <span class="string">&#x27;\x03&#x27;</span>, <span class="string">&#x27;\x04&#x27;</span>, <span class="string">&#x27;\x05&#x27;</span>, <span class="string">&#x27;\x06&#x27;</span>, <span class="string">&#x27;\x07&#x27;</span>, <span class="string">&#x27;\x08&#x27;</span>, <span class="string">&#x27;\x09&#x27;</span>, <span class="string">&#x27;\x10&#x27;</span>, <span class="string">&#x27;\x11&#x27;</span>, <span class="string">&#x27;\x12&#x27;</span>, <span class="string">&#x27;\x13&#x27;</span>, <span class="string">&#x27;\x14&#x27;</span>, <span class="string">&#x27;\x15&#x27;</span>, <span class="string">&#x27;\x16&#x27;</span>, <span class="string">&#x27;\x17&#x27;</span>, <span class="string">&#x27;\x18&#x27;</span>, <span class="string">&#x27;\x19&#x27;</span>, <span class="string">&#x27;\x20&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x21&#x27;</span>, <span class="string">&#x27;\x22&#x27;</span>, <span class="string">&#x27;\x23&#x27;</span>, <span class="string">&#x27;\x24&#x27;</span>, <span class="string">&#x27;\x25&#x27;</span>, <span class="string">&#x27;\x26&#x27;</span>, <span class="string">&#x27;\x27&#x27;</span>, <span class="string">&#x27;\x28&#x27;</span>, <span class="string">&#x27;\x29&#x27;</span>, <span class="string">&#x27;\x30&#x27;</span>, <span class="string">&#x27;\x31&#x27;</span>, <span class="string">&#x27;\x32&#x27;</span>, <span class="string">&#x27;\x33&#x27;</span>, <span class="string">&#x27;\x34&#x27;</span>, <span class="string">&#x27;\x35&#x27;</span>, <span class="string">&#x27;\x36&#x27;</span>, <span class="string">&#x27;\x37&#x27;</span>, <span class="string">&#x27;\x38&#x27;</span>, <span class="string">&#x27;\x39&#x27;</span>, <span class="string">&#x27;\x40&#x27;</span>, <span class="string">&#x27;\x41&#x27;</span>, <span class="string">&#x27;\x42&#x27;</span>, <span class="string">&#x27;\x43&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x44&#x27;</span>, <span class="string">&#x27;\x45&#x27;</span>, <span class="string">&#x27;\x46&#x27;</span>, <span class="string">&#x27;\x47&#x27;</span>, <span class="string">&#x27;\x48&#x27;</span>, <span class="string">&#x27;\x49&#x27;</span>, <span class="string">&#x27;\x50&#x27;</span>, <span class="string">&#x27;\x51&#x27;</span>, <span class="string">&#x27;\x52&#x27;</span>, <span class="string">&#x27;\x53&#x27;</span>, <span class="string">&#x27;\x54&#x27;</span>, <span class="string">&#x27;\x55&#x27;</span>, <span class="string">&#x27;\x56&#x27;</span>, <span class="string">&#x27;\x57&#x27;</span>, <span class="string">&#x27;\x58&#x27;</span>, <span class="string">&#x27;\x59&#x27;</span>, <span class="string">&#x27;\x60&#x27;</span>, <span class="string">&#x27;\x61&#x27;</span>, <span class="string">&#x27;\x62&#x27;</span>, <span class="string">&#x27;\x63&#x27;</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span>(<span class="params"> s: <span class="built_in">str</span> </span>):</span></span><br><span class="line">    <span class="comment"># 先将每个字节转换成8位的2进制模式</span></span><br><span class="line">    bits = <span class="string">&quot;&quot;</span>.join(<span class="built_in">bin</span>(byte)[ <span class="number">2</span>: ].zfill(<span class="number">8</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> <span class="built_in">bytes</span>(s.encode(<span class="string">&#x27;gbk&#x27;</span>)))[ ::-<span class="number">1</span> ]</span><br><span class="line">    length = <span class="built_in">len</span>(bits)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 然后进行（所转换成2进制位数长度 - 1）的循环（1个字节=8长，循环 8 - 1 = 7 次）</span></span><br><span class="line">    <span class="keyword">for</span> count <span class="keyword">in</span> <span class="built_in">range</span>(length - <span class="number">1</span>):</span><br><span class="line">        <span class="comment">#	具体算法为：当前位置值 和 后 1 位值的异或（迭代进行）</span></span><br><span class="line">        <span class="comment">#	比如 1011 那么步骤为</span></span><br><span class="line">        <span class="comment">#	取[10]11，1 ^ 0 = 1 =&gt; 1011,</span></span><br><span class="line">        <span class="comment">#	取1[01]1，0 ^ 1 = 1 =&gt; 1111,</span></span><br><span class="line">        <span class="comment">#	取11[11]，1 ^ 1 = 0 =&gt; 1101,</span></span><br><span class="line">        <span class="comment"># 	但这并非最终结果，仅是一个例子，结果会受到下一步操作的影响</span></span><br><span class="line"></span><br><span class="line">        bits = bits[ :count ] + <span class="built_in">str</span>(<span class="built_in">int</span>(bits[ count ]) ^ <span class="built_in">int</span>(bits[ count + <span class="number">1</span> ])) + bits[ count + <span class="number">1</span>: ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 每次异或完毕后，进行11次循环，每次循环步骤为</span></span><br><span class="line">        <span class="comment"># 先右循环移1位，然后倒置</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">            bits = (bits[ -<span class="number">1</span> ] + bits[ :-<span class="number">1</span> ])[ ::-<span class="number">1</span> ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 先取得到的2进制流的奇位和偶位</span></span><br><span class="line">    <span class="comment"># 公式为：奇数位组成值的前一半长 + 偶数位组成值 ^ 奇数组成位值 + 奇数位组成值后一半长</span></span><br><span class="line">    left = <span class="string">&quot;&quot;</span></span><br><span class="line">    right = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length):</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> i % <span class="number">2</span>):</span><br><span class="line">            left += bits[ i ]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            right += bits[ i ]</span><br><span class="line">    data = right[ :<span class="built_in">len</span>(right) // <span class="number">2</span> ] + <span class="string">&quot;&quot;</span>.join(</span><br><span class="line">        <span class="built_in">str</span>(<span class="built_in">int</span>(byte1) ^ <span class="built_in">int</span>(byte2)) <span class="keyword">for</span> byte1, byte2 <span class="keyword">in</span> <span class="built_in">zip</span>(left, right)) + right[ <span class="built_in">len</span>(right) // <span class="number">2</span>: ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 取得结果的2进制流模6值，若不足6位则补值6位，若正好为6位则多补6位</span></span><br><span class="line">    <span class="comment"># 比如 24-&gt;30 32-&gt;36</span></span><br><span class="line">    data = data + <span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(byte % <span class="number">2</span>) <span class="keyword">for</span> byte <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span> - <span class="built_in">len</span>(data) % <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 根据替换表进行替换</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span>.join(C64_TABLE[ <span class="built_in">int</span>(data[ i * <span class="number">6</span>:(i + <span class="number">1</span>) * <span class="number">6</span> ], <span class="number">2</span>) ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) // <span class="number">6</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解码的话，倒回去即可</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span>(<span class="params"> s: <span class="built_in">str</span> </span>):</span></span><br><span class="line">    data = <span class="string">&quot;&quot;</span>.join(<span class="built_in">bin</span>(C64_TABLE.index(font))[ <span class="number">2</span>: ].zfill(<span class="number">6</span>) <span class="keyword">for</span> font <span class="keyword">in</span> s)</span><br><span class="line">    data = data[ :-(<span class="built_in">len</span>(data) % <span class="number">8</span>) ]</span><br><span class="line">    data_len = <span class="built_in">len</span>(data)</span><br><span class="line"></span><br><span class="line">    right = data[ :data_len // <span class="number">4</span> ] + data[ -data_len // <span class="number">4</span>: ]</span><br><span class="line">    left = <span class="string">&quot;&quot;</span>.join(<span class="built_in">str</span>(<span class="built_in">int</span>(byte1) ^ <span class="built_in">int</span>(byte2)) <span class="keyword">for</span> byte1, byte2 <span class="keyword">in</span> <span class="built_in">zip</span>(data[ data_len // <span class="number">4</span>:data_len // <span class="number">4</span> * <span class="number">3</span> ], right))</span><br><span class="line">    bits = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(data_len):</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">not</span> i % <span class="number">2</span>):</span><br><span class="line">            bits += left[ i // <span class="number">2</span> ]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            bits += right[ i // <span class="number">2</span> ]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> count <span class="keyword">in</span> <span class="built_in">range</span>(data_len - <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">11</span>):</span><br><span class="line">            bits = bits[ ::-<span class="number">1</span> ]</span><br><span class="line">            bits = (bits[ <span class="number">1</span>: ] + bits[ <span class="number">0</span> ])</span><br><span class="line">        bits = bits[ :count - <span class="number">1</span> ] + <span class="built_in">str</span>(<span class="built_in">int</span>(bits[ count ]) ^ <span class="built_in">int</span>(bits[ count - <span class="number">1</span> ])) + bits[ count: ]</span><br><span class="line">    bits = bits[ ::-<span class="number">1</span> ]</span><br><span class="line">    result = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(bits[ x * <span class="number">8</span>:(x + <span class="number">1</span>) * <span class="number">8</span> ], <span class="number">2</span>)) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(bits) // <span class="number">8</span>)).encode(<span class="string">&quot;latin1&quot;</span>).decode(</span><br><span class="line">        <span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">            en = encrypt(<span class="built_in">input</span>(<span class="string">&quot;input：&quot;</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Encrypt: &quot;</span>, en)</span><br><span class="line"></span><br><span class="line">            de = decrypt(en)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Decrypt：&quot;</span>, de)</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
<h3 id="BASE64"><a href="#BASE64" class="headerlink" title="- BASE64 -"></a><strong>- BASE64 -</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@Description: Base64</span></span><br><span class="line"><span class="string">@Author: DQ</span></span><br><span class="line"><span class="string">@LastEditors  : DQ</span></span><br><span class="line"><span class="string">@Date: 2020-01-04 14:55:52</span></span><br><span class="line"><span class="string">@LastEditTime : 2020-01-04 22:05:46</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># base64编码表</span></span><br><span class="line">base64_dict = &#123; <span class="number">0</span>: <span class="string">&#x27;A&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;B&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;C&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;D&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;E&#x27;</span>, <span class="number">5</span>: <span class="string">&#x27;F&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;G&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;H&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;I&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;J&#x27;</span>,</span><br><span class="line">                <span class="number">10</span>: <span class="string">&#x27;K&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;L&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;M&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;N&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;O&#x27;</span>, <span class="number">15</span>: <span class="string">&#x27;P&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;R&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;S&#x27;</span>,</span><br><span class="line">                <span class="number">19</span>: <span class="string">&#x27;T&#x27;</span>, <span class="number">20</span>: <span class="string">&#x27;U&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;V&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;W&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;X&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;Z&#x27;</span>, <span class="number">26</span>: <span class="string">&#x27;a&#x27;</span>, <span class="number">27</span>: <span class="string">&#x27;b&#x27;</span>,</span><br><span class="line">                <span class="number">28</span>: <span class="string">&#x27;c&#x27;</span>, <span class="number">29</span>: <span class="string">&#x27;d&#x27;</span>, <span class="number">30</span>: <span class="string">&#x27;e&#x27;</span>, <span class="number">31</span>: <span class="string">&#x27;f&#x27;</span>, <span class="number">32</span>: <span class="string">&#x27;g&#x27;</span>, <span class="number">33</span>: <span class="string">&#x27;h&#x27;</span>, <span class="number">34</span>: <span class="string">&#x27;i&#x27;</span>, <span class="number">35</span>: <span class="string">&#x27;j&#x27;</span>, <span class="number">36</span>: <span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">                <span class="number">37</span>: <span class="string">&#x27;l&#x27;</span>, <span class="number">38</span>: <span class="string">&#x27;m&#x27;</span>, <span class="number">39</span>: <span class="string">&#x27;n&#x27;</span>, <span class="number">40</span>: <span class="string">&#x27;o&#x27;</span>, <span class="number">41</span>: <span class="string">&#x27;p&#x27;</span>, <span class="number">42</span>: <span class="string">&#x27;q&#x27;</span>, <span class="number">43</span>: <span class="string">&#x27;r&#x27;</span>, <span class="number">44</span>: <span class="string">&#x27;s&#x27;</span>, <span class="number">45</span>: <span class="string">&#x27;t&#x27;</span>,</span><br><span class="line">                <span class="number">46</span>: <span class="string">&#x27;u&#x27;</span>, <span class="number">47</span>: <span class="string">&#x27;v&#x27;</span>, <span class="number">48</span>: <span class="string">&#x27;w&#x27;</span>, <span class="number">49</span>: <span class="string">&#x27;x&#x27;</span>, <span class="number">50</span>: <span class="string">&#x27;y&#x27;</span>, <span class="number">51</span>: <span class="string">&#x27;z&#x27;</span>, <span class="number">52</span>: <span class="string">&#x27;0&#x27;</span>, <span class="number">53</span>: <span class="string">&#x27;1&#x27;</span>, <span class="number">54</span>: <span class="string">&#x27;2&#x27;</span>,</span><br><span class="line">                <span class="number">55</span>: <span class="string">&#x27;3&#x27;</span>, <span class="number">56</span>: <span class="string">&#x27;4&#x27;</span>, <span class="number">57</span>: <span class="string">&#x27;5&#x27;</span>, <span class="number">58</span>: <span class="string">&#x27;6&#x27;</span>, <span class="number">59</span>: <span class="string">&#x27;7&#x27;</span>, <span class="number">60</span>: <span class="string">&#x27;8&#x27;</span>, <span class="number">61</span>: <span class="string">&#x27;9&#x27;</span>, <span class="number">62</span>: <span class="string">&#x27;+&#x27;</span>, <span class="number">63</span>: <span class="string">&#x27;/&#x27;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># base64编码逆表</span></span><br><span class="line">base64_reverse_dict = &#123; <span class="string">&#x27;A&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;B&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;C&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;D&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;E&#x27;</span>: <span class="number">4</span>, <span class="string">&#x27;F&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;G&#x27;</span>: <span class="number">6</span>, <span class="string">&#x27;H&#x27;</span>: <span class="number">7</span>, <span class="string">&#x27;I&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;J&#x27;</span>: <span class="number">9</span>,</span><br><span class="line">                        <span class="string">&#x27;K&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;L&#x27;</span>: <span class="number">11</span>, <span class="string">&#x27;M&#x27;</span>: <span class="number">12</span>, <span class="string">&#x27;N&#x27;</span>: <span class="number">13</span>, <span class="string">&#x27;O&#x27;</span>: <span class="number">14</span>, <span class="string">&#x27;P&#x27;</span>: <span class="number">15</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;R&#x27;</span>: <span class="number">17</span>, <span class="string">&#x27;S&#x27;</span>: <span class="number">18</span>,</span><br><span class="line">                        <span class="string">&#x27;T&#x27;</span>: <span class="number">19</span>, <span class="string">&#x27;U&#x27;</span>: <span class="number">20</span>, <span class="string">&#x27;V&#x27;</span>: <span class="number">21</span>, <span class="string">&#x27;W&#x27;</span>: <span class="number">22</span>, <span class="string">&#x27;X&#x27;</span>: <span class="number">23</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="number">24</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="number">25</span>, <span class="string">&#x27;a&#x27;</span>: <span class="number">26</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">27</span>,</span><br><span class="line">                        <span class="string">&#x27;c&#x27;</span>: <span class="number">28</span>, <span class="string">&#x27;d&#x27;</span>: <span class="number">29</span>, <span class="string">&#x27;e&#x27;</span>: <span class="number">30</span>, <span class="string">&#x27;f&#x27;</span>: <span class="number">31</span>, <span class="string">&#x27;g&#x27;</span>: <span class="number">32</span>, <span class="string">&#x27;h&#x27;</span>: <span class="number">33</span>, <span class="string">&#x27;i&#x27;</span>: <span class="number">34</span>, <span class="string">&#x27;j&#x27;</span>: <span class="number">35</span>, <span class="string">&#x27;k&#x27;</span>: <span class="number">36</span>,</span><br><span class="line">                        <span class="string">&#x27;l&#x27;</span>: <span class="number">37</span>, <span class="string">&#x27;m&#x27;</span>: <span class="number">38</span>, <span class="string">&#x27;n&#x27;</span>: <span class="number">39</span>, <span class="string">&#x27;o&#x27;</span>: <span class="number">40</span>, <span class="string">&#x27;p&#x27;</span>: <span class="number">41</span>, <span class="string">&#x27;q&#x27;</span>: <span class="number">42</span>, <span class="string">&#x27;r&#x27;</span>: <span class="number">43</span>, <span class="string">&#x27;s&#x27;</span>: <span class="number">44</span>, <span class="string">&#x27;t&#x27;</span>: <span class="number">45</span>,</span><br><span class="line">                        <span class="string">&#x27;u&#x27;</span>: <span class="number">46</span>, <span class="string">&#x27;v&#x27;</span>: <span class="number">47</span>, <span class="string">&#x27;w&#x27;</span>: <span class="number">48</span>, <span class="string">&#x27;x&#x27;</span>: <span class="number">49</span>, <span class="string">&#x27;y&#x27;</span>: <span class="number">50</span>, <span class="string">&#x27;z&#x27;</span>: <span class="number">51</span>, <span class="string">&#x27;0&#x27;</span>: <span class="number">52</span>, <span class="string">&#x27;1&#x27;</span>: <span class="number">53</span>, <span class="string">&#x27;2&#x27;</span>: <span class="number">54</span>,</span><br><span class="line">                        <span class="string">&#x27;3&#x27;</span>: <span class="number">55</span>, <span class="string">&#x27;4&#x27;</span>: <span class="number">56</span>, <span class="string">&#x27;5&#x27;</span>: <span class="number">57</span>, <span class="string">&#x27;6&#x27;</span>: <span class="number">58</span>, <span class="string">&#x27;7&#x27;</span>: <span class="number">59</span>, <span class="string">&#x27;8&#x27;</span>: <span class="number">60</span>, <span class="string">&#x27;9&#x27;</span>: <span class="number">61</span>, <span class="string">&#x27;+&#x27;</span>: <span class="number">62</span>, <span class="string">&#x27;/&#x27;</span>: <span class="number">63</span> &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># base64转码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">enb64</span>(<span class="params"> source, enbytes = <span class="literal">True</span> </span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = source.encode( )  <span class="comment"># 预处理将传入值转为2进制流</span></span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        data = source</span><br><span class="line">    length = <span class="built_in">len</span>(data)  <span class="comment"># 获取需转码的值的总长度</span></span><br><span class="line">    end = length % <span class="number">3</span>  <span class="comment"># 获取补位数</span></span><br><span class="line">    out = <span class="string">&quot;&quot;</span>  <span class="comment"># 预设输出变量</span></span><br><span class="line">    equal = <span class="string">&quot;&quot;</span>  <span class="comment"># 预设输出补位</span></span><br><span class="line">    <span class="keyword">if</span> (end != <span class="number">0</span>):  <span class="comment"># 若补位数不为0则计算需要进行的补位各个量</span></span><br><span class="line">        tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span> - end):</span><br><span class="line">            tmp += <span class="string">&quot;\x00&quot;</span></span><br><span class="line">            equal += <span class="string">&quot;=&quot;</span></span><br><span class="line">        data += <span class="built_in">bytes</span>(tmp.encode( ))  <span class="comment"># 进行补位(\x00)</span></span><br><span class="line">        length += <span class="number">3</span> - end  <span class="comment"># 刷新补位后的总长度</span></span><br><span class="line">    <span class="keyword">for</span> part <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">3</span>):  <span class="comment"># 以每3个字节为1组进行操作</span></span><br><span class="line">        bins = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> byte <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            bins += <span class="string">&quot;%08d&quot;</span> % <span class="built_in">int</span>(<span class="built_in">bin</span>(data[ part * <span class="number">3</span> + byte ])[ <span class="number">2</span>: ])  <span class="comment"># 将每3个字节分解成 3 * 8 共 24 个bit</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> byte <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            out += base64_dict[ <span class="built_in">int</span>(bins[ byte * <span class="number">6</span>:(byte + <span class="number">1</span>) * <span class="number">6</span> ], <span class="number">2</span>) ]  <span class="comment"># 从上边24个bit中每6个bit的数值索引base64编码</span></span><br><span class="line">    <span class="keyword">if</span> (end != <span class="number">0</span>):  <span class="comment"># 若补位数不为0则在结果后边补上对应数量的&quot;=&quot;</span></span><br><span class="line">        out = (out[ :(-<span class="number">1</span>) * (<span class="number">3</span> - end) ] + equal)</span><br><span class="line">    <span class="keyword">if</span> (enbytes):  <span class="comment"># 判断是否需要将结果转为2进制流</span></span><br><span class="line">        out = out.encode( )</span><br><span class="line">    <span class="keyword">return</span> out  <span class="comment"># 输出结果</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># base64解码</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">deb64</span>(<span class="params"> source, debytes = <span class="literal">True</span> </span>):</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        data = source.decode( )  <span class="comment"># 预处理将传入值进行2进制流解码</span></span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        data = source</span><br><span class="line">    length = <span class="built_in">len</span>(data)  <span class="comment"># 计算总长</span></span><br><span class="line">    equaln = length % <span class="number">4</span>  <span class="comment"># 若长度不正确自动补&quot;=&quot;</span></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(equaln):  <span class="comment"># 补&quot;=&quot;</span></span><br><span class="line">        data += <span class="string">&quot;=&quot;</span></span><br><span class="line">    end = data.count(<span class="string">&quot;=&quot;</span>)  <span class="comment"># 计算&quot;=&quot;的数量</span></span><br><span class="line">    out = <span class="built_in">bytes</span>( )  <span class="comment"># 预设输出变量</span></span><br><span class="line">    data = data.replace(<span class="string">&quot;=&quot;</span>, <span class="string">&quot;A&quot;</span>)  <span class="comment"># 将补位符&quot;=&quot;转换成&quot;A&quot;(000000)以好做解码处理</span></span><br><span class="line">    <span class="keyword">for</span> part <span class="keyword">in</span> <span class="built_in">range</span>(length // <span class="number">4</span>):  <span class="comment"># 以每4个字符1组进行解码</span></span><br><span class="line">        bins = <span class="string">&quot;&quot;</span></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            bins += <span class="string">&quot;%06d&quot;</span> % <span class="built_in">int</span>(</span><br><span class="line">                <span class="built_in">bin</span>(base64_reverse_dict[ data[ part * <span class="number">4</span> + each ] ])[ <span class="number">2</span>: ])  <span class="comment"># 将组中每个字符经过base64编码逆表得到的数值重组回24bit</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            out += <span class="built_in">bytes</span>(<span class="built_in">chr</span>(<span class="built_in">int</span>(bins[ each * <span class="number">8</span>:(each + <span class="number">1</span>) * <span class="number">8</span> ], <span class="number">2</span>)).encode(<span class="string">&quot;latin1&quot;</span>))  <span class="comment"># 将得到的24bit重组回 3 * 8 模式的3个字节</span></span><br><span class="line">    <span class="keyword">if</span> (end != <span class="number">0</span>):  <span class="comment"># 若存在补位则将后边补位的&quot;\x00&quot;去除</span></span><br><span class="line">        out = out[ :(-<span class="number">1</span>) * end ]</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">not</span> debytes):  <span class="comment"># 判断是否将二进制流结果解码</span></span><br><span class="line">        out = out.decode( )</span><br><span class="line">    <span class="keyword">return</span> out  <span class="comment"># 输出结果</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="AES128"><a href="#AES128" class="headerlink" title="- AES128 -"></a><strong>- AES128 -</strong></h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@Description: AES128</span></span><br><span class="line"><span class="string">@Author: DQ</span></span><br><span class="line"><span class="string">@LastEditors  : DQ</span></span><br><span class="line"><span class="string">@Date: 2020-03-14 21:16:22</span></span><br><span class="line"><span class="string">@LastEditTime : 2020-03-15 01:52:14</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> b64, re, functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AES_128</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params"> self </span>):</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 声明正S盒</span></span><br><span class="line">        self.S_box = [</span><br><span class="line">            [ <span class="number">0x63</span>, <span class="number">0x7c</span>, <span class="number">0x77</span>, <span class="number">0x7b</span>, <span class="number">0xf2</span>, <span class="number">0x6b</span>, <span class="number">0x6f</span>, <span class="number">0xc5</span>, <span class="number">0x30</span>, <span class="number">0x01</span>, <span class="number">0x67</span>, <span class="number">0x2b</span>, <span class="number">0xfe</span>, <span class="number">0xd7</span>, <span class="number">0xab</span>, <span class="number">0x76</span> ],</span><br><span class="line">            [ <span class="number">0xca</span>, <span class="number">0x82</span>, <span class="number">0xc9</span>, <span class="number">0x7d</span>, <span class="number">0xfa</span>, <span class="number">0x59</span>, <span class="number">0x47</span>, <span class="number">0xf0</span>, <span class="number">0xad</span>, <span class="number">0xd4</span>, <span class="number">0xa2</span>, <span class="number">0xaf</span>, <span class="number">0x9c</span>, <span class="number">0xa4</span>, <span class="number">0x72</span>, <span class="number">0xc0</span> ],</span><br><span class="line">            [ <span class="number">0xb7</span>, <span class="number">0xfd</span>, <span class="number">0x93</span>, <span class="number">0x26</span>, <span class="number">0x36</span>, <span class="number">0x3f</span>, <span class="number">0xf7</span>, <span class="number">0xcc</span>, <span class="number">0x34</span>, <span class="number">0xa5</span>, <span class="number">0xe5</span>, <span class="number">0xf1</span>, <span class="number">0x71</span>, <span class="number">0xd8</span>, <span class="number">0x31</span>, <span class="number">0x15</span> ],</span><br><span class="line">            [ <span class="number">0x04</span>, <span class="number">0xc7</span>, <span class="number">0x23</span>, <span class="number">0xc3</span>, <span class="number">0x18</span>, <span class="number">0x96</span>, <span class="number">0x05</span>, <span class="number">0x9a</span>, <span class="number">0x07</span>, <span class="number">0x12</span>, <span class="number">0x80</span>, <span class="number">0xe2</span>, <span class="number">0xeb</span>, <span class="number">0x27</span>, <span class="number">0xb2</span>, <span class="number">0x75</span> ],</span><br><span class="line">            [ <span class="number">0x09</span>, <span class="number">0x83</span>, <span class="number">0x2c</span>, <span class="number">0x1a</span>, <span class="number">0x1b</span>, <span class="number">0x6e</span>, <span class="number">0x5a</span>, <span class="number">0xa0</span>, <span class="number">0x52</span>, <span class="number">0x3b</span>, <span class="number">0xd6</span>, <span class="number">0xb3</span>, <span class="number">0x29</span>, <span class="number">0xe3</span>, <span class="number">0x2f</span>, <span class="number">0x84</span> ],</span><br><span class="line">            [ <span class="number">0x53</span>, <span class="number">0xd1</span>, <span class="number">0x00</span>, <span class="number">0xed</span>, <span class="number">0x20</span>, <span class="number">0xfc</span>, <span class="number">0xb1</span>, <span class="number">0x5b</span>, <span class="number">0x6a</span>, <span class="number">0xcb</span>, <span class="number">0xbe</span>, <span class="number">0x39</span>, <span class="number">0x4a</span>, <span class="number">0x4c</span>, <span class="number">0x58</span>, <span class="number">0xcf</span> ],</span><br><span class="line">            [ <span class="number">0xd0</span>, <span class="number">0xef</span>, <span class="number">0xaa</span>, <span class="number">0xfb</span>, <span class="number">0x43</span>, <span class="number">0x4d</span>, <span class="number">0x33</span>, <span class="number">0x85</span>, <span class="number">0x45</span>, <span class="number">0xf9</span>, <span class="number">0x02</span>, <span class="number">0x7f</span>, <span class="number">0x50</span>, <span class="number">0x3c</span>, <span class="number">0x9f</span>, <span class="number">0xa8</span> ],</span><br><span class="line">            [ <span class="number">0x51</span>, <span class="number">0xa3</span>, <span class="number">0x40</span>, <span class="number">0x8f</span>, <span class="number">0x92</span>, <span class="number">0x9d</span>, <span class="number">0x38</span>, <span class="number">0xf5</span>, <span class="number">0xbc</span>, <span class="number">0xb6</span>, <span class="number">0xda</span>, <span class="number">0x21</span>, <span class="number">0x10</span>, <span class="number">0xff</span>, <span class="number">0xf3</span>, <span class="number">0xd2</span> ],</span><br><span class="line">            [ <span class="number">0xcd</span>, <span class="number">0x0c</span>, <span class="number">0x13</span>, <span class="number">0xec</span>, <span class="number">0x5f</span>, <span class="number">0x97</span>, <span class="number">0x44</span>, <span class="number">0x17</span>, <span class="number">0xc4</span>, <span class="number">0xa7</span>, <span class="number">0x7e</span>, <span class="number">0x3d</span>, <span class="number">0x64</span>, <span class="number">0x5d</span>, <span class="number">0x19</span>, <span class="number">0x73</span> ],</span><br><span class="line">            [ <span class="number">0x60</span>, <span class="number">0x81</span>, <span class="number">0x4f</span>, <span class="number">0xdc</span>, <span class="number">0x22</span>, <span class="number">0x2a</span>, <span class="number">0x90</span>, <span class="number">0x88</span>, <span class="number">0x46</span>, <span class="number">0xee</span>, <span class="number">0xb8</span>, <span class="number">0x14</span>, <span class="number">0xde</span>, <span class="number">0x5e</span>, <span class="number">0x0b</span>, <span class="number">0xdb</span> ],</span><br><span class="line">            [ <span class="number">0xe0</span>, <span class="number">0x32</span>, <span class="number">0x3a</span>, <span class="number">0x0a</span>, <span class="number">0x49</span>, <span class="number">0x06</span>, <span class="number">0x24</span>, <span class="number">0x5c</span>, <span class="number">0xc2</span>, <span class="number">0xd3</span>, <span class="number">0xac</span>, <span class="number">0x62</span>, <span class="number">0x91</span>, <span class="number">0x95</span>, <span class="number">0xe4</span>, <span class="number">0x79</span> ],</span><br><span class="line">            [ <span class="number">0xe7</span>, <span class="number">0xc8</span>, <span class="number">0x37</span>, <span class="number">0x6d</span>, <span class="number">0x8d</span>, <span class="number">0xd5</span>, <span class="number">0x4e</span>, <span class="number">0xa9</span>, <span class="number">0x6c</span>, <span class="number">0x56</span>, <span class="number">0xf4</span>, <span class="number">0xea</span>, <span class="number">0x65</span>, <span class="number">0x7a</span>, <span class="number">0xae</span>, <span class="number">0x08</span> ],</span><br><span class="line">            [ <span class="number">0xba</span>, <span class="number">0x78</span>, <span class="number">0x25</span>, <span class="number">0x2e</span>, <span class="number">0x1c</span>, <span class="number">0xa6</span>, <span class="number">0xb4</span>, <span class="number">0xc6</span>, <span class="number">0xe8</span>, <span class="number">0xdd</span>, <span class="number">0x74</span>, <span class="number">0x1f</span>, <span class="number">0x4b</span>, <span class="number">0xbd</span>, <span class="number">0x8b</span>, <span class="number">0x8a</span> ],</span><br><span class="line">            [ <span class="number">0x70</span>, <span class="number">0x3e</span>, <span class="number">0xb5</span>, <span class="number">0x66</span>, <span class="number">0x48</span>, <span class="number">0x03</span>, <span class="number">0xf6</span>, <span class="number">0x0e</span>, <span class="number">0x61</span>, <span class="number">0x35</span>, <span class="number">0x57</span>, <span class="number">0xb9</span>, <span class="number">0x86</span>, <span class="number">0xc1</span>, <span class="number">0x1d</span>, <span class="number">0x9e</span> ],</span><br><span class="line">            [ <span class="number">0xe1</span>, <span class="number">0xf8</span>, <span class="number">0x98</span>, <span class="number">0x11</span>, <span class="number">0x69</span>, <span class="number">0xd9</span>, <span class="number">0x8e</span>, <span class="number">0x94</span>, <span class="number">0x9b</span>, <span class="number">0x1e</span>, <span class="number">0x87</span>, <span class="number">0xe9</span>, <span class="number">0xce</span>, <span class="number">0x55</span>, <span class="number">0x28</span>, <span class="number">0xdf</span> ],</span><br><span class="line">            [ <span class="number">0x8c</span>, <span class="number">0xa1</span>, <span class="number">0x89</span>, <span class="number">0x0d</span>, <span class="number">0xbf</span>, <span class="number">0xe6</span>, <span class="number">0x42</span>, <span class="number">0x68</span>, <span class="number">0x41</span>, <span class="number">0x99</span>, <span class="number">0x2d</span>, <span class="number">0x0f</span>, <span class="number">0xb0</span>, <span class="number">0x54</span>, <span class="number">0xbb</span>, <span class="number">0x16</span> ]</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 声明S盒的逆</span></span><br><span class="line">        self.S_box_r = [</span><br><span class="line">            [ <span class="number">0x52</span>, <span class="number">0x09</span>, <span class="number">0x6a</span>, <span class="number">0xd5</span>, <span class="number">0x30</span>, <span class="number">0x36</span>, <span class="number">0xa5</span>, <span class="number">0x38</span>, <span class="number">0xbf</span>, <span class="number">0x40</span>, <span class="number">0xa3</span>, <span class="number">0x9e</span>, <span class="number">0x81</span>, <span class="number">0xf3</span>, <span class="number">0xd7</span>, <span class="number">0xfb</span> ],</span><br><span class="line">            [ <span class="number">0x7c</span>, <span class="number">0xe3</span>, <span class="number">0x39</span>, <span class="number">0x82</span>, <span class="number">0x9b</span>, <span class="number">0x2f</span>, <span class="number">0xff</span>, <span class="number">0x87</span>, <span class="number">0x34</span>, <span class="number">0x8e</span>, <span class="number">0x43</span>, <span class="number">0x44</span>, <span class="number">0xc4</span>, <span class="number">0xde</span>, <span class="number">0xe9</span>, <span class="number">0xcb</span> ],</span><br><span class="line">            [ <span class="number">0x54</span>, <span class="number">0x7b</span>, <span class="number">0x94</span>, <span class="number">0x32</span>, <span class="number">0xa6</span>, <span class="number">0xc2</span>, <span class="number">0x23</span>, <span class="number">0x3d</span>, <span class="number">0xee</span>, <span class="number">0x4c</span>, <span class="number">0x95</span>, <span class="number">0x0b</span>, <span class="number">0x42</span>, <span class="number">0xfa</span>, <span class="number">0xc3</span>, <span class="number">0x4e</span> ],</span><br><span class="line">            [ <span class="number">0x08</span>, <span class="number">0x2e</span>, <span class="number">0xa1</span>, <span class="number">0x66</span>, <span class="number">0x28</span>, <span class="number">0xd9</span>, <span class="number">0x24</span>, <span class="number">0xb2</span>, <span class="number">0x76</span>, <span class="number">0x5b</span>, <span class="number">0xa2</span>, <span class="number">0x49</span>, <span class="number">0x6d</span>, <span class="number">0x8b</span>, <span class="number">0xd1</span>, <span class="number">0x25</span> ],</span><br><span class="line">            [ <span class="number">0x72</span>, <span class="number">0xf8</span>, <span class="number">0xf6</span>, <span class="number">0x64</span>, <span class="number">0x86</span>, <span class="number">0x68</span>, <span class="number">0x98</span>, <span class="number">0x16</span>, <span class="number">0xd4</span>, <span class="number">0xa4</span>, <span class="number">0x5c</span>, <span class="number">0xcc</span>, <span class="number">0x5d</span>, <span class="number">0x65</span>, <span class="number">0xb6</span>, <span class="number">0x92</span> ],</span><br><span class="line">            [ <span class="number">0x6c</span>, <span class="number">0x70</span>, <span class="number">0x48</span>, <span class="number">0x50</span>, <span class="number">0xfd</span>, <span class="number">0xed</span>, <span class="number">0xb9</span>, <span class="number">0xda</span>, <span class="number">0x5e</span>, <span class="number">0x15</span>, <span class="number">0x46</span>, <span class="number">0x57</span>, <span class="number">0xa7</span>, <span class="number">0x8d</span>, <span class="number">0x9d</span>, <span class="number">0x84</span> ],</span><br><span class="line">            [ <span class="number">0x90</span>, <span class="number">0xd8</span>, <span class="number">0xab</span>, <span class="number">0x00</span>, <span class="number">0x8c</span>, <span class="number">0xbc</span>, <span class="number">0xd3</span>, <span class="number">0x0a</span>, <span class="number">0xf7</span>, <span class="number">0xe4</span>, <span class="number">0x58</span>, <span class="number">0x05</span>, <span class="number">0xb8</span>, <span class="number">0xb3</span>, <span class="number">0x45</span>, <span class="number">0x06</span> ],</span><br><span class="line">            [ <span class="number">0xd0</span>, <span class="number">0x2c</span>, <span class="number">0x1e</span>, <span class="number">0x8f</span>, <span class="number">0xca</span>, <span class="number">0x3f</span>, <span class="number">0x0f</span>, <span class="number">0x02</span>, <span class="number">0xc1</span>, <span class="number">0xaf</span>, <span class="number">0xbd</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x13</span>, <span class="number">0x8a</span>, <span class="number">0x6b</span> ],</span><br><span class="line">            [ <span class="number">0x3a</span>, <span class="number">0x91</span>, <span class="number">0x11</span>, <span class="number">0x41</span>, <span class="number">0x4f</span>, <span class="number">0x67</span>, <span class="number">0xdc</span>, <span class="number">0xea</span>, <span class="number">0x97</span>, <span class="number">0xf2</span>, <span class="number">0xcf</span>, <span class="number">0xce</span>, <span class="number">0xf0</span>, <span class="number">0xb4</span>, <span class="number">0xe6</span>, <span class="number">0x73</span> ],</span><br><span class="line">            [ <span class="number">0x96</span>, <span class="number">0xac</span>, <span class="number">0x74</span>, <span class="number">0x22</span>, <span class="number">0xe7</span>, <span class="number">0xad</span>, <span class="number">0x35</span>, <span class="number">0x85</span>, <span class="number">0xe2</span>, <span class="number">0xf9</span>, <span class="number">0x37</span>, <span class="number">0xe8</span>, <span class="number">0x1c</span>, <span class="number">0x75</span>, <span class="number">0xdf</span>, <span class="number">0x6e</span> ],</span><br><span class="line">            [ <span class="number">0x47</span>, <span class="number">0xf1</span>, <span class="number">0x1a</span>, <span class="number">0x71</span>, <span class="number">0x1d</span>, <span class="number">0x29</span>, <span class="number">0xc5</span>, <span class="number">0x89</span>, <span class="number">0x6f</span>, <span class="number">0xb7</span>, <span class="number">0x62</span>, <span class="number">0x0e</span>, <span class="number">0xaa</span>, <span class="number">0x18</span>, <span class="number">0xbe</span>, <span class="number">0x1b</span> ],</span><br><span class="line">            [ <span class="number">0xfc</span>, <span class="number">0x56</span>, <span class="number">0x3e</span>, <span class="number">0x4b</span>, <span class="number">0xc6</span>, <span class="number">0xd2</span>, <span class="number">0x79</span>, <span class="number">0x20</span>, <span class="number">0x9a</span>, <span class="number">0xdb</span>, <span class="number">0xc0</span>, <span class="number">0xfe</span>, <span class="number">0x78</span>, <span class="number">0xcd</span>, <span class="number">0x5a</span>, <span class="number">0xf4</span> ],</span><br><span class="line">            [ <span class="number">0x1f</span>, <span class="number">0xdd</span>, <span class="number">0xa8</span>, <span class="number">0x33</span>, <span class="number">0x88</span>, <span class="number">0x07</span>, <span class="number">0xc7</span>, <span class="number">0x31</span>, <span class="number">0xb1</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x59</span>, <span class="number">0x27</span>, <span class="number">0x80</span>, <span class="number">0xec</span>, <span class="number">0x5f</span> ],</span><br><span class="line">            [ <span class="number">0x60</span>, <span class="number">0x51</span>, <span class="number">0x7f</span>, <span class="number">0xa9</span>, <span class="number">0x19</span>, <span class="number">0xb5</span>, <span class="number">0x4a</span>, <span class="number">0x0d</span>, <span class="number">0x2d</span>, <span class="number">0xe5</span>, <span class="number">0x7a</span>, <span class="number">0x9f</span>, <span class="number">0x93</span>, <span class="number">0xc9</span>, <span class="number">0x9c</span>, <span class="number">0xef</span> ],</span><br><span class="line">            [ <span class="number">0xa0</span>, <span class="number">0xe0</span>, <span class="number">0x3b</span>, <span class="number">0x4d</span>, <span class="number">0xae</span>, <span class="number">0x2a</span>, <span class="number">0xf5</span>, <span class="number">0xb0</span>, <span class="number">0xc8</span>, <span class="number">0xeb</span>, <span class="number">0xbb</span>, <span class="number">0x3c</span>, <span class="number">0x83</span>, <span class="number">0x53</span>, <span class="number">0x99</span>, <span class="number">0x61</span> ],</span><br><span class="line">            [ <span class="number">0x17</span>, <span class="number">0x2b</span>, <span class="number">0x04</span>, <span class="number">0x7e</span>, <span class="number">0xba</span>, <span class="number">0x77</span>, <span class="number">0xd6</span>, <span class="number">0x26</span>, <span class="number">0xe1</span>, <span class="number">0x69</span>, <span class="number">0x14</span>, <span class="number">0x63</span>, <span class="number">0x55</span>, <span class="number">0x21</span>, <span class="number">0x0c</span>, <span class="number">0x7d</span> ]</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 声明RC常量</span></span><br><span class="line">        self.RC = [ <span class="number">0x00</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x04</span>, <span class="number">0x08</span>, <span class="number">0x10</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x80</span>, <span class="number">0x1B</span>, <span class="number">0x36</span> ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 声明列混淆矩阵常量</span></span><br><span class="line">        self.BOX = [</span><br><span class="line">            [ <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x01</span> ],</span><br><span class="line">            [ <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span>, <span class="number">0x01</span> ],</span><br><span class="line">            [ <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x02</span>, <span class="number">0x03</span> ],</span><br><span class="line">            [ <span class="number">0x03</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0x02</span> ]</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        self.BOX_r = [</span><br><span class="line">            [ <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span> ],</span><br><span class="line">            [ <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span>, <span class="number">0x0d</span> ],</span><br><span class="line">            [ <span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span>, <span class="number">0x0b</span> ],</span><br><span class="line">            [ <span class="number">0x0b</span>, <span class="number">0x0d</span>, <span class="number">0x09</span>, <span class="number">0x0e</span> ]</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 声明主要变量</span></span><br><span class="line">        self.KEY, self.KEY_EXTEND = [ ], [ ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 矩阵行列倒置</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">re_rc</span>(<span class="params"> self, box </span>):</span></span><br><span class="line">        <span class="keyword">return</span> [ [ row[ i ] <span class="keyword">for</span> row <span class="keyword">in</span> box ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box[ <span class="number">0</span> ])) ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 矩阵内容16进制字符转10进制数字</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">str2dec</span>(<span class="params"> self, box </span>):</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box)):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box[ i ])):</span><br><span class="line">                box[ i ][ j ] = <span class="built_in">int</span>(box[ i ][ j ], <span class="number">16</span>)</span><br><span class="line">        <span class="keyword">return</span> box</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 列混淆元计算</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fun2</span>(<span class="params"> self, i </span>):</span></span><br><span class="line">        i &lt;&lt;= <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (i &amp; <span class="number">0x100</span> != <span class="number">0</span>):</span><br><span class="line">            i = (i &amp; <span class="number">0xff</span>) ^ <span class="number">0x1b</span></span><br><span class="line">        <span class="keyword">return</span> i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取扩展密钥矩阵</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_extend</span>(<span class="params"> self, key, rc, count = <span class="number">10</span> </span>):</span></span><br><span class="line">        W = [ ]</span><br><span class="line">        W_each_len = <span class="built_in">len</span>(key)</span><br><span class="line">        <span class="keyword">for</span> col <span class="keyword">in</span> self.re_rc(key):</span><br><span class="line">            W.append(<span class="string">&quot;&quot;</span>.join(<span class="built_in">hex</span>(each)[ <span class="number">2</span>: ] <span class="keyword">for</span> each <span class="keyword">in</span> col).zfill(W_each_len * <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(W_each_len, (count + <span class="number">1</span>) * W_each_len):</span><br><span class="line">            <span class="keyword">if</span> (i % W_each_len):</span><br><span class="line">                W.append(<span class="built_in">hex</span>(<span class="built_in">int</span>(W[ i - W_each_len ], <span class="number">16</span>) ^ <span class="built_in">int</span>(W[ i - <span class="number">1</span> ], <span class="number">16</span>))[ <span class="number">2</span>: ].zfill(W_each_len * <span class="number">2</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                W_tmp = <span class="string">&quot;&quot;</span>.join(<span class="built_in">hex</span>(self.S_box[ <span class="built_in">int</span>(each[ <span class="number">0</span> ], <span class="number">16</span>) ][ <span class="built_in">int</span>(each[ <span class="number">1</span> ], <span class="number">16</span>) ])[ <span class="number">2</span>: ].zfill(<span class="number">2</span>) <span class="keyword">for</span> each <span class="keyword">in</span></span><br><span class="line">                                re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, W[ i - <span class="number">1</span> ][ <span class="number">2</span>: ] + W[ i - <span class="number">1</span> ][ :<span class="number">2</span> ]))</span><br><span class="line">                W.append(<span class="built_in">hex</span>(</span><br><span class="line">                    <span class="built_in">int</span>(<span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(W_tmp[ :<span class="number">2</span> ], <span class="number">16</span>) ^ rc[ i // W_each_len ]))[ <span class="number">2</span>: ].zfill(<span class="number">2</span>) + W_tmp[ <span class="number">2</span>: ], <span class="number">16</span>) ^ <span class="built_in">int</span>(</span><br><span class="line">                        W[ i - W_each_len ],</span><br><span class="line">                        <span class="number">16</span>))[ <span class="number">2</span>: ].zfill(</span><br><span class="line">                    W_each_len * <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> [ [ W[ W_each_len * i + j ] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(W_each_len) ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(W) // W_each_len) ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 加密</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">aes_encode</span>(<span class="params"> self, content, key, rc, box, count = <span class="number">10</span> </span>):</span></span><br><span class="line">        key_re = self.re_rc(key)  <span class="comment"># 密钥矩阵倒置</span></span><br><span class="line">        content_re = self.re_rc(content)  <span class="comment"># 明文矩阵倒置</span></span><br><span class="line">        key_extend = self.get_extend(key, rc, count)  <span class="comment"># 获取密钥扩展矩阵集</span></span><br><span class="line">        aes_en = [ [ ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key_re)) ]  <span class="comment"># 预设加密结果矩阵</span></span><br><span class="line">        aes_len = <span class="built_in">len</span>(key_re)  <span class="comment"># 计算矩阵边长</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 首次轮密钥加</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                aes_en[ i ].append(<span class="built_in">hex</span>(key_re[ i ][ j ] ^ content_re[ i ][ j ])[ <span class="number">2</span>: ].zfill(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 进行共10轮操作</span></span><br><span class="line">        <span class="keyword">for</span> this_round <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 字节替代</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                    aes_en[ i ][ j ] = <span class="built_in">hex</span>(</span><br><span class="line">                        self.S_box[ <span class="built_in">int</span>(aes_en[ i ][ j ][ <span class="number">0</span> ], <span class="number">16</span>) ][ <span class="built_in">int</span>(aes_en[ i ][ j ][ <span class="number">1</span> ], <span class="number">16</span>) ])[ <span class="number">2</span>: ].zfill(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 行位移</span></span><br><span class="line">            aes_en = self.re_rc(aes_en)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, aes_len):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                    aes_en[ i ].append(aes_en[ i ].pop(<span class="number">0</span>))</span><br><span class="line">            aes_en = self.re_rc(aes_en)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 若不为最后一次加密则进行列混淆</span></span><br><span class="line">            <span class="keyword">if</span> (this_round != <span class="number">9</span>):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                    tmp_list = [ ]</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                        tmp_ = [ ]</span><br><span class="line">                        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                            a = <span class="built_in">int</span>(aes_en[ i ][ k ], <span class="number">16</span>)</span><br><span class="line">                            b = <span class="built_in">bin</span>(box[ j ][ k ])[ <span class="number">2</span>: ][ ::-<span class="number">1</span> ]</span><br><span class="line">                            w = <span class="built_in">eval</span>(<span class="string">&quot;^&quot;</span>.join([ line <span class="keyword">for</span> line <span class="keyword">in</span> <span class="string">&quot;^&quot;</span>.join(</span><br><span class="line">                                [ <span class="string">&quot;self.fun2(&quot;</span> * (bit - <span class="number">1</span>) + <span class="string">&quot;a&quot;</span> * (bit &gt; <span class="number">0</span>) + <span class="string">&quot;)&quot;</span> * (bit - <span class="number">1</span>) <span class="keyword">for</span> bit <span class="keyword">in</span></span><br><span class="line">                                  [ pos * <span class="built_in">bool</span>(<span class="built_in">int</span>(b[ pos - <span class="number">1</span> ])) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(b) + <span class="number">1</span>) ] ]).split(<span class="string">&#x27;^&#x27;</span>) <span class="keyword">if</span></span><br><span class="line">                                                <span class="built_in">bool</span>(line) ]))</span><br><span class="line">                            tmp_.append(w)</span><br><span class="line">                        tmp_list.append(<span class="built_in">hex</span>(functools.reduce(<span class="keyword">lambda</span> x, y: x ^ y, tmp_))[ <span class="number">2</span>: ].zfill(<span class="number">2</span>))</span><br><span class="line">                    aes_en[ i ] = tmp_list</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 轮密钥加</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                tmp_list = re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, key_extend[ this_round + <span class="number">1</span> ][ i ])</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                    aes_en[ i ][ j ] = <span class="built_in">hex</span>(<span class="built_in">int</span>(aes_en[ i ][ j ], <span class="number">16</span>) ^ <span class="built_in">int</span>(tmp_list[ j ], <span class="number">16</span>))[ <span class="number">2</span>: ].zfill(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.re_rc(aes_en)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 解密</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">aes_decode</span>(<span class="params"> self, passwd, key, rc, box, count = <span class="number">10</span> </span>):</span></span><br><span class="line">        passwd_re = self.re_rc(passwd)  <span class="comment"># 密文矩阵倒置</span></span><br><span class="line">        key_extend = self.get_extend(key, rc, count)  <span class="comment"># 获取密钥扩展矩阵集</span></span><br><span class="line">        aes_de = [ [ ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key)) ]  <span class="comment"># 预设解密结果矩阵</span></span><br><span class="line">        aes_len = <span class="built_in">len</span>(key)  <span class="comment"># 计算矩阵边长</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 首次轮密钥加</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                aes_de[ i ].append(</span><br><span class="line">                    <span class="built_in">hex</span>(<span class="built_in">int</span>(key_extend[ count ][ i ][ j * <span class="number">2</span>:(j + <span class="number">1</span>) * <span class="number">2</span> ], <span class="number">16</span>) ^ passwd_re[ i ][ j ])[ <span class="number">2</span>: ].zfill(</span><br><span class="line">                        <span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 进行共10轮操作</span></span><br><span class="line">        <span class="keyword">for</span> this_round <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 进行逆向行位移</span></span><br><span class="line">            aes_de = self.re_rc(aes_de)</span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, aes_len):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                    aes_de[ i ].insert(<span class="number">0</span>, aes_de[ i ].pop( ))</span><br><span class="line">            aes_de = self.re_rc(aes_de)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 进行逆向字节替代</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                    aes_de[ i ][ j ] = <span class="built_in">hex</span>(</span><br><span class="line">                        self.S_box_r[ <span class="built_in">int</span>(aes_de[ i ][ j ][ <span class="number">0</span> ], <span class="number">16</span>) ][ <span class="built_in">int</span>(aes_de[ i ][ j ][ <span class="number">1</span> ], <span class="number">16</span>) ])[ <span class="number">2</span>: ].zfill(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 进行路密钥加</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                tmp_list = re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, key_extend[ count - this_round - <span class="number">1</span> ][ i ])</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                    aes_de[ i ][ j ] = <span class="built_in">hex</span>(<span class="built_in">int</span>(aes_de[ i ][ j ], <span class="number">16</span>) ^ <span class="built_in">int</span>(tmp_list[ j ], <span class="number">16</span>))[ <span class="number">2</span>: ].zfill(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 进行逆向列混淆</span></span><br><span class="line">            <span class="keyword">if</span> (this_round != <span class="number">9</span>):</span><br><span class="line">                <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                    tmp_list = [ ]</span><br><span class="line">                    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                        tmp_ = [ ]</span><br><span class="line">                        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(aes_len):</span><br><span class="line">                            a = <span class="built_in">int</span>(aes_de[ i ][ k ], <span class="number">16</span>)</span><br><span class="line">                            b = <span class="built_in">bin</span>(box[ j ][ k ])[ <span class="number">2</span>: ][ ::-<span class="number">1</span> ]</span><br><span class="line">                            w = <span class="built_in">eval</span>(<span class="string">&quot;^&quot;</span>.join([ line <span class="keyword">for</span> line <span class="keyword">in</span> <span class="string">&quot;^&quot;</span>.join(</span><br><span class="line">                                [ <span class="string">&quot;self.fun2(&quot;</span> * (bit - <span class="number">1</span>) + <span class="string">&quot;a&quot;</span> * (bit &gt; <span class="number">0</span>) + <span class="string">&quot;)&quot;</span> * (bit - <span class="number">1</span>) <span class="keyword">for</span> bit <span class="keyword">in</span></span><br><span class="line">                                  [ pos * <span class="built_in">bool</span>(<span class="built_in">int</span>(b[ pos - <span class="number">1</span> ])) <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(b) + <span class="number">1</span>) ] ]).split(<span class="string">&#x27;^&#x27;</span>) <span class="keyword">if</span></span><br><span class="line">                                                <span class="built_in">bool</span>(line) ]))</span><br><span class="line">                            tmp_.append(w)</span><br><span class="line">                        tmp_list.append(<span class="built_in">hex</span>(functools.reduce(<span class="keyword">lambda</span> x, y: x ^ y, tmp_))[ <span class="number">2</span>: ].zfill(<span class="number">2</span>))</span><br><span class="line">                    aes_de[ i ] = tmp_list</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.re_rc(aes_de)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init</span>(<span class="params"> self, key, count = <span class="number">10</span> </span>):</span></span><br><span class="line">        self.KEY = key</span><br><span class="line">        self.KEY_EXTEND = self.get_extend(key = key, rc = self.RC, count = count)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2box</span>(<span class="params"> s, r = <span class="number">4</span>, l = <span class="number">4</span>, byte = <span class="number">2</span> </span>):</span></span><br><span class="line">    box = [ [ ] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r) ]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">            box[ i ].append(<span class="built_in">int</span>(s[ (i * r + j) * byte:((i * r + j) + <span class="number">1</span>) * byte ], <span class="number">16</span>))</span><br><span class="line">    <span class="keyword">return</span> box</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">box2str</span>(<span class="params"> box </span>):</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box)):</span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> box[ row ]:</span><br><span class="line">            result += each</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># AES128加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes128_encode</span>(<span class="params"> content, aes, bit = <span class="number">32</span>, pad = <span class="string">&#x27;\n&#x27;</span> </span>):</span></span><br><span class="line">    s_hex_base64 = <span class="string">&quot;&quot;</span>.join([ <span class="string">&quot;%2x&quot;</span> % <span class="built_in">ord</span>(each) <span class="keyword">for</span> each <span class="keyword">in</span> b64.enb64(source = content, enbytes = <span class="literal">False</span>) ])</span><br><span class="line">    s_hex_base64_plus = s_hex_base64 + <span class="string">&quot;0&quot;</span> * (<span class="built_in">len</span>(s_hex_base64) % bit) <span class="keyword">if</span> <span class="built_in">len</span>(</span><br><span class="line">        s_hex_base64) &gt; bit <span class="keyword">else</span> s_hex_base64 + <span class="string">&quot;0&quot;</span> * (bit - <span class="built_in">len</span>(s_hex_base64))</span><br><span class="line">    <span class="keyword">return</span> pad.join(box2str(aes.aes_encode(</span><br><span class="line">        content = aes.re_rc(str2box(s = s_hex_base64_plus[ index * bit:(index + <span class="number">1</span>) * bit ], r = <span class="number">4</span>, l = <span class="number">4</span>, byte = <span class="number">2</span>)),</span><br><span class="line">        key = aes.KEY, rc = aes.RC, box = aes.BOX)) <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s_hex_base64_plus) // bit))</span><br><span class="line"></span><br><span class="line"><span class="comment"># AES128解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">aes128_decode</span>(<span class="params"> passwd, aes, bit = <span class="number">32</span>, pad = <span class="string">&#x27;\n&#x27;</span> </span>):</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span>.join(box2str(</span><br><span class="line">        aes.re_rc(aes.aes_decode(passwd = str2box(s = line, r = <span class="number">4</span>, l = <span class="number">4</span>, byte = <span class="number">2</span>), key = aes.KEY, rc = aes.RC,</span><br><span class="line">                                 box = aes.BOX_r))) <span class="keyword">for</span> line <span class="keyword">in</span> passwd.split(pad))</span><br><span class="line">    <span class="keyword">return</span> b64.deb64(</span><br><span class="line">        <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(result[ i * <span class="number">2</span>:(i + <span class="number">1</span>) * <span class="number">2</span> ], <span class="number">16</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(result) // <span class="number">2</span>)).replace(<span class="string">&quot;\x00&quot;</span>, <span class="string">&quot;&quot;</span>),</span><br><span class="line">        debytes = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示密钥矩阵</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_decbox</span>(<span class="params"> box </span>):</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[ &quot;</span> + <span class="string">&quot; , &quot;</span>.join(<span class="string">&quot;0x&quot;</span> + <span class="built_in">hex</span>(each)[ <span class="number">2</span>: ].zfill(<span class="number">2</span>) <span class="keyword">for</span> each <span class="keyword">in</span> box[ row ]) + <span class="string">&quot; ]&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示密钥扩展矩阵</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_key_extend_box</span>(<span class="params"> box </span>):</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box)):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ _ROUND_&lt;%02d&gt; ]&quot;</span> % row + <span class="string">&quot;*&quot;</span> * <span class="number">24</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box[ row ])):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[ &quot;</span> + <span class="string">&quot; , &quot;</span>.join(</span><br><span class="line">                <span class="string">&quot;0x&quot;</span> + box[ row ][ j ][ i * <span class="number">2</span>:(i + <span class="number">1</span>) * <span class="number">2</span> ].zfill(<span class="number">2</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box[ row ][ i ]) // <span class="number">2</span>)) + <span class="string">&quot; ]&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ _END_ROUND_ ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;\n\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2str</span>(<span class="params"> s </span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(each, <span class="number">16</span>)) <span class="keyword">for</span> each <span class="keyword">in</span> re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, s)).encode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 密钥矩阵</span></span><br><span class="line">    key = [</span><br><span class="line">        [ <span class="number">0x12</span>, <span class="number">0x34</span>, <span class="number">0x56</span>, <span class="number">0x78</span> ],</span><br><span class="line">        [ <span class="number">0x78</span>, <span class="number">0x65</span>, <span class="number">0x43</span>, <span class="number">0x21</span> ],</span><br><span class="line">        [ <span class="number">0x23</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span> ],</span><br><span class="line">        [ <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x33</span>, <span class="number">0x32</span> ]</span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    aes = AES_128( )</span><br><span class="line">    aes.init(key = key, count = <span class="number">10</span>)</span><br><span class="line">    pad = <span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">52</span> + <span class="string">&quot;[ AES128 ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">52</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密钥矩阵 =&gt; &quot;</span>)</span><br><span class="line">    show_decbox(aes.KEY)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密钥扩展矩阵 =&gt; &quot;</span>)</span><br><span class="line">    show_key_extend_box(aes.KEY_EXTEND)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">52</span> + <span class="string">&quot;[ AES128 ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">52</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c = aes128_encode(content = <span class="built_in">input</span>(<span class="string">&quot;请输入需要加密的信息：&quot;</span>), aes = aes, bit = <span class="number">32</span>, pad = pad)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[ 密文  =》]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[ 密文流  =》]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(hex2str(c.replace(pad, <span class="string">&quot;&quot;</span>)))</span><br><span class="line">            s = aes128_decode(passwd = c, aes = aes, bit = <span class="number">32</span>, pad = pad)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[ 明文  =》]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Bye!&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="RSA"><a href="#RSA" class="headerlink" title="- RSA -"></a>- RSA -</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@Description: RSA</span></span><br><span class="line"><span class="string">@Author: DQ</span></span><br><span class="line"><span class="string">@LastEditors  : DQ</span></span><br><span class="line"><span class="string">@Date: 2020-01-04 20:26:19</span></span><br><span class="line"><span class="string">@LastEditTime : 2020-03-15 03:03:20</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random, b64, re, math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSA_value</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params"> self </span>):</span></span><br><span class="line">        <span class="comment"># 声明主要变量</span></span><br><span class="line">        self.P, self.Q, self.N, self.Y, self.E, self.D = <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 声明小质数表</span></span><br><span class="line">        self.small_primes = [ <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>, <span class="number">23</span>, <span class="number">29</span>, <span class="number">31</span>, <span class="number">37</span>, <span class="number">41</span>, <span class="number">43</span>, <span class="number">47</span>, <span class="number">53</span>,</span><br><span class="line">                              <span class="number">59</span>, <span class="number">61</span>, <span class="number">67</span>, <span class="number">71</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">83</span>, <span class="number">89</span>, <span class="number">97</span>, <span class="number">101</span>, <span class="number">103</span>, <span class="number">107</span>, <span class="number">109</span>, <span class="number">113</span>, <span class="number">127</span>,</span><br><span class="line">                              <span class="number">131</span>, <span class="number">137</span>, <span class="number">139</span>, <span class="number">149</span>, <span class="number">151</span>, <span class="number">157</span>, <span class="number">163</span>, <span class="number">167</span>, <span class="number">173</span>, <span class="number">179</span>, <span class="number">181</span>, <span class="number">191</span>,</span><br><span class="line">                              <span class="number">193</span>, <span class="number">197</span>, <span class="number">199</span>, <span class="number">211</span>, <span class="number">223</span>, <span class="number">227</span>, <span class="number">229</span>, <span class="number">233</span>, <span class="number">239</span>, <span class="number">241</span>, <span class="number">251</span>, <span class="number">257</span>, <span class="number">263</span>,</span><br><span class="line">                              <span class="number">269</span>, <span class="number">271</span>, <span class="number">277</span>, <span class="number">281</span>, <span class="number">283</span>, <span class="number">293</span>, <span class="number">307</span>, <span class="number">311</span>, <span class="number">313</span>, <span class="number">317</span>, <span class="number">331</span>, <span class="number">337</span>, <span class="number">347</span>,</span><br><span class="line">                              <span class="number">349</span>, <span class="number">353</span>, <span class="number">359</span>, <span class="number">367</span>, <span class="number">373</span>, <span class="number">379</span>, <span class="number">383</span>, <span class="number">389</span>, <span class="number">397</span>, <span class="number">401</span>, <span class="number">409</span>, <span class="number">419</span>, <span class="number">421</span>,</span><br><span class="line">                              <span class="number">431</span>, <span class="number">433</span>, <span class="number">439</span>, <span class="number">443</span>, <span class="number">449</span>, <span class="number">457</span>, <span class="number">461</span>, <span class="number">463</span>, <span class="number">467</span>, <span class="number">479</span>, <span class="number">487</span>, <span class="number">491</span>, <span class="number">499</span>,</span><br><span class="line">                              <span class="number">503</span>, <span class="number">509</span>, <span class="number">521</span>, <span class="number">523</span>, <span class="number">541</span>, <span class="number">547</span>, <span class="number">557</span>, <span class="number">563</span>, <span class="number">569</span>, <span class="number">571</span>, <span class="number">577</span>, <span class="number">587</span>, <span class="number">593</span>,</span><br><span class="line">                              <span class="number">599</span>, <span class="number">601</span>, <span class="number">607</span>, <span class="number">613</span>, <span class="number">617</span>, <span class="number">619</span>, <span class="number">631</span>, <span class="number">641</span>, <span class="number">643</span>, <span class="number">647</span>, <span class="number">653</span>, <span class="number">659</span>,</span><br><span class="line">                              <span class="number">661</span>, <span class="number">673</span>, <span class="number">677</span>, <span class="number">683</span>, <span class="number">691</span>, <span class="number">701</span>, <span class="number">709</span>, <span class="number">719</span>, <span class="number">727</span>, <span class="number">733</span>, <span class="number">739</span>, <span class="number">743</span>, <span class="number">751</span>,</span><br><span class="line">                              <span class="number">757</span>, <span class="number">761</span>, <span class="number">769</span>, <span class="number">773</span>, <span class="number">787</span>, <span class="number">797</span>, <span class="number">809</span>, <span class="number">811</span>, <span class="number">821</span>, <span class="number">823</span>, <span class="number">827</span>, <span class="number">829</span>, <span class="number">839</span>,</span><br><span class="line">                              <span class="number">853</span>, <span class="number">857</span>, <span class="number">859</span>, <span class="number">863</span>, <span class="number">877</span>, <span class="number">881</span>, <span class="number">883</span>, <span class="number">887</span>, <span class="number">907</span>, <span class="number">911</span>, <span class="number">919</span>, <span class="number">929</span>, <span class="number">937</span>,</span><br><span class="line">                              <span class="number">941</span>, <span class="number">947</span>, <span class="number">953</span>, <span class="number">967</span>, <span class="number">971</span>, <span class="number">977</span>, <span class="number">983</span>, <span class="number">991</span>, <span class="number">997</span>, <span class="number">1009</span>, <span class="number">1013</span>,</span><br><span class="line">                              <span class="number">1019</span>, <span class="number">1021</span>, <span class="number">1031</span>, <span class="number">1033</span>, <span class="number">1039</span>, <span class="number">1049</span>, <span class="number">1051</span>, <span class="number">1061</span>, <span class="number">1063</span>, <span class="number">1069</span>,</span><br><span class="line">                              <span class="number">1087</span>, <span class="number">1091</span>, <span class="number">1093</span>, <span class="number">1097</span>, <span class="number">1103</span>, <span class="number">1109</span>, <span class="number">1117</span>, <span class="number">1123</span>, <span class="number">1129</span>, <span class="number">1151</span>,</span><br><span class="line">                              <span class="number">1153</span>, <span class="number">1163</span>, <span class="number">1171</span>, <span class="number">1181</span>, <span class="number">1187</span>, <span class="number">1193</span>, <span class="number">1201</span>, <span class="number">1213</span>, <span class="number">1217</span>, <span class="number">1223</span>,</span><br><span class="line">                              <span class="number">1229</span>, <span class="number">1231</span>, <span class="number">1237</span>, <span class="number">1249</span>, <span class="number">1259</span>, <span class="number">1277</span>, <span class="number">1279</span>, <span class="number">1283</span>, <span class="number">1289</span>, <span class="number">1291</span>,</span><br><span class="line">                              <span class="number">1297</span>, <span class="number">1301</span>, <span class="number">1303</span>, <span class="number">1307</span>, <span class="number">1319</span>, <span class="number">1321</span>, <span class="number">1327</span>, <span class="number">1361</span>, <span class="number">1367</span>, <span class="number">1373</span>,</span><br><span class="line">                              <span class="number">1381</span>, <span class="number">1399</span>, <span class="number">1409</span>, <span class="number">1423</span>, <span class="number">1427</span>, <span class="number">1429</span>, <span class="number">1433</span>, <span class="number">1439</span>, <span class="number">1447</span>, <span class="number">1451</span>,</span><br><span class="line">                              <span class="number">1453</span>, <span class="number">1459</span>, <span class="number">1471</span>, <span class="number">1481</span>, <span class="number">1483</span>, <span class="number">1487</span>, <span class="number">1489</span>, <span class="number">1493</span>, <span class="number">1499</span>, <span class="number">1511</span>,</span><br><span class="line">                              <span class="number">1523</span>, <span class="number">1531</span>, <span class="number">1543</span>, <span class="number">1549</span>, <span class="number">1553</span>, <span class="number">1559</span>, <span class="number">1567</span>, <span class="number">1571</span>, <span class="number">1579</span>, <span class="number">1583</span>,</span><br><span class="line">                              <span class="number">1597</span>, <span class="number">1601</span>, <span class="number">1607</span>, <span class="number">1609</span>, <span class="number">1613</span>, <span class="number">1619</span>, <span class="number">1621</span>, <span class="number">1627</span>, <span class="number">1637</span>, <span class="number">1657</span>,</span><br><span class="line">                              <span class="number">1663</span>, <span class="number">1667</span>, <span class="number">1669</span>, <span class="number">1693</span>, <span class="number">1697</span>, <span class="number">1699</span>, <span class="number">1709</span>, <span class="number">1721</span>, <span class="number">1723</span>, <span class="number">1733</span>,</span><br><span class="line">                              <span class="number">1741</span>, <span class="number">1747</span>, <span class="number">1753</span>, <span class="number">1759</span>, <span class="number">1777</span>, <span class="number">1783</span>, <span class="number">1787</span>, <span class="number">1789</span>, <span class="number">1801</span>, <span class="number">1811</span>,</span><br><span class="line">                              <span class="number">1823</span>, <span class="number">1831</span>, <span class="number">1847</span>, <span class="number">1861</span>, <span class="number">1867</span>, <span class="number">1871</span>, <span class="number">1873</span>, <span class="number">1877</span>, <span class="number">1879</span>, <span class="number">1889</span>,</span><br><span class="line">                              <span class="number">1901</span>, <span class="number">1907</span>, <span class="number">1913</span>, <span class="number">1931</span>, <span class="number">1933</span>, <span class="number">1949</span>, <span class="number">1951</span>, <span class="number">1973</span>, <span class="number">1979</span>, <span class="number">1987</span>,</span><br><span class="line">                              <span class="number">1993</span>, <span class="number">1997</span>, <span class="number">1999</span>, <span class="number">2003</span>, <span class="number">2011</span>, <span class="number">2017</span>, <span class="number">2027</span>, <span class="number">2029</span>, <span class="number">2039</span>, <span class="number">2053</span>,</span><br><span class="line">                              <span class="number">2063</span>, <span class="number">2069</span>, <span class="number">2081</span>, <span class="number">2083</span>, <span class="number">2087</span>, <span class="number">2089</span>, <span class="number">2099</span>, <span class="number">2111</span>, <span class="number">2113</span>, <span class="number">2129</span>,</span><br><span class="line">                              <span class="number">2131</span>, <span class="number">2137</span>, <span class="number">2141</span>, <span class="number">2143</span>, <span class="number">2153</span>, <span class="number">2161</span>, <span class="number">2179</span>, <span class="number">2203</span>, <span class="number">2207</span>, <span class="number">2213</span>,</span><br><span class="line">                              <span class="number">2221</span>, <span class="number">2237</span>, <span class="number">2239</span>, <span class="number">2243</span>, <span class="number">2251</span>, <span class="number">2267</span>, <span class="number">2269</span>, <span class="number">2273</span>, <span class="number">2281</span>, <span class="number">2287</span>,</span><br><span class="line">                              <span class="number">2293</span>, <span class="number">2297</span>, <span class="number">2309</span>, <span class="number">2311</span>, <span class="number">2333</span>, <span class="number">2339</span>, <span class="number">2341</span>, <span class="number">2347</span>, <span class="number">2351</span>, <span class="number">2357</span>,</span><br><span class="line">                              <span class="number">2371</span>, <span class="number">2377</span>, <span class="number">2381</span>, <span class="number">2383</span>, <span class="number">2389</span>, <span class="number">2393</span>, <span class="number">2399</span>, <span class="number">2411</span>, <span class="number">2417</span>, <span class="number">2423</span>,</span><br><span class="line">                              <span class="number">2437</span>, <span class="number">2441</span>, <span class="number">2447</span>, <span class="number">2459</span>, <span class="number">2467</span>, <span class="number">2473</span>, <span class="number">2477</span>, <span class="number">2503</span>, <span class="number">2521</span>, <span class="number">2531</span>,</span><br><span class="line">                              <span class="number">2539</span>, <span class="number">2543</span>, <span class="number">2549</span>, <span class="number">2551</span>, <span class="number">2557</span>, <span class="number">2579</span>, <span class="number">2591</span>, <span class="number">2593</span>, <span class="number">2609</span>, <span class="number">2617</span>,</span><br><span class="line">                              <span class="number">2621</span>, <span class="number">2633</span>, <span class="number">2647</span>, <span class="number">2657</span>, <span class="number">2659</span>, <span class="number">2663</span>, <span class="number">2671</span>, <span class="number">2677</span>, <span class="number">2683</span>, <span class="number">2687</span>,</span><br><span class="line">                              <span class="number">2689</span>, <span class="number">2693</span>, <span class="number">2699</span>, <span class="number">2707</span>, <span class="number">2711</span>, <span class="number">2713</span>, <span class="number">2719</span>, <span class="number">2729</span>, <span class="number">2731</span>, <span class="number">2741</span>,</span><br><span class="line">                              <span class="number">2749</span>, <span class="number">2753</span>, <span class="number">2767</span>, <span class="number">2777</span>, <span class="number">2789</span>, <span class="number">2791</span>, <span class="number">2797</span>, <span class="number">2801</span>, <span class="number">2803</span>, <span class="number">2819</span>,</span><br><span class="line">                              <span class="number">2833</span>, <span class="number">2837</span>, <span class="number">2843</span>, <span class="number">2851</span>, <span class="number">2857</span>, <span class="number">2861</span>, <span class="number">2879</span>, <span class="number">2887</span>, <span class="number">2897</span>, <span class="number">2903</span>,</span><br><span class="line">                              <span class="number">2909</span>, <span class="number">2917</span>, <span class="number">2927</span>, <span class="number">2939</span>, <span class="number">2953</span>, <span class="number">2957</span>, <span class="number">2963</span>, <span class="number">2969</span>, <span class="number">2971</span>, <span class="number">2999</span>,</span><br><span class="line">                              <span class="number">3001</span>, <span class="number">3011</span>, <span class="number">3019</span>, <span class="number">3023</span>, <span class="number">3037</span>, <span class="number">3041</span>, <span class="number">3049</span>, <span class="number">3061</span>, <span class="number">3067</span>, <span class="number">3079</span>,</span><br><span class="line">                              <span class="number">3083</span>, <span class="number">3089</span>, <span class="number">3109</span>, <span class="number">3119</span>, <span class="number">3121</span>, <span class="number">3137</span>, <span class="number">3163</span>, <span class="number">3167</span>, <span class="number">3169</span>, <span class="number">3181</span>,</span><br><span class="line">                              <span class="number">3187</span>, <span class="number">3191</span>, <span class="number">3203</span>, <span class="number">3209</span>, <span class="number">3217</span>, <span class="number">3221</span>, <span class="number">3229</span>, <span class="number">3251</span>, <span class="number">3253</span>, <span class="number">3257</span>,</span><br><span class="line">                              <span class="number">3259</span>, <span class="number">3271</span>, <span class="number">3299</span>, <span class="number">3301</span>, <span class="number">3307</span>, <span class="number">3313</span>, <span class="number">3319</span>, <span class="number">3323</span>, <span class="number">3329</span>, <span class="number">3331</span>,</span><br><span class="line">                              <span class="number">3343</span>, <span class="number">3347</span>, <span class="number">3359</span>, <span class="number">3361</span>, <span class="number">3371</span>, <span class="number">3373</span>, <span class="number">3389</span>, <span class="number">3391</span>, <span class="number">3407</span>, <span class="number">3413</span>,</span><br><span class="line">                              <span class="number">3433</span>, <span class="number">3449</span>, <span class="number">3457</span>, <span class="number">3461</span>, <span class="number">3463</span>, <span class="number">3467</span>, <span class="number">3469</span>, <span class="number">3491</span>, <span class="number">3499</span>, <span class="number">3511</span>,</span><br><span class="line">                              <span class="number">3517</span>, <span class="number">3527</span>, <span class="number">3529</span>, <span class="number">3533</span>, <span class="number">3539</span>, <span class="number">3541</span>, <span class="number">3547</span>, <span class="number">3557</span>, <span class="number">3559</span>, <span class="number">3571</span>,</span><br><span class="line">                              <span class="number">3581</span>, <span class="number">3583</span>, <span class="number">3593</span>, <span class="number">3607</span>, <span class="number">3613</span>, <span class="number">3617</span>, <span class="number">3623</span>, <span class="number">3631</span>, <span class="number">3637</span>, <span class="number">3643</span>,</span><br><span class="line">                              <span class="number">3659</span>, <span class="number">3671</span>, <span class="number">3673</span>, <span class="number">3677</span>, <span class="number">3691</span>, <span class="number">3697</span>, <span class="number">3701</span>, <span class="number">3709</span>, <span class="number">3719</span>, <span class="number">3727</span>,</span><br><span class="line">                              <span class="number">3733</span>, <span class="number">3739</span>, <span class="number">3761</span>, <span class="number">3767</span>, <span class="number">3769</span>, <span class="number">3779</span>, <span class="number">3793</span>, <span class="number">3797</span>, <span class="number">3803</span>, <span class="number">3821</span>,</span><br><span class="line">                              <span class="number">3823</span>, <span class="number">3833</span>, <span class="number">3847</span>, <span class="number">3851</span>, <span class="number">3853</span>, <span class="number">3863</span>, <span class="number">3877</span>, <span class="number">3881</span>, <span class="number">3889</span>, <span class="number">3907</span>,</span><br><span class="line">                              <span class="number">3911</span>, <span class="number">3917</span>, <span class="number">3919</span>, <span class="number">3923</span>, <span class="number">3929</span>, <span class="number">3931</span>, <span class="number">3943</span>, <span class="number">3947</span>, <span class="number">3967</span>, <span class="number">3989</span>,</span><br><span class="line">                              <span class="number">4001</span>, <span class="number">4003</span>, <span class="number">4007</span>, <span class="number">4013</span>, <span class="number">4019</span>, <span class="number">4021</span>, <span class="number">4027</span>, <span class="number">4049</span>, <span class="number">4051</span>, <span class="number">4057</span>,</span><br><span class="line">                              <span class="number">4073</span>, <span class="number">4079</span>, <span class="number">4091</span>, <span class="number">4093</span>, <span class="number">4099</span>, <span class="number">4111</span>, <span class="number">4127</span>, <span class="number">4129</span>, <span class="number">4133</span>, <span class="number">4139</span>,</span><br><span class="line">                              <span class="number">4153</span>, <span class="number">4157</span>, <span class="number">4159</span>, <span class="number">4177</span>, <span class="number">4201</span>, <span class="number">4211</span>, <span class="number">4217</span>, <span class="number">4219</span>, <span class="number">4229</span>, <span class="number">4231</span>,</span><br><span class="line">                              <span class="number">4241</span>, <span class="number">4243</span>, <span class="number">4253</span>, <span class="number">4259</span>, <span class="number">4261</span>, <span class="number">4271</span>, <span class="number">4273</span>, <span class="number">4283</span>, <span class="number">4289</span>, <span class="number">4297</span>,</span><br><span class="line">                              <span class="number">4327</span>, <span class="number">4337</span>, <span class="number">4339</span>, <span class="number">4349</span>, <span class="number">4357</span>, <span class="number">4363</span>, <span class="number">4373</span>, <span class="number">4391</span>, <span class="number">4397</span>, <span class="number">4409</span>,</span><br><span class="line">                              <span class="number">4421</span>, <span class="number">4423</span>, <span class="number">4441</span>, <span class="number">4447</span>, <span class="number">4451</span>, <span class="number">4457</span>, <span class="number">4463</span>, <span class="number">4481</span>, <span class="number">4483</span>, <span class="number">4493</span>,</span><br><span class="line">                              <span class="number">4507</span>, <span class="number">4513</span>, <span class="number">4517</span>, <span class="number">4519</span>, <span class="number">4523</span>, <span class="number">4547</span>, <span class="number">4549</span>, <span class="number">4561</span>, <span class="number">4567</span>, <span class="number">4583</span>,</span><br><span class="line">                              <span class="number">4591</span>, <span class="number">4597</span>, <span class="number">4603</span>, <span class="number">4621</span>, <span class="number">4637</span>, <span class="number">4639</span>, <span class="number">4643</span>, <span class="number">4649</span>, <span class="number">4651</span>, <span class="number">4657</span>,</span><br><span class="line">                              <span class="number">4663</span>, <span class="number">4673</span>, <span class="number">4679</span>, <span class="number">4691</span>, <span class="number">4703</span>, <span class="number">4721</span>, <span class="number">4723</span>, <span class="number">4729</span>, <span class="number">4733</span>, <span class="number">4751</span>,</span><br><span class="line">                              <span class="number">4759</span>, <span class="number">4783</span>, <span class="number">4787</span>, <span class="number">4789</span>, <span class="number">4793</span>, <span class="number">4799</span>, <span class="number">4801</span>, <span class="number">4813</span>, <span class="number">4817</span>, <span class="number">4831</span>,</span><br><span class="line">                              <span class="number">4861</span>, <span class="number">4871</span>, <span class="number">4877</span>, <span class="number">4889</span>, <span class="number">4903</span>, <span class="number">4909</span>, <span class="number">4919</span>, <span class="number">4931</span>, <span class="number">4933</span>, <span class="number">4937</span>,</span><br><span class="line">                              <span class="number">4943</span>, <span class="number">4951</span>, <span class="number">4957</span>, <span class="number">4967</span>, <span class="number">4969</span>, <span class="number">4973</span>, <span class="number">4987</span>, <span class="number">4993</span>, <span class="number">4999</span>, <span class="number">5003</span>,</span><br><span class="line">                              <span class="number">5009</span>, <span class="number">5011</span>, <span class="number">5021</span>, <span class="number">5023</span>, <span class="number">5039</span>, <span class="number">5051</span>, <span class="number">5059</span>, <span class="number">5077</span>, <span class="number">5081</span>, <span class="number">5087</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">5099</span>, <span class="number">5101</span>, <span class="number">5107</span>, <span class="number">5113</span>, <span class="number">5119</span>, <span class="number">5147</span>, <span class="number">5153</span>, <span class="number">5167</span>, <span class="number">5171</span>, <span class="number">5179</span>,</span><br><span class="line">                              <span class="number">5189</span>, <span class="number">5197</span>, <span class="number">5209</span>, <span class="number">5227</span>, <span class="number">5231</span>, <span class="number">5233</span>, <span class="number">5237</span>, <span class="number">5261</span>, <span class="number">5273</span>, <span class="number">5279</span>,</span><br><span class="line">                              <span class="number">5281</span>, <span class="number">5297</span>, <span class="number">5303</span>, <span class="number">5309</span>, <span class="number">5323</span>, <span class="number">5333</span>, <span class="number">5347</span>, <span class="number">5351</span>, <span class="number">5381</span>, <span class="number">5387</span>,</span><br><span class="line">                              <span class="number">5393</span>, <span class="number">5399</span>, <span class="number">5407</span>, <span class="number">5413</span>, <span class="number">5417</span>, <span class="number">5419</span>, <span class="number">5431</span>, <span class="number">5437</span>, <span class="number">5441</span>, <span class="number">5443</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">5449</span>, <span class="number">5471</span>, <span class="number">5477</span>, <span class="number">5479</span>, <span class="number">5483</span>, <span class="number">5501</span>, <span class="number">5503</span>, <span class="number">5507</span>, <span class="number">5519</span>, <span class="number">5521</span>,</span><br><span class="line">                              <span class="number">5527</span>, <span class="number">5531</span>, <span class="number">5557</span>, <span class="number">5563</span>, <span class="number">5569</span>, <span class="number">5573</span>, <span class="number">5581</span>, <span class="number">5591</span>, <span class="number">5623</span>, <span class="number">5639</span>,</span><br><span class="line">                              <span class="number">5641</span>, <span class="number">5647</span>, <span class="number">5651</span>, <span class="number">5653</span>, <span class="number">5657</span>, <span class="number">5659</span>, <span class="number">5669</span>, <span class="number">5683</span>, <span class="number">5689</span>, <span class="number">5693</span>,</span><br><span class="line">                              <span class="number">5701</span>, <span class="number">5711</span>, <span class="number">5717</span>, <span class="number">5737</span>, <span class="number">5741</span>, <span class="number">5743</span>, <span class="number">5749</span>, <span class="number">5779</span>, <span class="number">5783</span>, <span class="number">5791</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">5801</span>, <span class="number">5807</span>, <span class="number">5813</span>, <span class="number">5821</span>, <span class="number">5827</span>, <span class="number">5839</span>, <span class="number">5843</span>, <span class="number">5849</span>, <span class="number">5851</span>, <span class="number">5857</span>,</span><br><span class="line">                              <span class="number">5861</span>, <span class="number">5867</span>, <span class="number">5869</span>, <span class="number">5879</span>, <span class="number">5881</span>, <span class="number">5897</span>, <span class="number">5903</span>, <span class="number">5923</span>, <span class="number">5927</span>, <span class="number">5939</span>,</span><br><span class="line">                              <span class="number">5953</span>, <span class="number">5981</span>, <span class="number">5987</span>, <span class="number">6007</span>, <span class="number">6011</span>, <span class="number">6029</span>, <span class="number">6037</span>, <span class="number">6043</span>, <span class="number">6047</span>, <span class="number">6053</span>,</span><br><span class="line">                              <span class="number">6067</span>, <span class="number">6073</span>, <span class="number">6079</span>, <span class="number">6089</span>, <span class="number">6091</span>, <span class="number">6101</span>, <span class="number">6113</span>, <span class="number">6121</span>, <span class="number">6131</span>, <span class="number">6133</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">6143</span>, <span class="number">6151</span>, <span class="number">6163</span>, <span class="number">6173</span>, <span class="number">6197</span>, <span class="number">6199</span>, <span class="number">6203</span>, <span class="number">6211</span>, <span class="number">6217</span>, <span class="number">6221</span>,</span><br><span class="line">                              <span class="number">6229</span>, <span class="number">6247</span>, <span class="number">6257</span>, <span class="number">6263</span>, <span class="number">6269</span>, <span class="number">6271</span>, <span class="number">6277</span>, <span class="number">6287</span>, <span class="number">6299</span>, <span class="number">6301</span>,</span><br><span class="line">                              <span class="number">6311</span>, <span class="number">6317</span>, <span class="number">6323</span>, <span class="number">6329</span>, <span class="number">6337</span>, <span class="number">6343</span>, <span class="number">6353</span>, <span class="number">6359</span>, <span class="number">6361</span>, <span class="number">6367</span>,</span><br><span class="line">                              <span class="number">6373</span>, <span class="number">6379</span>, <span class="number">6389</span>, <span class="number">6397</span>, <span class="number">6421</span>, <span class="number">6427</span>, <span class="number">6449</span>, <span class="number">6451</span>, <span class="number">6469</span>, <span class="number">6473</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">6481</span>, <span class="number">6491</span>, <span class="number">6521</span>, <span class="number">6529</span>, <span class="number">6547</span>, <span class="number">6551</span>, <span class="number">6553</span>, <span class="number">6563</span>, <span class="number">6569</span>, <span class="number">6571</span>,</span><br><span class="line">                              <span class="number">6577</span>, <span class="number">6581</span>, <span class="number">6599</span>, <span class="number">6607</span>, <span class="number">6619</span>, <span class="number">6637</span>, <span class="number">6653</span>, <span class="number">6659</span>, <span class="number">6661</span>, <span class="number">6673</span>,</span><br><span class="line">                              <span class="number">6679</span>, <span class="number">6689</span>, <span class="number">6691</span>, <span class="number">6701</span>, <span class="number">6703</span>, <span class="number">6709</span>, <span class="number">6719</span>, <span class="number">6733</span>, <span class="number">6737</span>, <span class="number">6761</span>,</span><br><span class="line">                              <span class="number">6763</span>, <span class="number">6779</span>, <span class="number">6781</span>, <span class="number">6791</span>, <span class="number">6793</span>, <span class="number">6803</span>, <span class="number">6823</span>, <span class="number">6827</span>, <span class="number">6829</span>, <span class="number">6833</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">6841</span>, <span class="number">6857</span>, <span class="number">6863</span>, <span class="number">6869</span>, <span class="number">6871</span>, <span class="number">6883</span>, <span class="number">6899</span>, <span class="number">6907</span>, <span class="number">6911</span>, <span class="number">6917</span>,</span><br><span class="line">                              <span class="number">6947</span>, <span class="number">6949</span>, <span class="number">6959</span>, <span class="number">6961</span>, <span class="number">6967</span>, <span class="number">6971</span>, <span class="number">6977</span>, <span class="number">6983</span>, <span class="number">6991</span>, <span class="number">6997</span>,</span><br><span class="line">                              <span class="number">7001</span>, <span class="number">7013</span>, <span class="number">7019</span>, <span class="number">7027</span>, <span class="number">7039</span>, <span class="number">7043</span>, <span class="number">7057</span>, <span class="number">7069</span>, <span class="number">7079</span>, <span class="number">7103</span>,</span><br><span class="line">                              <span class="number">7109</span>, <span class="number">7121</span>, <span class="number">7127</span>, <span class="number">7129</span>, <span class="number">7151</span>, <span class="number">7159</span>, <span class="number">7177</span>, <span class="number">7187</span>, <span class="number">7193</span>, <span class="number">7207</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">7211</span>, <span class="number">7213</span>, <span class="number">7219</span>, <span class="number">7229</span>, <span class="number">7237</span>, <span class="number">7243</span>, <span class="number">7247</span>, <span class="number">7253</span>, <span class="number">7283</span>, <span class="number">7297</span>,</span><br><span class="line">                              <span class="number">7307</span>, <span class="number">7309</span>, <span class="number">7321</span>, <span class="number">7331</span>, <span class="number">7333</span>, <span class="number">7349</span>, <span class="number">7351</span>, <span class="number">7369</span>, <span class="number">7393</span>, <span class="number">7411</span>,</span><br><span class="line">                              <span class="number">7417</span>, <span class="number">7433</span>, <span class="number">7451</span>, <span class="number">7457</span>, <span class="number">7459</span>, <span class="number">7477</span>, <span class="number">7481</span>, <span class="number">7487</span>, <span class="number">7489</span>, <span class="number">7499</span>,</span><br><span class="line">                              <span class="number">7507</span>, <span class="number">7517</span>, <span class="number">7523</span>, <span class="number">7529</span>, <span class="number">7537</span>, <span class="number">7541</span>, <span class="number">7547</span>, <span class="number">7549</span>, <span class="number">7559</span>, <span class="number">7561</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">7573</span>, <span class="number">7577</span>, <span class="number">7583</span>, <span class="number">7589</span>, <span class="number">7591</span>, <span class="number">7603</span>, <span class="number">7607</span>, <span class="number">7621</span>, <span class="number">7639</span>, <span class="number">7643</span>,</span><br><span class="line">                              <span class="number">7649</span>, <span class="number">7669</span>, <span class="number">7673</span>, <span class="number">7681</span>, <span class="number">7687</span>, <span class="number">7691</span>, <span class="number">7699</span>, <span class="number">7703</span>, <span class="number">7717</span>, <span class="number">7723</span>,</span><br><span class="line">                              <span class="number">7727</span>, <span class="number">7741</span>, <span class="number">7753</span>, <span class="number">7757</span>, <span class="number">7759</span>, <span class="number">7789</span>, <span class="number">7793</span>, <span class="number">7817</span>, <span class="number">7823</span>, <span class="number">7829</span>,</span><br><span class="line">                              <span class="number">7841</span>, <span class="number">7853</span>, <span class="number">7867</span>, <span class="number">7873</span>, <span class="number">7877</span>, <span class="number">7879</span>, <span class="number">7883</span>, <span class="number">7901</span>, <span class="number">7907</span>, <span class="number">7919</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">7927</span>, <span class="number">7933</span>, <span class="number">7937</span>, <span class="number">7949</span>, <span class="number">7951</span>, <span class="number">7963</span>, <span class="number">7993</span>, <span class="number">8009</span>, <span class="number">8011</span>, <span class="number">8017</span>,</span><br><span class="line">                              <span class="number">8039</span>, <span class="number">8053</span>, <span class="number">8059</span>, <span class="number">8069</span>, <span class="number">8081</span>, <span class="number">8087</span>, <span class="number">8089</span>, <span class="number">8093</span>, <span class="number">8101</span>, <span class="number">8111</span>,</span><br><span class="line">                              <span class="number">8117</span>, <span class="number">8123</span>, <span class="number">8147</span>, <span class="number">8161</span>, <span class="number">8167</span>, <span class="number">8171</span>, <span class="number">8179</span>, <span class="number">8191</span>, <span class="number">8209</span>, <span class="number">8219</span>,</span><br><span class="line">                              <span class="number">8221</span>, <span class="number">8231</span>, <span class="number">8233</span>, <span class="number">8237</span>, <span class="number">8243</span>, <span class="number">8263</span>, <span class="number">8269</span>, <span class="number">8273</span>, <span class="number">8287</span>, <span class="number">8291</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">8293</span>, <span class="number">8297</span>, <span class="number">8311</span>, <span class="number">8317</span>, <span class="number">8329</span>, <span class="number">8353</span>, <span class="number">8363</span>, <span class="number">8369</span>, <span class="number">8377</span>, <span class="number">8387</span>,</span><br><span class="line">                              <span class="number">8389</span>, <span class="number">8419</span>, <span class="number">8423</span>, <span class="number">8429</span>, <span class="number">8431</span>, <span class="number">8443</span>, <span class="number">8447</span>, <span class="number">8461</span>, <span class="number">8467</span>, <span class="number">8501</span>,</span><br><span class="line">                              <span class="number">8513</span>, <span class="number">8521</span>, <span class="number">8527</span>, <span class="number">8537</span>, <span class="number">8539</span>, <span class="number">8543</span>, <span class="number">8563</span>, <span class="number">8573</span>, <span class="number">8581</span>, <span class="number">8597</span>,</span><br><span class="line">                              <span class="number">8599</span>, <span class="number">8609</span>, <span class="number">8623</span>, <span class="number">8627</span>, <span class="number">8629</span>, <span class="number">8641</span>, <span class="number">8647</span>, <span class="number">8663</span>, <span class="number">8669</span>, <span class="number">8677</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">8681</span>, <span class="number">8689</span>, <span class="number">8693</span>, <span class="number">8699</span>, <span class="number">8707</span>, <span class="number">8713</span>, <span class="number">8719</span>, <span class="number">8731</span>, <span class="number">8737</span>, <span class="number">8741</span>,</span><br><span class="line">                              <span class="number">8747</span>, <span class="number">8753</span>, <span class="number">8761</span>, <span class="number">8779</span>, <span class="number">8783</span>, <span class="number">8803</span>, <span class="number">8807</span>, <span class="number">8819</span>, <span class="number">8821</span>, <span class="number">8831</span>,</span><br><span class="line">                              <span class="number">8837</span>, <span class="number">8839</span>, <span class="number">8849</span>, <span class="number">8861</span>, <span class="number">8863</span>, <span class="number">8867</span>, <span class="number">8887</span>, <span class="number">8893</span>, <span class="number">8923</span>, <span class="number">8929</span>,</span><br><span class="line">                              <span class="number">8933</span>, <span class="number">8941</span>, <span class="number">8951</span>, <span class="number">8963</span>, <span class="number">8969</span>, <span class="number">8971</span>, <span class="number">8999</span>, <span class="number">9001</span>, <span class="number">9007</span>, <span class="number">9011</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">9013</span>, <span class="number">9029</span>, <span class="number">9041</span>, <span class="number">9043</span>, <span class="number">9049</span>, <span class="number">9059</span>, <span class="number">9067</span>, <span class="number">9091</span>, <span class="number">9103</span>, <span class="number">9109</span>,</span><br><span class="line">                              <span class="number">9127</span>, <span class="number">9133</span>, <span class="number">9137</span>, <span class="number">9151</span>, <span class="number">9157</span>, <span class="number">9161</span>, <span class="number">9173</span>, <span class="number">9181</span>, <span class="number">9187</span>, <span class="number">9199</span>,</span><br><span class="line">                              <span class="number">9203</span>, <span class="number">9209</span>, <span class="number">9221</span>, <span class="number">9227</span>, <span class="number">9239</span>, <span class="number">9241</span>, <span class="number">9257</span>, <span class="number">9277</span>, <span class="number">9281</span>, <span class="number">9283</span>,</span><br><span class="line">                              <span class="number">9293</span>, <span class="number">9311</span>, <span class="number">9319</span>, <span class="number">9323</span>, <span class="number">9337</span>, <span class="number">9341</span>, <span class="number">9343</span>, <span class="number">9349</span>, <span class="number">9371</span>, <span class="number">9377</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">9391</span>, <span class="number">9397</span>, <span class="number">9403</span>, <span class="number">9413</span>, <span class="number">9419</span>, <span class="number">9421</span>, <span class="number">9431</span>, <span class="number">9433</span>, <span class="number">9437</span>, <span class="number">9439</span>,</span><br><span class="line">                              <span class="number">9461</span>, <span class="number">9463</span>, <span class="number">9467</span>, <span class="number">9473</span>, <span class="number">9479</span>, <span class="number">9491</span>, <span class="number">9497</span>, <span class="number">9511</span>, <span class="number">9521</span>, <span class="number">9533</span>,</span><br><span class="line">                              <span class="number">9539</span>, <span class="number">9547</span>, <span class="number">9551</span>, <span class="number">9587</span>, <span class="number">9601</span>, <span class="number">9613</span>, <span class="number">9619</span>, <span class="number">9623</span>, <span class="number">9629</span>, <span class="number">9631</span>,</span><br><span class="line">                              <span class="number">9643</span>, <span class="number">9649</span>, <span class="number">9661</span>, <span class="number">9677</span>, <span class="number">9679</span>, <span class="number">9689</span>, <span class="number">9697</span>, <span class="number">9719</span>, <span class="number">9721</span>, <span class="number">9733</span>,</span><br><span class="line"></span><br><span class="line">                              <span class="number">9739</span>, <span class="number">9743</span>, <span class="number">9749</span>, <span class="number">9767</span>, <span class="number">9769</span>, <span class="number">9781</span>, <span class="number">9787</span>, <span class="number">9791</span>, <span class="number">9803</span>, <span class="number">9811</span>,</span><br><span class="line">                              <span class="number">9817</span>, <span class="number">9829</span>, <span class="number">9833</span>, <span class="number">9839</span>, <span class="number">9851</span>, <span class="number">9857</span>, <span class="number">9859</span>, <span class="number">9871</span>, <span class="number">9883</span>, <span class="number">9887</span>,</span><br><span class="line">                              <span class="number">9901</span>, <span class="number">9907</span>, <span class="number">9923</span>, <span class="number">9929</span>, <span class="number">9931</span>, <span class="number">9941</span>, <span class="number">9949</span>, <span class="number">9967</span>, <span class="number">9973</span> ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 递归求逆元</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params"> self, a, b </span>):</span>  <span class="comment"># 扩展欧几里算法优化版</span></span><br><span class="line">        <span class="keyword">if</span> (b == <span class="number">0</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            x0, y0 = self.gcd(b, a % b)  <span class="comment"># 递归计算a*x0 + b*y0=1(a与b互质)中的x0与y0值</span></span><br><span class="line">            <span class="keyword">return</span> y0, x0 - a // b * y0</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 快速幂模算法</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mod_quick</span>(<span class="params"> self, a, b, c </span>):</span>  <span class="comment"># a b c依次为基数 幂数 以及 模数</span></span><br><span class="line">        array = <span class="built_in">bin</span>(b)[ <span class="number">2</span>: ][ ::-<span class="number">1</span> ]  <span class="comment"># 取幂数的二进制，并将其倒叙（从左到右→从小到大）</span></span><br><span class="line">        n = <span class="built_in">len</span>(array)  <span class="comment"># 获取二进制数位数（也就是b的bits）</span></span><br><span class="line">        result = <span class="number">1</span>  <span class="comment"># 初始化结果</span></span><br><span class="line">        <span class="keyword">if</span> (array[ <span class="number">0</span> ] == <span class="string">&#x27;1&#x27;</span>):  <span class="comment"># 这里以字符串的思想去判断，规避了int()的时间，若 b 的二进制首位为 1，将 a 填入列表</span></span><br><span class="line">            result = a</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n):  <span class="comment"># 循环遍历 b 的所有二进制位数</span></span><br><span class="line">            <span class="built_in">next</span> = (a * a) % c  <span class="comment"># 循环幂模运算</span></span><br><span class="line">            <span class="keyword">if</span> (array[ _ ] == <span class="string">&#x27;1&#x27;</span>):  <span class="comment"># 若 b 的该二进制位值为 1，则进行计算</span></span><br><span class="line">                result = (result * <span class="built_in">next</span>) % c</span><br><span class="line">            a = <span class="built_in">next</span>  <span class="comment"># a 重定向幂模结果</span></span><br><span class="line">        result %= c</span><br><span class="line">        <span class="keyword">return</span> result  <span class="comment"># 返回结果</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 判断大质数(拉宾米勒素性判断)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bool_p</span>(<span class="params"> self, N, X = <span class="number">5</span> </span>):</span></span><br><span class="line">        M = (N - <span class="number">1</span>) // <span class="number">2</span>  <span class="comment"># N=(2**r)*M+1的反算</span></span><br><span class="line">        r = <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">not</span> M % <span class="number">2</span>):  <span class="comment"># 保证取到奇数M</span></span><br><span class="line">            M //= <span class="number">2</span></span><br><span class="line">            r += <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(X):</span><br><span class="line">            A = random.randint(<span class="number">2</span>, N - <span class="number">1</span>)  <span class="comment"># 取随机数A</span></span><br><span class="line">            get = self.mod_quick(A, M, N)  <span class="comment"># 第四步测试 A**M%N==1则算通过1次测试</span></span><br><span class="line">            <span class="keyword">if</span> (get != <span class="number">1</span>):  <span class="comment"># 此时get=(A**M)%N</span></span><br><span class="line">                i = <span class="number">0</span>  <span class="comment"># 进行第三步测试 A**((2**i)*M)%N=N-1 i&lt;r</span></span><br><span class="line">                <span class="keyword">while</span> (get != N - <span class="number">1</span>):</span><br><span class="line">                    <span class="keyword">if</span> (i &gt;= r - <span class="number">1</span>):  <span class="comment"># 若i&gt;=r则不通过</span></span><br><span class="line">                        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        i += <span class="number">1</span></span><br><span class="line">                        get = (get * get) % N  <span class="comment"># get=(A**(M*2**i))%N</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 大质数生成(取P或Q的值)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_p</span>(<span class="params"> self, size = <span class="number">1024</span>, seed = <span class="number">0</span> </span>):</span></span><br><span class="line">        random.seed = seed  <span class="comment"># 设置随机种子保证取值广泛性</span></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="built_in">bool</span> = <span class="literal">False</span></span><br><span class="line">            n = random.randint(<span class="number">2</span> ** (size - <span class="number">2</span>), <span class="number">2</span> ** (size - <span class="number">1</span>)) * <span class="number">2</span> + <span class="number">1</span>  <span class="comment"># 保证奇数</span></span><br><span class="line">            <span class="keyword">if</span> (n % <span class="number">6</span> != <span class="number">5</span> <span class="keyword">and</span> n % <span class="number">6</span> != <span class="number">1</span>):  <span class="comment"># 6左右判断法，大于4的素数必然是6的倍数-1或+1</span></span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">for</span> _ <span class="keyword">in</span> self.small_primes:  <span class="comment"># 模小质数表判断</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">not</span> n % _):  <span class="comment"># 若能模进则不为质数</span></span><br><span class="line">                    <span class="built_in">bool</span> = <span class="literal">True</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">not</span> <span class="built_in">bool</span>):</span><br><span class="line">                <span class="keyword">if</span> (self.bool_p(n)):  <span class="comment"># 进行拉宾米勒的素性判断</span></span><br><span class="line">                    <span class="keyword">return</span> n</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">q</span>(<span class="params"> self, size = <span class="number">1024</span>, seed = <span class="number">0</span> </span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_p(size = size, seed = seed)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">p</span>(<span class="params"> self, size = <span class="number">1024</span>, seed = <span class="number">0</span> </span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.get_p(size = size, seed = seed)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 求E值与D值</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">e_d</span>(<span class="params"> self, N, size = <span class="number">16</span>, seed = <span class="number">0</span> </span>):</span></span><br><span class="line">        <span class="keyword">if</span> (N != <span class="number">0</span>):</span><br><span class="line">            random.seed = (seed)  <span class="comment"># 设置随机种子</span></span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                e = self.get_p(size = size)  <span class="comment"># 生成指定位的质数E，直至能够满足要求为止</span></span><br><span class="line">                d = self.gcd(e, N)[ <span class="number">0</span> ]</span><br><span class="line">                <span class="keyword">if</span> (d &lt; <span class="number">0</span>):  <span class="comment"># 若E与M(P-1)*(Q-1)组合不存在正确的D值则继续生成E</span></span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">return</span> e, d  <span class="comment"># 若存在正确的D值则返回E值和D值</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init</span>(<span class="params"> self, size = <span class="number">2048</span>, seed = <span class="number">0</span> </span>):</span></span><br><span class="line">        self.P = self.p(size = size // <span class="number">2</span>, seed = seed)</span><br><span class="line">        self.Q = self.q(size = size // <span class="number">2</span>, seed = seed)</span><br><span class="line">        self.N = self.P * self.Q</span><br><span class="line">        self.Y = (self.P - <span class="number">1</span>) * (self.Q - <span class="number">1</span>)</span><br><span class="line">        self.E, self.D = self.e_d(N = self.Y)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_encode</span>(<span class="params"> content, rsa, pad = <span class="string">&#x27;\n&#x27;</span> </span>):</span></span><br><span class="line">    s_hex_base64 = <span class="string">&quot;&quot;</span>.join([ <span class="string">&quot;%2x&quot;</span> % <span class="built_in">ord</span>(each) <span class="keyword">for</span> each <span class="keyword">in</span> b64.enb64(source = content, enbytes = <span class="literal">False</span>) ])</span><br><span class="line">    rsa_hex_len = <span class="built_in">len</span>(<span class="built_in">hex</span>(rsa.N)[ <span class="number">2</span>: ]) - <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> pad.join(</span><br><span class="line">        <span class="built_in">hex</span>(rsa.mod_quick(<span class="built_in">int</span>(s_hex_base64[ line * rsa_hex_len:(line + <span class="number">1</span>) * rsa_hex_len ], <span class="number">16</span>), rsa.E, rsa.N))[ <span class="number">2</span>: ] <span class="keyword">for</span></span><br><span class="line">        line <span class="keyword">in</span> <span class="built_in">range</span>(math.ceil(<span class="built_in">len</span>(s_hex_base64) / rsa_hex_len)))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rsa_decode</span>(<span class="params"> pass_v, rsa, pad = <span class="string">&#x27;\n&#x27;</span> </span>):</span></span><br><span class="line">    <span class="keyword">return</span> b64.deb64(<span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(each, <span class="number">16</span>)) <span class="keyword">for</span> each <span class="keyword">in</span> re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, <span class="string">&quot;&quot;</span>.join(</span><br><span class="line">        <span class="built_in">hex</span>(rsa.mod_quick(<span class="built_in">int</span>(line, <span class="number">16</span>), rsa.D, rsa.N))[ <span class="number">2</span>: ] <span class="keyword">for</span> line <span class="keyword">in</span> pass_v.split(pad)))), debytes = <span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2str</span>(<span class="params"> s </span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(each, <span class="number">16</span>)) <span class="keyword">for</span> each <span class="keyword">in</span> re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, s)).encode(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hex2str_crypt</span>(<span class="params"> s ,pad = <span class="string">&#x27;\n&#x27;</span></span>):</span></span><br><span class="line">    <span class="keyword">return</span>[ <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">int</span>(each, <span class="number">16</span>)) <span class="keyword">for</span> each <span class="keyword">in</span> re.findall(<span class="string">r&#x27;\w&#123;1,2&#125;&#x27;</span>, part)).encode(<span class="string">&#x27;latin1&#x27;</span>) <span class="keyword">for</span> part <span class="keyword">in</span> [line <span class="keyword">for</span> line <span class="keyword">in</span> s.split(pad)] ]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    rsa = RSA_value( )</span><br><span class="line">    rsa.init(size = <span class="number">16384</span>)</span><br><span class="line">    pad=<span class="string">&quot;\n&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ RSA ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">24</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P =&gt; : &quot;</span>, hex2str(<span class="built_in">hex</span>(rsa.P)[ <span class="number">2</span>: ]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Q =&gt; : &quot;</span>, hex2str(<span class="built_in">hex</span>(rsa.Q)[ <span class="number">2</span>: ]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;N =&gt; : &quot;</span>, hex2str(<span class="built_in">hex</span>(rsa.N)[ <span class="number">2</span>: ]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;E =&gt; : &quot;</span>, hex2str(<span class="built_in">hex</span>(rsa.E)[ <span class="number">2</span>: ]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;D =&gt; : &quot;</span>, hex2str(<span class="built_in">hex</span>(rsa.D)[ <span class="number">2</span>: ]))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ RSA ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">24</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c = rsa_encode(content = <span class="built_in">input</span>(<span class="string">&quot;请输入需要加密的信息：&quot;</span>), rsa = rsa,pad = pad)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ 密文  =》 ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">24</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;HEX =&gt; &quot;</span>,<span class="string">&quot;0x&quot;</span>+c)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;DEC =&gt; &quot;</span>,<span class="built_in">int</span>(c,<span class="number">16</span>))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;OCT =&gt; &quot;</span>,<span class="built_in">oct</span>(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;BIN =&gt; &quot;</span>,<span class="built_in">bin</span>(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ 密文流  =》]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">24</span>)</span><br><span class="line">            <span class="built_in">print</span>(hex2str_crypt(s = c, pad = pad))</span><br><span class="line">            s = rsa_decode(pass_v = c, rsa = rsa, pad = pad)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">24</span> + <span class="string">&quot;[ 明文  =》]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">24</span>)</span><br><span class="line">            <span class="built_in">print</span>(s)</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Bye!&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="SHA256"><a href="#SHA256" class="headerlink" title="- SHA256 -"></a>- SHA256 -</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">@Description: SHA256</span></span><br><span class="line"><span class="string">@Author: DQ</span></span><br><span class="line"><span class="string">@LastEditors  : DQ</span></span><br><span class="line"><span class="string">@Date: 2020-03-14 19:11:23</span></span><br><span class="line"><span class="string">@LastEditTime : 2020-03-15 05:10:59</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> re, functools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SHA_256</span>(<span class="params"><span class="built_in">object</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params"> self </span>):</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化哈希初值</span></span><br><span class="line">        self.Hash_init = [</span><br><span class="line">            <span class="number">0x6a09e667</span>, <span class="number">0xbb67ae85</span>,</span><br><span class="line">            <span class="number">0x3c6ef372</span>, <span class="number">0xa54ff53a</span>,</span><br><span class="line">            <span class="number">0x510e527f</span>, <span class="number">0x9b05688c</span>,</span><br><span class="line">            <span class="number">0x1f83d9ab</span>, <span class="number">0x5be0cd19</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 初始化哈希常量</span></span><br><span class="line">        self.Hash_const = [</span><br><span class="line">            <span class="number">0x428a2f98</span>, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5dba5</span>, <span class="number">0x3956c25b</span>, <span class="number">0x59f111f1</span>, <span class="number">0x923f82a4</span>, <span class="number">0xab1c5ed5</span>,</span><br><span class="line">            <span class="number">0xd807aa98</span>, <span class="number">0x12835b01</span>, <span class="number">0x243185be</span>, <span class="number">0x550c7dc3</span>, <span class="number">0x72be5d74</span>, <span class="number">0x80deb1fe</span>, <span class="number">0x9bdc06a7</span>, <span class="number">0xc19bf174</span>,</span><br><span class="line">            <span class="number">0xe49b69c1</span>, <span class="number">0xefbe4786</span>, <span class="number">0x0fc19dc6</span>, <span class="number">0x240ca1cc</span>, <span class="number">0x2de92c6f</span>, <span class="number">0x4a7484aa</span>, <span class="number">0x5cb0a9dc</span>, <span class="number">0x76f988da</span>,</span><br><span class="line">            <span class="number">0x983e5152</span>, <span class="number">0xa831c66d</span>, <span class="number">0xb00327c8</span>, <span class="number">0xbf597fc7</span>, <span class="number">0xc6e00bf3</span>, <span class="number">0xd5a79147</span>, <span class="number">0x06ca6351</span>, <span class="number">0x14292967</span>,</span><br><span class="line">            <span class="number">0x27b70a85</span>, <span class="number">0x2e1b2138</span>, <span class="number">0x4d2c6dfc</span>, <span class="number">0x53380d13</span>, <span class="number">0x650a7354</span>, <span class="number">0x766a0abb</span>, <span class="number">0x81c2c92e</span>, <span class="number">0x92722c85</span>,</span><br><span class="line">            <span class="number">0xa2bfe8a1</span>, <span class="number">0xa81a664b</span>, <span class="number">0xc24b8b70</span>, <span class="number">0xc76c51a3</span>, <span class="number">0xd192e819</span>, <span class="number">0xd6990624</span>, <span class="number">0xf40e3585</span>, <span class="number">0x106aa070</span>,</span><br><span class="line">            <span class="number">0x19a4c116</span>, <span class="number">0x1e376c08</span>, <span class="number">0x2748774c</span>, <span class="number">0x34b0bcb5</span>, <span class="number">0x391c0cb3</span>, <span class="number">0x4ed8aa4a</span>, <span class="number">0x5b9cca4f</span>, <span class="number">0x682e6ff3</span>,</span><br><span class="line">            <span class="number">0x748f82ee</span>, <span class="number">0x78a5636f</span>, <span class="number">0x84c87814</span>, <span class="number">0x8cc70208</span>, <span class="number">0x90befffa</span>, <span class="number">0xa4506ceb</span>, <span class="number">0xbef9a3f7</span>, <span class="number">0xc67178f2</span></span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 右旋转</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rightrotate_</span>(<span class="params"> self, s, length </span>):</span></span><br><span class="line">        <span class="keyword">return</span> s[ -length: ] + s[ :-length ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 右移位</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">rightshift_</span>(<span class="params"> self, s, length </span>):</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;0&quot;</span> * length + s[ :-length ]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># hash加</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">hash_add</span>(<span class="params"> self, x, y </span>):</span></span><br><span class="line">        <span class="keyword">return</span> (x + y) &amp; <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 扩充内容</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_</span>(<span class="params"> self, data </span>):</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            data = data.encode( )</span><br><span class="line">        <span class="keyword">except</span> AttributeError:</span><br><span class="line">            data = data</span><br><span class="line">        data_bin_steam = <span class="string">&quot;&quot;</span>.join(<span class="built_in">bin</span>(each)[ <span class="number">2</span>: ].zfill(<span class="number">8</span>) <span class="keyword">for</span> each <span class="keyword">in</span> data)</span><br><span class="line">        data_bin_len = <span class="built_in">len</span>(data_bin_steam)</span><br><span class="line">        data_append = ((<span class="number">448</span> - (data_bin_len % <span class="number">512</span>)) <span class="keyword">if</span> (data_bin_len % <span class="number">512</span>) &lt; <span class="number">448</span> <span class="keyword">else</span> (<span class="number">448</span> + <span class="number">512</span> - (data_bin_len % <span class="number">512</span>))) - <span class="number">1</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> data_bin_steam + <span class="string">&quot;1&quot;</span> + <span class="string">&quot;0&quot;</span> * data_append + <span class="built_in">bin</span>(</span><br><span class="line">            data_bin_len)[ <span class="number">2</span>: ].zfill(<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># hash256</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main_</span>(<span class="params"> self, data </span>):</span></span><br><span class="line">        data_blocks = [ data[ index*<span class="number">512</span>:(index + <span class="number">1</span>) * <span class="number">512</span> ] <span class="keyword">for</span> index <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data) // <span class="number">512</span>) ]</span><br><span class="line">        data_hash_main = self.Hash_init.copy( )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 对每个块进行摘要</span></span><br><span class="line">        <span class="keyword">for</span> block <span class="keyword">in</span> data_blocks:</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 求W[0~15]</span></span><br><span class="line">            W = re.findall(<span class="string">&#x27;\d&#123;32&#125;&#x27;</span>, block[ :<span class="number">32</span> * <span class="number">16</span> ])</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 求W[16~63]</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>, <span class="number">64</span>):</span><br><span class="line">                o0 = <span class="built_in">int</span>(self.rightrotate_(W[ i - <span class="number">15</span> ], <span class="number">7</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightrotate_(W[ i - <span class="number">15</span> ], <span class="number">18</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightshift_(W[ i - <span class="number">15</span> ], <span class="number">3</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">                o1 = <span class="built_in">int</span>(self.rightrotate_(W[ i - <span class="number">2</span> ], <span class="number">17</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightrotate_(W[ i - <span class="number">2</span> ], <span class="number">19</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightshift_(W[ i - <span class="number">2</span> ], <span class="number">10</span>), <span class="number">2</span>)</span><br><span class="line">                W.append(<span class="built_in">bin</span>(functools.reduce(self.hash_add, [ <span class="built_in">int</span>(W[ i - <span class="number">16</span> ], <span class="number">2</span>), o0, <span class="built_in">int</span>(W[ i - <span class="number">7</span> ], <span class="number">2</span>), o1 ]))[<span class="number">2</span>: ].zfill(<span class="number">32</span>))</span><br><span class="line"></span><br><span class="line">            data_hash = data_hash_main.copy( )</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 进行64轮摘要</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">                s0 = <span class="built_in">int</span>(self.rightrotate_(<span class="built_in">bin</span>(data_hash[ <span class="number">0</span> ])[ <span class="number">2</span>: ].zfill(<span class="number">32</span>), <span class="number">2</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightrotate_(<span class="built_in">bin</span>(data_hash[ <span class="number">0</span> ])[ <span class="number">2</span>: ].zfill(<span class="number">32</span>), <span class="number">13</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightrotate_(<span class="built_in">bin</span>(data_hash[ <span class="number">0</span> ])[ <span class="number">2</span>: ].zfill(<span class="number">32</span>), <span class="number">22</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">                maj = (data_hash[ <span class="number">0</span> ] &amp; data_hash[ <span class="number">1</span> ]) ^ \</span><br><span class="line">                      (data_hash[ <span class="number">0</span> ] &amp; data_hash[ <span class="number">2</span> ]) ^ \</span><br><span class="line">                      (data_hash[ <span class="number">1</span> ] &amp; data_hash[ <span class="number">2</span> ])</span><br><span class="line"></span><br><span class="line">                s1 = <span class="built_in">int</span>(self.rightrotate_(<span class="built_in">bin</span>(data_hash[ <span class="number">4</span> ])[ <span class="number">2</span>: ].zfill(<span class="number">32</span>), <span class="number">6</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightrotate_(<span class="built_in">bin</span>(data_hash[ <span class="number">4</span> ])[ <span class="number">2</span>: ].zfill(<span class="number">32</span>), <span class="number">11</span>), <span class="number">2</span>) ^ \</span><br><span class="line">                     <span class="built_in">int</span>(self.rightrotate_(<span class="built_in">bin</span>(data_hash[ <span class="number">4</span> ])[ <span class="number">2</span>: ].zfill(<span class="number">32</span>), <span class="number">25</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">                ch = (data_hash[ <span class="number">4</span> ] &amp; data_hash[ <span class="number">5</span> ]) ^ ((~data_hash[ <span class="number">4</span> ]) &amp; data_hash[ <span class="number">6</span> ])</span><br><span class="line"></span><br><span class="line">                t1 = functools.reduce(self.hash_add,[ data_hash[ <span class="number">7</span> ], s1, ch, self.Hash_const[ i ] + <span class="built_in">int</span>(W[ i ], <span class="number">2</span>)])</span><br><span class="line">                t2 = functools.reduce(self.hash_add, [ s0, maj ])</span><br><span class="line"></span><br><span class="line">                data_hash=[ self.hash_add(data_hash[i - <span class="number">1</span>] ,t1*(<span class="keyword">not</span> i%<span class="number">4</span> )) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">8</span>)]</span><br><span class="line">                data_hash.insert(<span class="number">0</span>, self.hash_add(t1,t2))</span><br><span class="line"></span><br><span class="line">                <span class="comment">#print(&quot;&lt;%d&gt;[ &quot;%i+&quot; , &quot;.join(hex(each) for each in data_hash)+&quot;]&quot;)</span></span><br><span class="line"></span><br><span class="line">            data_hash_main = [ self.hash_add(data_hash[ i ],data_hash_main[ i ]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>) ]</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">hex</span>(each)[ <span class="number">2</span>: ].zfill(<span class="number">2</span>) <span class="keyword">for</span> each <span class="keyword">in</span> data_hash_main)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show_decbox</span>(<span class="params"> box , length</span>):</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(box) // length):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;[ &quot;</span> + <span class="string">&quot; , &quot;</span>.join(<span class="string">&quot;0x&quot;</span> + <span class="built_in">hex</span>(each)[ <span class="number">2</span>: ].zfill(<span class="number">8</span>) <span class="keyword">for</span> each <span class="keyword">in</span> [box[row*length + i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(length)]) + <span class="string">&quot; ]&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    sha256=SHA_256()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">52</span> + <span class="string">&quot;[ SHA256 ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">52</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;哈希初值 =&gt; &quot;</span>)</span><br><span class="line">    show_decbox(sha256.Hash_init,<span class="number">2</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;哈希常量 =&gt; &quot;</span>)</span><br><span class="line">    show_decbox(sha256.Hash_const, <span class="number">8</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;*&quot;</span> * <span class="number">52</span> + <span class="string">&quot;[ SHA256 ]&quot;</span> + <span class="string">&quot;*&quot;</span> * <span class="number">52</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c = sha256.main_(data = sha256.prepare_(data = <span class="built_in">input</span>(<span class="string">&quot;请输入需要进行SHA256的值：&quot;</span>)))</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;[ SHA256  =》]&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(c)</span><br><span class="line">        <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;Bye!&quot;</span>)</span><br><span class="line">            exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="生成随机字节流的处理代码实现"><a href="#生成随机字节流的处理代码实现" class="headerlink" title="- 生成随机字节流的处理代码实现 -"></a>- 生成随机字节流的处理代码实现 -</h2><p>生成[密钥KEY1]以及[密钥KEY2] ：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time,psutil,c64,sha256</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_handware_data</span>():</span></span><br><span class="line">    <span class="comment"># 获取当前内存数据</span></span><br><span class="line">    memory_data = psutil.virtual_memory()</span><br><span class="line">    <span class="comment"># 求当前内存使用率（结果精确至小数点后48位）</span></span><br><span class="line">    memory_use = <span class="built_in">str</span>(<span class="string">&quot;%.48f&quot;</span>%(memory_data.used / memory_data.total))</span><br><span class="line">    <span class="comment"># 获取当前CPU数据</span></span><br><span class="line">    cpu_info = psutil.cpu_times()</span><br><span class="line">    cpu_status = <span class="string">&quot;|&quot;</span>.join(<span class="built_in">str</span>(each) <span class="keyword">for</span> each <span class="keyword">in</span> (cpu_info.user,cpu_info.nice,cpu_info.system))</span><br><span class="line">    <span class="keyword">return</span> cpu_status + <span class="string">&quot;|&quot;</span> + memory_use</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key_1</span>(<span class="params">s:<span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="comment"># 生成[密钥KEY1]</span></span><br><span class="line">    SHA256 = sha256.SHA_256()</span><br><span class="line">    <span class="keyword">return</span> SHA256.main_(SHA256.prepare_(c64.encrypt(s)))[:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key_2</span>(<span class="params">s:<span class="built_in">str</span></span>):</span></span><br><span class="line">    <span class="comment"># 通过[密钥KEY1]来生成[密钥KEY2]</span></span><br><span class="line">    SHA256 = sha256.SHA_256()</span><br><span class="line">    <span class="keyword">return</span> SHA256.main_(SHA256.prepare_(c64.encrypt(<span class="built_in">str</span>(time.time()).replace(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;&#x27;</span>)+s)))[:<span class="number">32</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_key</span>():</span></span><br><span class="line">    <span class="comment"># 获取生成的两个密钥</span></span><br><span class="line">    key1 = get_key_1(get_handware_data())</span><br><span class="line">    key2 = get_key_2(key1)</span><br><span class="line">    <span class="keyword">return</span> key1,key2</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    key1,key2 = get_key()</span><br><span class="line">    <span class="built_in">print</span>(key1)</span><br><span class="line">    <span class="built_in">print</span>(key2)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>生成随机字节流：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa,sha256,aes128,sys,time</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_rsa_data</span>():</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取RSA数据</span></span><br><span class="line"></span><br><span class="line">    RSA = rsa.RSA_value()</span><br><span class="line">    RSA.init(<span class="number">2048</span>)</span><br><span class="line">    <span class="keyword">return</span> RSA</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_aes128_box</span>(<span class="params">box:<span class="built_in">list</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># AES128密钥矩阵转换单行数据</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> [[box[i*<span class="number">4</span>+j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>)]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_aes128_box_r</span>(<span class="params">box:<span class="built_in">list</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 单行数据转换AES128密钥矩阵</span></span><br><span class="line"></span><br><span class="line">    temp_list=[]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">            temp_list.append(box[i][j])</span><br><span class="line">    <span class="keyword">return</span> temp_list</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_rand_1</span>(<span class="params">key2:<span class="built_in">str</span>,p:<span class="built_in">str</span>,count:<span class="built_in">int</span> = <span class="number">5</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第二步] 的操作</span></span><br><span class="line"></span><br><span class="line">    AES = aes128.AES_128()</span><br><span class="line">    SHA256 = sha256.SHA_256()</span><br><span class="line">    aes_key = get_aes128_box([<span class="built_in">int</span>(key2[i*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(key2)//<span class="number">2</span>)])</span><br><span class="line"></span><br><span class="line">    result = SHA256.main_(SHA256.prepare_(p))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        AES.init(aes_key,<span class="number">10</span>)</span><br><span class="line">        AES_c = aes128.aes128_encode(result,AES,<span class="number">32</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(count != <span class="number">4</span>):</span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">not</span> i%<span class="number">2</span>):</span><br><span class="line">                aes_get = AES_c[-<span class="number">32</span>:]</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                aes_get = AES_c[<span class="number">32</span>:]</span><br><span class="line">            aes_key = get_aes128_box([a ^ b <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(get_aes128_box_r(aes_key),[<span class="built_in">int</span>(aes_get[j*<span class="number">2</span>:(j+<span class="number">1</span>)*<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(aes_get)//<span class="number">2</span>)])])</span><br><span class="line">            result = SHA256.main_(SHA256.prepare_(AES_c))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = AES_c</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_rand_2</span>(<span class="params">request_time:<span class="built_in">str</span>,mainkey:<span class="built_in">str</span>,q:<span class="built_in">str</span>,count:<span class="built_in">int</span> = <span class="number">5</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第三步] 的操作</span></span><br><span class="line"></span><br><span class="line">    AES = aes128.AES_128()</span><br><span class="line">    SHA256 = sha256.SHA_256()</span><br><span class="line">    aes_key = get_aes128_box([<span class="built_in">int</span>(mainkey[i*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(mainkey)//<span class="number">2</span>)])</span><br><span class="line">    aes_q_key =[<span class="built_in">int</span>(q[i*<span class="number">2</span>:(i+<span class="number">1</span>)*<span class="number">2</span>],<span class="number">16</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(q[:<span class="number">32</span>])//<span class="number">2</span>)]</span><br><span class="line">    timestamp = <span class="built_in">str</span>(time.time()).replace(<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    result = request_time + timestamp</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(count):</span><br><span class="line">        AES.init(aes_key,<span class="number">10</span>)</span><br><span class="line">        AES_c = aes128.aes128_encode(result,AES,<span class="number">32</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span>(i != <span class="number">4</span>):</span><br><span class="line">            aes_key = get_aes128_box([a ^ b <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(get_aes128_box_r(aes_key),aes_q_key)])</span><br><span class="line">            result = SHA256.main_(SHA256.prepare_(AES_c))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result = AES_c</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_rand_3</span>(<span class="params">rand1:<span class="built_in">str</span>,rand2:<span class="built_in">str</span>,RSA</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第四步] 的操作</span></span><br><span class="line"></span><br><span class="line">    rand1_xor_rand2 = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(a) ^ <span class="built_in">ord</span>(b)) <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(rand1,rand2))</span><br><span class="line">    RSA_c = rsa.rsa_encode(rand1_xor_rand2,RSA,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> RSA_c</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_result</span>(<span class="params">s:<span class="built_in">str</span>,n:<span class="built_in">str</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第五步] 的操作</span></span><br><span class="line"></span><br><span class="line">    SHA256 = sha256.SHA_256()</span><br><span class="line">    s_or_n = <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(a) | <span class="built_in">ord</span>(b)) <span class="keyword">for</span> a,b <span class="keyword">in</span> <span class="built_in">zip</span>(s,n))</span><br><span class="line">    left = SHA256.main_(SHA256.prepare_(s[:<span class="built_in">len</span>(s)//<span class="number">2</span>]))</span><br><span class="line">    right = SHA256.main_(SHA256.prepare_(s[-<span class="built_in">len</span>(s)//<span class="number">2</span>:]))</span><br><span class="line">    result = left + SHA256.main_(SHA256.prepare_(s_or_n)) + right</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_random</span>(<span class="params">key2:<span class="built_in">str</span>,mainkey:<span class="built_in">str</span>,request_time:<span class="built_in">str</span></span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第一步]</span></span><br><span class="line">    RSA = get_rsa_data()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第二步]</span></span><br><span class="line">    rand1 = get_rand_1(key2,<span class="built_in">hex</span>(RSA.P)[<span class="number">2</span>:],<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第三步]</span></span><br><span class="line">    rand2 = get_rand_2(request_time,mainkey,<span class="built_in">hex</span>(RSA.Q)[<span class="number">2</span>:],<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># [第四步]</span></span><br><span class="line">    rand3 = get_rand_3(rand1,rand2,RSA)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># [第五步]</span></span><br><span class="line">    result = get_result(rand3,<span class="built_in">hex</span>(RSA.N)[<span class="number">2</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">len</span>(sys.argv) == <span class="number">4</span>):</span><br><span class="line">        <span class="built_in">print</span>(get_random(sys.argv[<span class="number">1</span>],sys.argv[<span class="number">2</span>],sys.argv[<span class="number">3</span>]))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="后端代码实现"><a href="#后端代码实现" class="headerlink" title="- 后端代码实现 -"></a>- 后端代码实现 -</h2><p>main.php：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	session_start();</span><br><span class="line"></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Rand_config</span></span>&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="comment"># 操作选项</span></span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$setting</span> = [<span class="string">&#x27;get_rand_key&#x27;</span>,<span class="string">&#x27;refresh_rand_key&#x27;</span>,<span class="string">&#x27;get_rand_result&#x27;</span>,<span class="string">&#x27;refresh_rand_result&#x27;</span>];</span><br><span class="line">		</span><br><span class="line">		<span class="comment"># 调用Python的结果</span></span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$cmd_result</span>;</span><br><span class="line"></span><br><span class="line">		<span class="comment"># 存储在服务器的 [不变密钥KEY]</span></span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$private_key</span> = <span class="string">&#x27;43fada45363a416167d4b3dadc2f7b49&#x27;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$result</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$status</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		<span class="keyword">private</span> <span class="variable">$error</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">exec_cmd</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">			<span class="comment"># 调用Python</span></span><br><span class="line">			exec(<span class="variable">$cmd</span>,<span class="keyword">$this</span>-&gt;cmd_result);</span><br><span class="line">			<span class="keyword">$this</span>-&gt;result = count(<span class="keyword">$this</span>-&gt;cmd_result) &gt; <span class="number">0</span> ? implode(<span class="string">&#x27;|&#x27;</span>,<span class="keyword">$this</span>-&gt;cmd_result) : <span class="keyword">$this</span>-&gt;result = <span class="string">&#x27;出错了！&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$type</span> = <span class="literal">null</span></span>)</span>&#123;</span><br><span class="line">			<span class="keyword">try</span>&#123;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">if</span>(!is_null(<span class="variable">$type</span>))&#123;</span><br><span class="line">					</span><br><span class="line">					<span class="keyword">if</span>(in_array(<span class="variable">$type</span>,<span class="keyword">$this</span>-&gt;setting,<span class="literal">true</span>))&#123;</span><br><span class="line">						</span><br><span class="line">						<span class="comment"># 获取当前操作的索引值</span></span><br><span class="line">						<span class="variable">$index</span> = array_search(<span class="variable">$type</span>,<span class="keyword">$this</span>-&gt;setting);</span><br><span class="line">						</span><br><span class="line">						<span class="keyword">switch</span> (<span class="variable">$index</span>)&#123;</span><br><span class="line">							</span><br><span class="line">							<span class="comment"># 获取[密钥KEY1]以及[密钥KEY2]的调用Python操作</span></span><br><span class="line">							<span class="keyword">case</span> <span class="number">0</span>: </span><br><span class="line">								<span class="comment"># 设置Python处理时间</span></span><br><span class="line">								<span class="variable">$_SESSION</span>[<span class="string">&#x27;endtime_key&#x27;</span>] = time() + <span class="number">.5</span>;</span><br><span class="line">								<span class="comment"># 调用Python进行处理</span></span><br><span class="line">								<span class="keyword">$this</span>-&gt;exec_cmd(<span class="string">&#x27;python3 /app/a.py&#x27;</span>);</span><br><span class="line">								<span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;result != <span class="string">&#x27;出错了！&#x27;</span>)&#123;</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 若处理成功则获得[密钥KEY1]和[密钥KEY2]</span></span><br><span class="line">									<span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>] = <span class="keyword">$this</span>-&gt;result;</span><br><span class="line">									<span class="keyword">$this</span>-&gt;status = <span class="string">&quot;exec&quot;</span>;</span><br><span class="line">								&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">									<span class="keyword">$this</span>-&gt;status = <span class="string">&quot;failed&quot;</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">							</span><br><span class="line">							<span class="comment"># 获取[密钥KEY1]以及[密钥KEY2]的刷新操作</span></span><br><span class="line">							<span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">								<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;endtime_key&#x27;</span>]) <span class="keyword">and</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;endtime_key&#x27;</span>] &lt;= time())&#123;</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 若处理完成且获取成功，则返回OK</span></span><br><span class="line">									<span class="keyword">$this</span>-&gt;status = <span class="string">&#x27;OK&#x27;</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">							</span><br><span class="line">							<span class="comment"># 获取随机字符的一系列操作</span></span><br><span class="line">							<span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">								<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;request_time&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;fonts&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;url_decode&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;len&#x27;</span>]))&#123;</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 设置Python处理时间</span></span><br><span class="line">									<span class="variable">$_SESSION</span>[<span class="string">&#x27;endtime_result&#x27;</span>] = time() + <span class="number">2</span>;</span><br><span class="line">									<span class="comment"># 获取当前的[密钥KEY1]和[密钥KEY2]</span></span><br><span class="line">									<span class="variable">$keys</span> = explode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 使用者是否要求对其他字符预先进行URL解码</span></span><br><span class="line">									<span class="variable">$fonts</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;url_decode&#x27;</span>] === <span class="string">&#x27;true&#x27;</span> ? urldecode(<span class="variable">$_POST</span>[<span class="string">&#x27;fonts&#x27;</span>]) : <span class="variable">$_POST</span>[<span class="string">&#x27;fonts&#x27;</span>];</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 将使用者选定的随机字符列表添加入数组，并去重</span></span><br><span class="line">									<span class="variable">$result_array</span> = preg_split(<span class="string">&#x27;//&#x27;</span>, <span class="variable">$fonts</span>, -<span class="number">1</span>, PREG_SPLIT_NO_EMPTY);</span><br><span class="line">									array_unique(<span class="variable">$result_array</span>);</span><br><span class="line">									<span class="variable">$len</span> = count(<span class="variable">$result_array</span>);</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 获取使用者要求的随机字符长度（字节数）</span></span><br><span class="line">									<span class="variable">$rand_len</span> = (<span class="variable">$_POST</span>[<span class="string">&#x27;len&#x27;</span>] &gt; <span class="number">90</span> <span class="keyword">or</span> <span class="variable">$_POST</span>[<span class="string">&#x27;len&#x27;</span>] &lt;= <span class="number">0</span>) ? <span class="number">45</span> : <span class="variable">$_POST</span>[<span class="string">&#x27;len&#x27;</span>];</span><br><span class="line">									</span><br><span class="line">									<span class="keyword">if</span>(count(<span class="variable">$keys</span>) === <span class="number">2</span>)&#123;</span><br><span class="line">										</span><br><span class="line">										<span class="comment"># 若一切无误则调用Python生成随机字节流</span></span><br><span class="line">										<span class="keyword">$this</span>-&gt;exec_cmd(<span class="string">&quot;python3 /app/b.py &quot;</span>.join(<span class="string">&#x27; &#x27;</span>,[<span class="variable">$keys</span>[<span class="number">0</span>],<span class="variable">$keys</span>[<span class="number">1</span>],intval(<span class="variable">$_POST</span>[<span class="string">&#x27;request_time&#x27;</span>]])));</span><br><span class="line">										<span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;result != <span class="string">&#x27;出错了！&#x27;</span>)&#123;</span><br><span class="line">											</span><br><span class="line">											<span class="comment"># 获取生成的随机字节流并逐个字节添加入数组</span></span><br><span class="line">											<span class="variable">$_SESSION</span>[<span class="string">&#x27;rand&#x27;</span>] = <span class="keyword">$this</span>-&gt;result;</span><br><span class="line">											<span class="variable">$contents</span> = <span class="string">&#x27;&#x27;</span>;	</span><br><span class="line">											preg_match_all(<span class="string">&#x27;/[\S\s]&#123;2&#125;/i&#x27;</span>,<span class="variable">$_SESSION</span>[<span class="string">&#x27;rand&#x27;</span>],<span class="variable">$bytes</span>,<span class="number">2</span>);</span><br><span class="line">											</span><br><span class="line">											<span class="comment"># 使用生成的随机字节流生成随机字符</span></span><br><span class="line">											<span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>;<span class="variable">$i</span> &lt; <span class="variable">$rand_len</span>;<span class="variable">$i</span>++)&#123; <span class="variable">$contents</span> .= <span class="variable">$result_array</span>[hexdec(<span class="variable">$bytes</span>[<span class="variable">$i</span>][<span class="number">0</span>]) % <span class="variable">$len</span>];&#125;</span><br><span class="line">											<span class="variable">$_SESSION</span>[<span class="string">&#x27;rand_str&#x27;</span>] = <span class="variable">$contents</span>;</span><br><span class="line">											<span class="keyword">$this</span>-&gt;status = <span class="string">&#x27;exec&#x27;</span>;</span><br><span class="line">											</span><br><span class="line">										&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">											</span><br><span class="line">											<span class="keyword">$this</span>-&gt;status = <span class="string">&#x27;failed&#x27;</span>;</span><br><span class="line">										&#125;</span><br><span class="line">									&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">										</span><br><span class="line">										<span class="keyword">$this</span>-&gt;status = <span class="string">&#x27;failed&#x27;</span>;</span><br><span class="line">									&#125;</span><br><span class="line">								&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">									</span><br><span class="line">									<span class="keyword">$this</span>-&gt;status = <span class="string">&#x27;failed&#x27;</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">							</span><br><span class="line">							<span class="comment"># 获取随机字符的刷新操作</span></span><br><span class="line">							<span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">								<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;endtime_result&#x27;</span>]) <span class="keyword">and</span> <span class="variable">$_SESSION</span>[<span class="string">&#x27;endtime_result&#x27;</span>] &lt;= time())&#123;</span><br><span class="line">									</span><br><span class="line">									<span class="comment"># 若处理完成且获取成功，则返回OK</span></span><br><span class="line">									<span class="keyword">$this</span>-&gt;status = <span class="string">&#x27;OK&#x27;</span>;</span><br><span class="line">								&#125;</span><br><span class="line">							<span class="keyword">break</span>;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;</span><br><span class="line">				</span><br><span class="line">			&#125;<span class="keyword">catch</span>(<span class="built_in">Exception</span> <span class="variable">$e</span>)&#123;</span><br><span class="line">				</span><br><span class="line">				<span class="keyword">$this</span>-&gt;error = <span class="variable">$e</span>-&gt;getMessage().<span class="string">&quot;\x0a&quot;</span>.<span class="string">&#x27;出错了！&#x27;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">			</span><br><span class="line">			<span class="keyword">return</span> <span class="keyword">$this</span>-&gt;error === <span class="string">&#x27;&#x27;</span> ? (<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;status : (<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;error;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment"># 将操作得到的结果以JSON方式返回，方便前端的jQuery处理</span></span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">json_result</span>(<span class="params"><span class="variable">$type</span>,<span class="variable">$status</span>,<span class="variable">$contents</span> = <span class="string">&#x27;&#x27;</span></span>)</span>&#123;</span><br><span class="line">		header(<span class="string">&quot;Content-Type: text/json&quot;</span>);</span><br><span class="line">		<span class="keyword">echo</span> json_encode(<span class="keyword">array</span>(</span><br><span class="line">		<span class="string">&#x27;type&#x27;</span>=&gt;<span class="variable">$type</span>,</span><br><span class="line">		<span class="string">&#x27;status&#x27;</span>=&gt;<span class="variable">$status</span>,</span><br><span class="line">		<span class="string">&#x27;result&#x27;</span>=&gt;base64_encode(<span class="variable">$contents</span>)</span><br><span class="line">		));</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="comment"># 请求传入的入口</span></span><br><span class="line">	<span class="comment"># 对传入的请求判断并进行对应的操作</span></span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>]))&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="variable">$status</span> = (<span class="keyword">string</span>) <span class="keyword">new</span> Rand_config(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>]);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$status</span> === <span class="string">&#x27;OK&#x27;</span>)&#123;</span><br><span class="line">			<span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>] === <span class="string">&#x27;refresh_rand_key&#x27;</span>)&#123;</span><br><span class="line">				</span><br><span class="line">				json_result(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>],<span class="variable">$status</span>,<span class="variable">$_SESSION</span>[<span class="string">&#x27;key&#x27;</span>]);</span><br><span class="line">				</span><br><span class="line">			&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>] === <span class="string">&#x27;refresh_rand_result&#x27;</span>)&#123;</span><br><span class="line"></span><br><span class="line">				json_result(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>],<span class="variable">$status</span>,<span class="variable">$_SESSION</span>[<span class="string">&#x27;rand_str&#x27;</span>]);</span><br><span class="line">				</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			json_result(<span class="variable">$_POST</span>[<span class="string">&#x27;action&#x27;</span>],<span class="variable">$status</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<hr>
<h2 id="效果演示"><a href="#效果演示" class="headerlink" title="- 效果演示 -"></a>- 效果演示 -</h2><p>主界面：</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112271521167.png" alt="image-20200520144239928.png"></p>
<p>随意生成一个长度为 <strong>60</strong>的随机字符：</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112271521234.png" alt="image-20200520144606393.png"></p>
<p> 再使用[将其他字符URL解码]功能，生成包含扩展ascii的内容：</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112271521185.png" alt="image-20200520144417007.png"></p>
<p>由于html可能无法正确解析一些扩展ascii码的内容，实际上在index.php的返回的JSON数据流是使用了BASE64将随机字符预先编码的，因而可以直接将JSON中的BASE64解码即可得到一些html无法正常显示的随机字符：</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112271522352.png" alt="image-20200520145038721.png"></p>
<p>以及：</p>
<p><img src="https://morblogib.oss-cn-shanghai.aliyuncs.com/self/images/save/202112271522502.png" alt="image-20200520145309953.png"></p>
<hr>
<p>*最后关于中文的问题，由于这个随机原理是以单字节为基本单位操作，而中文是由多字节组成，所以无法支持随机中文字符（不过如果将加解密的中文统一规范化编码倒是可以的）。</p>


        <hr>
        <!-- Pager -->
        <ul class="pager">
          
          <li class="previous">
            <a href="/860061965/" data-toggle="tooltip" data-placement="top" title="说明 - curl的简单使用">&larr; Previous Post</a>
          </li>
          
          
          <li class="next">
            <a href="/4281309277/" data-toggle="tooltip" data-placement="top" title="编程 - 编程实现带参数执行模式防SQL注入">Next Post &rarr;</a>
          </li>
          
        </ul>

        
        <!-- tip start -->
        <!-- tip -->
<!-- tip start -->
<div class="tip">
  <p>
    
      如果您喜欢此博客或发现它对您有用，则欢迎对此发表评论。也欢迎您共享此博客，以便更多人可以参与。如果博客中使用的图像侵犯了您的版权，请与作者联系以将其删除。谢谢 ！
    
  </p>
</div>
<!-- tip end -->

        <!-- tip end -->
        

        
        <!-- Sharing Srtart -->
        <!-- Social Social Share Post -->
<!-- Docs:https://github.com/overtrue/share.js -->

<div class="social-share" data-initialized="true" data-disabled="tencent ,douban ,qzone ,linkedin ,facebook ,google ,diandian" data-wechat-qrcode-helper="" align="center">
  <ul class="list-inline text-center social-share-ul">
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-twitter">
        <i class="fa fa-twitter fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a class="social-share-icon icon-wechat">
        <i class="fa fa-weixin fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-weibo">
        <i class="fa fa-weibo fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon icon-qq">
        <i class="fa fa-qq fa-1x" aria-hidden="true"></i>
      </a>
    </li>
    <li class="social-share-li">
      <a target="_blank" class="social-share-icon" href="mailto:?subject=小工具 - 简单的随机数生成工具&body=Hi,I found this website and thought you might like it https://morblog.cc/2345857970/">
        <i class="fa fa-envelope fa-1x" aria-hidden="true"></i>
      </a>
    </li>
  </ul>
</div>

<!-- css & js -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"> -->
<script defer="defer" async="true" src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>

        <!-- Sharing End -->
        
        <hr>

        <!-- comments start -->
        <!-- 1. gitalk comment -->


<!-- 2. gitment comment -->

  <!-- gitment start -->
  <!-- Docs:https://github.com/imsun/gitment -->

  <div id="blog_comments"></div>
  <!-- <link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"> <script src="https://imsun.github.io/gitment/dist/gitment.browser.js"></script> -->

  <script src="https://cdn.jsdelivr.net/gh/theme-next/theme-next-gitment@1/gitment.browser.js"></script>

  <script>
    const myTheme = {
      render(state, instance) {
        const container = document.createElement('div')
        container.lang = "en-US"
        container.className = 'gitment-container gitment-root-container'

        // your custom component
        container.appendChild(instance.renderSomething(state, instance))
        container.appendChild(instance.renderHeader(state, instance))
        container.appendChild(instance.renderEditor(state, instance))
        container.appendChild(instance.renderComments(state, instance))
        container.appendChild(instance.renderFooter(state, instance))
        return container
      },
      renderSomething(state, instance) {
        const container = document.createElement('div')
        container.lang = "en-US"
        container.className = 'hello_visitor'
        if (state.user.login) {
          container.innerText = `Hello ${state.user.login}, Welcome to comment system`
        }
        return container
      }
    }

    const gitment = new Gitment({
      id: 'Mon Dec 27 2021 15:00:12 GMT+0800', // optional
      owner: '59440988',
      repo: 'morcomment',
      oauth: {
        client_id: '1312dc4ff4d6834bb0f6',
        client_secret: '07aa0dc79f38ac6fafea3914a40558f250e7cfb4',
		// redirect_uri: 'https://morblog.cc/'
      },
      desc: '',
      perPage: '15',
      maxCommentHeight: '250',
      theme: myTheme,
      // ... For more available options, check out the documentation below
    })

    gitment.render('blog_comments')
    // or gitment.render(document.getElementById('comments')) or document.body.appendChild(gitment.render())
  </script>

  <!-- gitment end -->


<!-- 3. disqus comment -->


        <!-- comments end -->
        <hr>

      </div>

      <!-- Catalog: Tabe of Content -->
      <!-- Table of Contents -->

    
      <aside id="sidebar">
        <div id="toc" class="toc-article">
        <strong class="toc-title">目录</strong>
        
          <ol class="toc-nav"><li class="toc-nav-item toc-nav-level-1"><a class="toc-nav-link" href="#%E5%BC%80%E5%8F%91-%E7%AE%80%E5%8D%95%E7%9A%84%E9%9A%8F%E6%9C%BA%E6%95%B0%E7%94%9F%E6%88%90%E5%B7%A5%E5%85%B7"><span class="toc-nav-number">1.</span> <span class="toc-nav-text">开发 - 简单的随机数生成工具</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%BB%93%E6%9E%84"><span class="toc-nav-number">1.1.</span> <span class="toc-nav-text">- 结构 -</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%8E%9F%E7%90%86%E6%B5%81%E7%A8%8B"><span class="toc-nav-number">1.2.</span> <span class="toc-nav-text">- 原理流程 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%AF%86%E9%92%A5%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-nav-number">1.2.1.</span> <span class="toc-nav-text">- 密钥初始化 -</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E9%9A%8F%E6%9C%BA%E5%AD%97%E8%8A%82%E6%B5%81%E7%94%9F%E4%BA%A7%E6%93%8D%E4%BD%9C"><span class="toc-nav-number">1.2.2.</span> <span class="toc-nav-text">- 随机字节流生产操作 -</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#%E5%8E%9F%E7%90%86%E5%9B%BE%E7%A4%BA"><span class="toc-nav-number">1.2.3.</span> <span class="toc-nav-text">- 原理图示 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E5%AD%97%E8%8A%82%E6%B5%81%E7%9A%84%E5%90%84%E4%B8%AA%E7%AE%97%E6%B3%95%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-nav-number">1.3.</span> <span class="toc-nav-text">- 生成随机字节流的各个算法代码实现 -</span></a><ol class="toc-nav-child"><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#C64"><span class="toc-nav-number">1.3.1.</span> <span class="toc-nav-text">- C64 -</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#BASE64"><span class="toc-nav-number">1.3.2.</span> <span class="toc-nav-text">- BASE64 -</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#AES128"><span class="toc-nav-number">1.3.3.</span> <span class="toc-nav-text">- AES128 -</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#RSA"><span class="toc-nav-number">1.3.4.</span> <span class="toc-nav-text">- RSA -</span></a></li><li class="toc-nav-item toc-nav-level-3"><a class="toc-nav-link" href="#SHA256"><span class="toc-nav-number">1.3.5.</span> <span class="toc-nav-text">- SHA256 -</span></a></li></ol></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E7%94%9F%E6%88%90%E9%9A%8F%E6%9C%BA%E5%AD%97%E8%8A%82%E6%B5%81%E7%9A%84%E5%A4%84%E7%90%86%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-nav-number">1.4.</span> <span class="toc-nav-text">- 生成随机字节流的处理代码实现 -</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-nav-number">1.5.</span> <span class="toc-nav-text">- 后端代码实现 -</span></a></li><li class="toc-nav-item toc-nav-level-2"><a class="toc-nav-link" href="#%E6%95%88%E6%9E%9C%E6%BC%94%E7%A4%BA"><span class="toc-nav-number">1.6.</span> <span class="toc-nav-text">- 效果演示 -</span></a></li></ol></li></ol>
        
        </div>
      </aside>
    



      <!-- Sidebar Container -->
      <div class="
                col-lg-8 col-lg-offset-1
                col-md-10 col-md-offset-1
                sidebar-container">

        <!-- Featured Tags -->
        
        <section>
          <!-- no hr -->
          <h5>
            <a href="/tags/">标签</a>
          </h5>
          <div class="tags">
            
            <a class="tag" href="/tags/#安全" title="安全">安全</a>
            
            <a class="tag" href="/tags/#CRYPTO" title="CRYPTO">CRYPTO</a>
            
            <a class="tag" href="/tags/#PHP" title="PHP">PHP</a>
            
            <a class="tag" href="/tags/#Python" title="Python">Python</a>
            
          </div>
        </section>
        

        <!-- Friends Blog -->
        
        <hr>
        <h5>朋友们</h5>
        <ul class="list-inline">

          
          <li>
            <a href="https://www.cnblogs.com/Yhck/" target="_blank">Yhck</a>
          </li>
          
          <li>
            <a href="https://www.cnblogs.com/wkzb/" target="_blank">beiwo</a>
          </li>
          
          <li>
            <a href="https://leohearts.com/" target="_blank">Leohearts</a>
          </li>
          
          <li>
            <a href="https://longlone.best/" target="_blank">Longlone</a>
          </li>
          
          <li>
            <a href="http://na0hblog.top/" target="_blank">Na0h</a>
          </li>
          
        </ul>
        
      </div>
    </div>
  </div>
</article>



<!-- anchorjs start -->
<!-- async load function -->
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script type="text/javascript">
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function(e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  };
</script>
<script type="text/javascript">
  //anchor-js, Doc:http://bryanbraun.github.io/anchorjs/
  async ("https://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js", function() {
    anchors.options = {
      visible: 'hover',
      placement: 'left',
      // icon: 'ℬ'
      icon: '❡'
    };
    anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
  });
</script>
<style>
  /* place left on bigger screen */
  @media all and (min-width: 800px) {
    .anchorjs-link {
      position: absolute;
      left: -0.75em;
      font-size: 1.1em;
      margin-top: -0.1em;
    }
  }
</style>

<!-- anchorjs end -->



		<!-- Footer (contains ThemeColor、viewer) -->
		<!-- Footer -->
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center">
          

          
            <li>
              <a target="_blank" href="https://github.com/Morouu">
                <span class="fa-stack fa-lg">
                  <i class="fa fa-circle fa-stack-2x"></i>
                  <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                </span>
              </a>
            </li>
          

          

          

          

          

          

          

        </ul>
        <p class="copyright text-muted">
         &copy; 2021
		 <i class="icon-smile"></i>
          morouu
          <br>
          Theme by
          <a target="_blank" rel="noopener" href="http://beantech.org">BeanTech</a>
          <span style="display: inline-block; margin: 0 5px;">
            <i class="fa fa-heart"></i>
          </span>
          re-Ported by
          <a target="_blank" rel="noopener" href="https://v-vincen.life/">Live My Life</a>
          |
          <iframe style="margin-left: 2px; margin-bottom:-5px;" frameborder="0" scrolling="0" width="91px" height="20px" src="https://ghbtns.com/github-btn.html?user=V-Vincen&repo=V-Vincen.github.io&type=star&count=true"></iframe>
        <div class=" copyright text-muted live_time"><span>本博客已萌萌哒地运行</span><span id="display_live_time"> 0 天 0 小时 0 分 0 秒</span><span class="moe-text">(●'◡'●)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-12-27T20:23:15');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " 天 " + passHour + " 小时 " + passMinute + " 分 " + passSecond + " 秒";
}
blog_live_time();
</script></div>
		</p>
		
      </div>
    </div>
  </div>
</footer>

<a id="rocket" href="#top" class=""></a>


  <!-- jQuery -->
  <script type="text/javascript" src="/js/jquery.min.js"></script>
  <!-- Bootstrap Core JavaScript -->
  <script type="text/javascript" src="/js/bootstrap.min.js"></script>
  <!-- Custom Theme JavaScript -->
  <script type="text/javascript" src="/js/hux-blog.min.js"></script>
  <!-- catalog -->
  <script async="true" type="text/javascript" src="/js/catalog.js"></script>
  <!-- totop(rocket) -->
  <script async="true" type="text/javascript" src="/js/totop.js"></script>

  
    <!-- Busuanzi JavaScript -->
    <script async="async" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  

  
    <!-- Scroll start -->
    <script async="async" type="text/javascript" src="/js/scroll.js"></script>
    <!-- Scroll end -->
  

  
    <!-- LangSelect start -->
    <script type="text/javascript" src="/js/langselect.js"></script>
    <!-- LangSelect end -->
  

  
    <!-- Mouseclick -->
    <script type="text/javascript" src="/js/mouseclick.js" content='' color=''></script>
  

  
    <!-- ribbon -->
    <script type="text/javascript" src="/js/ribbonDynamic.js"></script>
  

  
    <!-- Line start -->
    <script async="text/javascript" src="/js/line.js"></script>
    <!-- Line end -->
  






  <!-- viewer start -->
  <!-- viewer start (Picture preview) -->
  
    <script async="async" type="text/javascript" src="/js/viewer/viewer.min.js"></script>
    <script async="async" type="text/javascript" src="/js/viewer/pic-viewer.js"></script>
  

  <!-- viewer end -->


<script>
  // async load function
  function async (u, c) {
    var d = document,
      t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (c) {
      o.addEventListener('load', function (e) {
        c(null, e);
      }, false);
    }
    s.parentNode.insertBefore(o, s);
  }

  // fastClick.js
  async ("https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function () {
    var $nav = document.querySelector("nav");
    if ($nav)
      FastClick.attach($nav);
    }
  )
</script>

<!-- Because of the native support for backtick-style fenced code blocks right within the Markdown is landed in Github Pages, From V1.6, There is no need for Highlight.js, so Huxblog drops it officially. -
https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0 - https://help.github.com/articles/creating-and-highlighting-code-blocks/ -->
<!-- <script> async ("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function () { hljs.initHighlightingOnLoad(); }) </script> <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet"> -->

<!-- jquery.tagcloud.js -->
<!-- <script> // only load tagcloud.js in tag.html if ($('#tag_cloud').length !== 0) { async ("https://morblog.cc/js/jquery.tagcloud.js", function () { $.fn.tagcloud.defaults = { // size: { start: 1, end: 1, unit: 'em' }, color: {
start: '#bbbbee', end: '#0085a1' } }; $('#tag_cloud a').tagcloud(); }) } </script> -->


		<!-- Search -->
		
		<div class="popup search-popup local-search-popup">
  <span class="popup-btn-close">
    ESC
  </span>
  <div class="container">
    <div class="row">
      <!-- <div class="col-md-9 col-md-offset-1"> -->
      <div class="col-lg-9 col-lg-offset-1 col-md-10 col-md-offset-1 local-search-content">

        <div class="local-search-header clearfix">

          <div class="local-search-input-wrapper">
            <span class="search-icon">
              <i class="fa fa-search fa-lg" style="margin: 25px 10px 25px 20px;"></i>
            </span>
            <input autocomplete="off" placeholder="搜索..." type="text" id="local-search-input">
          </div>
        </div>
        <div id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>


  
    <script src="/js/ziploader.js"></script>
  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    // monitor main search box;
    var onPopupClose = function (e) {
      $('.popup').fadeOut(300);
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $('.popup').fadeIn(300);
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }
    // get search zip version
    $.get('/searchVersion.json?t=' + (+new Date()), function (res) {
      if (localStorage.getItem('searchVersion') !== res) {
        localStorage.setItem('searchVersion', res);
        initSearchJson();
      }
    });

    function initSearchJson() {
      initLoad(['/search.flv'], {
        loadOptions: {
          success: function (obj) {
            localStorage.setItem('searchJson', obj['search.json'])
          },
          error: function (e) {
            return console.log(e)
          }
        },
        returnOptions: {
          'json': TYPE_TEXT
        },
        mimeOptions: {
          'json': 'application/json'
        }
      })
    }
    // search function;
    var searchFunc = function (search_id, content_id) {
      'use strict';
      isfetched = true;
      var datas = JSON.parse(localStorage.getItem('searchJson'));
      // console.log(search_id)
      var input = document.getElementById(search_id);
      var resultContent = document.getElementById(content_id);
      var inputEventFunction = function () {
        var searchText = input.value.trim().toLowerCase();
        var keywords = searchText.split(/[\s\-]+/);
        if (keywords.length > 1) {
          keywords.push(searchText);
        }
        var resultItems = [];
        if (searchText.length > 0) {
          // perform local searching
          datas.forEach(function (data) {
            var isMatch = false;
            var hitCount = 0;
            var searchTextCount = 0;
            var title = data.title
              ? data.title.trim()
              : '';
            var titleInLowerCase = title.toLowerCase();
            var content = data.content
              ? data.content.trim().replace(/<[^>]+>/g, "")
              : '';
            var contentInLowerCase = content.toLowerCase();
            var articleUrl = decodeURIComponent(data.url);

            var date = data.date;
            var dateTime = date.replace(/T/, " ").replace(/.000Z/, "");
            var imgUrl = data.header_img;
            


            var indexOfTitle = [];
            var indexOfContent = [];
            // only match articles with not empty titles
            keywords.forEach(function (keyword) {
              function getIndexByWord(word, text, caseSensitive) {
                var wordLen = word.length;
                if (wordLen === 0) {
                  return [];
                }
                var startPosition = 0,
                  position = [],
                  index = [];
                if (!caseSensitive) {
                  text = text.toLowerCase();
                  word = word.toLowerCase();
                }
                while ((position = text.indexOf(word, startPosition)) > -1) {
                  index.push({position: position, word: word});
                  startPosition = position + wordLen;
                }
                return index;
              }
              indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
              indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
            });
            if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
              isMatch = true;
              hitCount = indexOfTitle.length + indexOfContent.length;
            }
            // show search results
            if (isMatch) {
              // sort index by position of keyword
              [indexOfTitle, indexOfContent].forEach(function (index) {
                index.sort(function (itemLeft, itemRight) {
                  if (itemRight.position !== itemLeft.position) {
                    return itemRight.position - itemLeft.position;
                  } else {
                    return itemLeft.word.length - itemRight.word.length;
                  }
                });
              });
              // merge hits into slices
              function mergeIntoSlice(text, start, end, index) {
                var item = index[index.length - 1];
                var position = item.position;
                var word = item.word;
                var hits = [];
                var searchTextCountInSlice = 0;
                while (position + word.length <= end && index.length != 0) {
                  if (word === searchText) {
                    searchTextCountInSlice++;
                  }
                  hits.push({position: position, length: word.length});
                  var wordEnd = position + word.length;
                  // move to next position of hit
                  index.pop();
                  while (index.length != 0) {
                    item = index[index.length - 1];
                    position = item.position;
                    word = item.word;
                    if (wordEnd > position) {
                      index.pop();
                    } else {
                      break;
                    }
                  }
                }
                searchTextCount += searchTextCountInSlice;
                return {hits: hits, start: start, end: end, searchTextCount: searchTextCountInSlice};
              }
              var slicesOfTitle = [];
              if (indexOfTitle.length != 0) {
                slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
              }
              var slicesOfContent = [];
              while (indexOfContent.length != 0) {
                var item = indexOfContent[indexOfContent.length - 1];
                var position = item.position;
                var word = item.word;
                // cut out 100 characters
                var start = position - 20;
                var end = position + 80;
                if (start < 0) {
                  start = 0;
                }
                if (end < position + word.length) {
                  end = position + word.length;
                }
                if (end > content.length) {
                  end = content.length;
                }
                slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
              }
              // sort slices in content by search text's count and hits' count
              slicesOfContent.sort(function (sliceLeft, sliceRight) {
                if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                  return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                  return sliceRight.hits.length - sliceLeft.hits.length;
                } else {
                  return sliceLeft.start - sliceRight.start;
                }
              });
              // select top N slices in content
              var upperBound = parseInt('1');
              if (upperBound >= 0) {
                slicesOfContent = slicesOfContent.slice(0, upperBound);
              }
              // highlight title and content
              function highlightKeyword(text, slice) {
                var result = '';
                var prevEnd = slice.start;
                slice.hits.forEach(function (hit) {
                  result += text.substring(prevEnd, hit.position);
                  var end = hit.position + hit.length;
                  result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                  prevEnd = end;
                });
                result += text.substring(prevEnd, slice.end);
                return result;
              }
              var resultItem = '';

              // if (slicesOfTitle.length != 0) {   resultItem += "<li><a target='_blank' href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>"; } else {   resultItem += "<li><a target='_blank' href='" +
              // articleUrl + "' class='search-result-title'>" + title + "</a>"; } slicesOfContent.forEach(function (slice) {   resultItem += "<a target='_blank' href='" + articleUrl + "'><p class=\"search-result\">" + highlightKeyword(content, slice) +
              // "...</p></a>"; }); resultItem += "</li>";

              if (slicesOfTitle.length != 0) {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</div><time class='search-result-date'>" + dateTime + "</time>";
              } else {
                resultItem += "<a target='_blank' href='" + articleUrl + "' class='search-result'><div class='search-result-left'><div class='search-result-title'>" + title + "</div><time class='search-result-date'>" + dateTime + "</time>";
              }
              slicesOfContent.forEach(function (slice) {
                resultItem += "<p class=\"search-result-content\">" + highlightKeyword(content, slice) + "...</p>";
              });
              resultItem += "</div><div class='search-result-right'><img class='media-image' src='" + imgUrl + "' width='64px' height='48px'></img></div></a>";

              resultItems.push({item: resultItem, searchTextCount: searchTextCount, hitCount: hitCount, id: resultItems.length});
            }
          })
        };

        if (keywords.length === 1 && keywords[0] === "") {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else if (resultItems.length === 0) {
          resultContent.innerHTML = '<div id="no-result"></div>'
        } else {
          resultItems.sort(function (resultLeft, resultRight) {
            if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
              return resultRight.searchTextCount - resultLeft.searchTextCount;
            } else if (resultLeft.hitCount !== resultRight.hitCount) {
              return resultRight.hitCount - resultLeft.hitCount;
            } else {
              return resultRight.id - resultLeft.id;
            }
          });
          var searchResultList = '<div class=\"search-result-list\">';
          resultItems.forEach(function (result) {
            searchResultList += result.item;
          })
          searchResultList += "</div>";
          resultContent.innerHTML = searchResultList;
        }
      }
      if ('auto' === 'auto') {
        input.addEventListener('input', inputEventFunction);
      } else {
        $('.search-icon').click(inputEventFunction);
        input.addEventListener('keypress', function (event) {
          if (event.keyCode === 13) {
            inputEventFunction();
          }
        });
      }
      // remove loading animation
      $('body').css('overflow', '');
      proceedsearch();
    }
    // handle and trigger popup window;
    $('.popup-trigger').click(function (e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc('local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });
    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function (e) {
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 && $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });

    document.addEventListener('mouseup', (e) => {
      var _con = document.querySelector(".local-search-content");
      if (_con) {
        if (!_con.contains(e.target)) {
          onPopupClose();
        }
      }
    });
  </script>


		
	<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"live2d-widget-model-haru/02"},"display":{"position":"right","width":225,"height":225,"right":125},"mobile":{"show":true,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.8},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
